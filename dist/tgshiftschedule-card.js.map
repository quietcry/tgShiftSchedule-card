{"version":3,"file":"tgshiftschedule-card.js","mappings":"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","sources":["webpack://tgshiftschedule-card/webpack/runtime/load script","webpack://tgshiftschedule-card/webpack/bootstrap","webpack://tgshiftschedule-card/webpack/runtime/define property getters","webpack://tgshiftschedule-card/webpack/runtime/ensure chunk","webpack://tgshiftschedule-card/webpack/runtime/get javascript chunk filename","webpack://tgshiftschedule-card/webpack/runtime/global","webpack://tgshiftschedule-card/webpack/runtime/hasOwnProperty shorthand","webpack://tgshiftschedule-card/webpack/runtime/make namespace object","webpack://tgshiftschedule-card/webpack/runtime/publicPath","webpack://tgshiftschedule-card/webpack/runtime/jsonp chunk loading","webpack://tgshiftschedule-card/./node_modules/@lit/reactive-element/css-tag.js","webpack://tgshiftschedule-card/./node_modules/@lit/reactive-element/reactive-element.js","webpack://tgshiftschedule-card/./node_modules/lit-html/lit-html.js","webpack://tgshiftschedule-card/./node_modules/lit-element/lit-element.js","webpack://tgshiftschedule-card/./src/card-config.js","webpack://tgshiftschedule-card/./src/tools/tg-card-helper.js","webpack://tgshiftschedule-card/./src/super-base.js","webpack://tgshiftschedule-card/./src/card-base.js","webpack://tgshiftschedule-card/./src/views/view-base.js","webpack://tgshiftschedule-card/./src/storage/storage-interface.js","webpack://tgshiftschedule-card/./src/storage/saver-storage.js","webpack://tgshiftschedule-card/./src/storage/entity-storage.js","webpack://tgshiftschedule-card/./src/storage/storage-factory.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/holiday-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/data-management-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/calendar-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/config-management-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/rendering-mixin.js","webpack://tgshiftschedule-card/./src/utils/date-utils.js","webpack://tgshiftschedule-card/./src/utils/color-utils.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shared-menu-styles.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/menu-bar-template.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shift-config-panel.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shiftschedule-view.js","webpack://tgshiftschedule-card/./src/card-impl.js","webpack://tgshiftschedule-card/./src/editor/editor-base.js","webpack://tgshiftschedule-card/./src/editor/editor-impl.js","webpack://tgshiftschedule-card/./src/editor/editor.js","webpack://tgshiftschedule-card/./src/card.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"tgshiftschedule-card:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".tgshiftschedule-card.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunktgshiftschedule_card\"] = self[\"webpackChunktgshiftschedule_card\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.0\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.0\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.0\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","const Version = '2026.01-0039';\nconst CardRegname = 'tgshiftschedule-card';\nconst CardName = 'TG Schichtplan Card';\nconst CardDescription = 'Eine Schichtplan-Karte fr Arbeitszeiten';\nconst CardFilename = 'tgshiftschedule-card.js';\nconst DebugMode = 'true'; // Aktiviere Debug fr alle Komponenten\nconst UseDummyData = 'false';\nconst showVersion = false;\nconst SaveDebounceTime = 300; // Debounce-Zeit in Millisekunden fr das Speichern von nderungen (0 = sofort, ohne Debouncing)\n\n// Schichtplan-Konfiguration\nconst DefaultConfig = {\n  entity: '', // input_text Entity fr Speicherung (muss konfiguriert werden)\n};\n\nexport {\n  CardRegname,\n  CardName,\n  CardDescription,\n  CardFilename,\n  Version,\n  DebugMode,\n  UseDummyData,\n  showVersion,\n  SaveDebounceTime,\n  DefaultConfig,\n};\n","import { CardName, DebugMode, Version } from '../card-config.js';\n\nexport class TgCardHelper {\n  static cardName = CardName;\n  static debugMode = DebugMode;\n  static className = 'TgCardHelper';\n  static version = Version;\n\n  constructor(cardName, debugMode, className, version) {\n    this.cardName = cardName || this.constructor.cardName || null;\n    this.debugMode = debugMode || this.constructor.debugMode || 'true';\n    this.className = className || this.constructor.className || null;\n    this.version = version || this.constructor.version || null;\n    this.getCardInfoString = [\n      `%c${this.cardName}%c${this.version}%c`,\n      'background: #9c27b0; color: white; padding: 2px 6px; border-top-left-radius: 12px; border-bottom-left-radius: 12px; font-weight: bold;',\n      'background: #00bcd4; color: white; padding: 2px 6px; border-top-right-radius: 12px; border-bottom-right-radius: 12px; font-weight: bold;',\n      '',\n    ];\n\n    // this._debug('tgCardHelper initialisiert');\n  }\n  _debug(...args) {\n    // Prfe ob Debug aktiviert ist (kann String 'true' oder Boolean true sein)\n    if (!this.debugMode || this.debugMode === 'false' || this.debugMode === false) return;\n\n    // Versuche verschiedene Methoden, um den echten Klassennamen zu bekommen\n    let classNameDefault = 'unknownClass';\n    let methodNameDefault = 'unknownMethod';\n    let cardNameDefault = 'unknownCard';\n    let className = null;\n    let methodName = null;\n    let cardName = null;\n    let contextObject = null;\n\n    // Prfe ob das erste Argument ein Kontext-Objekt ist (this aus SuperBase)\n    // Kontext-Objekt erkennt man daran, dass es eine constructor-Eigenschaft hat UND\n    // spezifische Eigenschaften unserer Klassen hat (cardName ist einzigartig fr unsere Klassen)\n    if (\n      Array.isArray(args[0]) &&\n      args[0].length === 1 &&\n      args[0][0] &&\n      typeof args[0][0] === 'object' &&\n      args[0][0].constructor &&\n      (args[0][0].cardName || args[0][0].constructor.className)\n    ) {\n      contextObject = args[0][0];\n      args = args.slice(1);\n    } else {\n      contextObject = this;\n    }\n\n    // Extrahiere Informationen aus dem Kontext-Objekt (immer vorhanden)\n    // Methode 1: Statischer Klassennamen (falls definiert)\n    if (contextObject.constructor.className) {\n      className = contextObject.constructor.className;\n    }\n    // Methode 2: Tag-Name des Custom Elements\n    else if (contextObject.tagName) {\n      className = contextObject.tagName.toLowerCase().replace(/[^a-z0-9]/g, '');\n    }\n    // Methode 3: Constructor name (kann minifiziert sein)\n    else if (contextObject.constructor.name && contextObject.constructor.name.length > 2) {\n      className = contextObject.constructor.name;\n    }\n    // Methode 4: Fallback auf cardName\n    else if (contextObject.cardName) {\n      className = contextObject.cardName;\n    }\n    // Methode 5: Fallback auf Default\n    else {\n      className = classNameDefault;\n    }\n\n    cardName = contextObject.cardName || this.cardName || cardNameDefault;\n\n    // Prfe sofort, ob wir Debug-Meldungen fr diese Klasse ausgeben sollen\n    const debugList = this.debugMode.split(',').map(item => item.trim().toLowerCase());\n    const shouldDebug =\n      debugList[0].toLowerCase() === 'true'\n        ? !debugList.slice(1).includes(className.toLowerCase())\n        : debugList.includes(className.toLowerCase());\n\n    // Wenn wir keine Debug-Meldungen ausgeben sollen, beende hier\n    if (!shouldDebug) return;\n\n    // Ermittle den Methodennamen nur wenn wir Debug-Meldungen ausgeben\n    if (!methodName) {\n      try {\n        const stack = new Error().stack.split('\\n');\n        const callerLine = stack[2]; // Index 2 fr die aufrufende Methode\n\n        // Verschiedene Regex-Patterns fr verschiedene Browser-Formate\n        const patterns = [\n          /at\\s+\\w+\\.(\\w+)/, // Chrome/Node.js: \"at ClassName.methodName\"\n          /(\\w+)@/, // Firefox: \"methodName@\"\n          /(\\w+)\\s+\\(/, // Alternative: \"methodName(\"\n          /at\\s+(\\w+)/, // Fallback: \"at methodName\"\n        ];\n\n        for (const pattern of patterns) {\n          const methodMatch = callerLine.match(pattern);\n          if (methodMatch) {\n            methodName = methodMatch[1];\n            break;\n          }\n        }\n      } catch (error) {\n        // Fallback falls Stack Trace nicht verfgbar\n        methodName = null;\n      }\n    }\n    methodName = methodName || methodNameDefault;\n\n    // Erstelle Debug-Ausgabe\n    let path = `[${cardName}]:[${className}]:[${methodName}]`;\n    while (path.length < 50) {\n      path = path + ' ';\n    }\n\n    // Erstelle die vollstndige Debug-Ausgabe mit Formatierung\n    const debugArgs = [path, ...args];\n\n    // Verwende console.log mit dem formatierten Pfad\n    console.log(...this.getCardInfoString, ...debugArgs);\n  }\n}\n","import { LitElement, css } from 'lit';\nimport { CardName, Version, DebugMode, showVersion, UseDummyData } from './card-config.js';\nimport { TgCardHelper } from './tools/tg-card-helper.js';\n\nexport class SuperBase extends LitElement {\n  static cardName = CardName;\n  static version = Version;\n  static debugMode = DebugMode;\n  static useDummyData = UseDummyData;\n  static showVersion = showVersion;\n  static className = 'SuperBase';\n\n  static properties = {\n    hass: { type: Object },\n    config: { type: Object },\n  };\n\n  static styles = [\n    css`\n      :host {\n        display: block;\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n    this.dM = `${this.constructor.className}: `; // debugMsgPrefix - Prefix fr Debug-Nachrichten\n\n    this.cardName = this.constructor.cardName;\n    this.version = this.constructor.version;\n    this.debugMode = this.constructor.debugMode;\n    this.useDummyData = this.constructor.useDummyData;\n    this.showVersion = this.constructor.showVersion;\n    this.tgCardHelper = new TgCardHelper(this.constructor.cardName, this.constructor.debugMode);\n    this.getCardInfoString = this.tgCardHelper.getCardInfoString;\n    this._debug('SuperBase-Konstruktor wird aufgerufen');\n  }\n\n  registerMeForChangeNotifys(eventTypes = '', that = this) {\n    const dM = `${this.dM || '?: '}registerMeForChangeNotifys() `;\n    this._debug(`${dM} Aufruf`, { eventTypes, that });\n    this.dispatchEvent(\n      new CustomEvent('registerMeForChanges', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          component: that,\n          callback: this._handleOnChangeNotifys.bind(this),\n          eventType: eventTypes,\n          immediately: true,\n        },\n      })\n    );\n  }\n\n  _handleOnChangeNotifys(eventdata) {\n    const dM = `${this.dM || '?: '}_handleOnChangeNotifys() `;\n    this._debug(`${dM}aufgerufen`, { eventdata });\n    for (const eventType of Object.keys(eventdata)) {\n      const fkt = '_handleOnChangeNotify_' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n      if (typeof this[fkt] === 'function') {\n        this._debug(`${dM} ${fkt} aufgerufen`, { eventdata: eventdata[eventType] });\n        this[fkt](eventdata[eventType]);\n      } else {\n        this._debug(`${dM} ${fkt} nicht gefunden`, { eventdata: eventdata[eventType] });\n      }\n    }\n  }\n\n  _debug(...args) {\n    // Delegiere komplett an den TgCardHelper mit Kontext-Informationen\n    this.tgCardHelper._debug([this], ...args);\n  }\n}\n","import { css } from 'lit';\nimport { SuperBase } from './super-base.js';\n\nexport class CardBase extends SuperBase {\n  static className = 'CardBase';\n\n  static properties = {\n    ...super.properties,\n    _selectedTab: { type: Number },\n  };\n\n  constructor() {\n    super();\n    this.dM = `${this.constructor.className}: `; // debugMsgPrefix - Prefix fr Debug-Nachrichten\n\n    this._selectedTab = 0;\n    this._debug(`CardBase-Modul wird geladen`);\n\n    // Array fr nderungs-Observer\n    this.informAtChangesClients = [];\n\n    // Eigene Verwaltung der registrierten EventTypes\n    this._registeredEventTypes = new Set();\n\n    // Registriere Event-Listener fr automatische Registrierung\n    this.addEventListener('registerMeForChanges', this._onRegisterMeForChanges.bind(this));\n  }\n\n  async firstUpdated() {\n    this._debug('CardBase firstUpdated: Start');\n    await super.firstUpdated();\n    this._debug('CardBase firstUpdated: Ende');\n  }\n\n  setConfig(config) {\n    this._debug('setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration angegeben');\n    }\n\n    // Prfe, ob es sich um eine neue Konfiguration handelt\n    const isNewConfig = !this.config || Object.keys(this.config).length === 0;\n\n    // Wenn es eine neue Konfiguration ist, verwende sie direkt\n    if (isNewConfig) {\n      this.config = {\n        ...this.getDefaultConfig(),\n        ...config,\n      };\n    } else {\n      // Ansonsten behalte die bestehende Konfiguration bei und aktualisiere nur genderte Werte\n      this.config = {\n        ...this.config,\n        ...config,\n      };\n    }\n\n    this._debug('config nach setConfig:', this.config);\n  }\n\n  getDefaultConfig() {\n    this._debug('getDefaultConfig wird aufgerufen');\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      selectedCalendar: 'a', // Erster aktivierter Kalender\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      calendars: [\n        {\n          shortcut: 'a',\n          name: 'Kalender A',\n          color: '#ff9800',\n          enabled: true,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'b',\n          name: 'Kalender B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Kalender C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Kalender D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Kalender E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ],\n      holidays: {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      },\n    };\n  }\n\n  render(content = '') {\n    this._debug('render wird aufgerufen');\n    return html`\n      <ha-card>\n        <div class=\"card-content\">${content}</div>\n        ${this.showVersion ? html` <div class=\"version\">Version: ${this.version}</div> ` : ''}\n      </ha-card>\n    `;\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      ha-card {\n        padding: 16px;\n      }\n\n      .loading {\n        text-align: center;\n        padding: 20px;\n        color: var(--secondary-text-color);\n      }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n      }\n    `,\n  ];\n\n  _onRegisterMeForChanges(event) {\n    this._debug('Registrierungsanfrage empfangen', {\n      component: event.target,\n      detail: event.detail,\n    });\n\n    const { component, callback, eventType = '', immediately = false } = event.detail;\n\n    if (component && typeof callback === 'function') {\n      this.registerInformAtChangesClients(component, eventType, immediately, callback);\n      this._debug('Komponente erfolgreich registriert', {\n        component: component.tagName || component.constructor.name,\n        eventType: eventType,\n      });\n    } else {\n      this._debug('Registrierung fehlgeschlagen', {\n        componentExists: !!component,\n        hasCallback: typeof callback === 'function',\n      });\n    }\n  }\n\n  /**\n   * Registriert einen Observer fr View-nderungen\n   * @param {Object} me - Das Objekt, das ber nderungen informiert werden soll\n   * @param {string|Array} eventType - Event-Typ als String oder Array von Strings\n   * @param {Function} callback - Callback-Funktion, die bei nderungen aufgerufen wird\n   */\n  registerInformAtChangesClients(me, eventType = '', immediately = false, callback = null) {\n    const dM = `${this.dM || '?: '}registerInformAtChangesClients() `;\n    this._debug(`${dM}Anfrage`, {\n      me,\n      newEventType: eventType,\n    });\n\n    // Normalisiere die neuen EventTypes\n    const eventTypes = Array.isArray(eventType)\n      ? eventType.map(e => e.toLowerCase()).sort()\n      : typeof eventType === 'string'\n        ? eventType\n            .split(',')\n            .map(e => e.trim().toLowerCase())\n            .filter(e => e.length > 0)\n            .sort()\n        : [];\n\n    // Prfe ob bereits ein Observer fr denselben me existiert\n    const existingMeInformer = this.informAtChangesClients.find(informer => informer.me === me);\n    let existingEventTypes = [];\n    if (existingMeInformer) {\n      // Normalisiere die bestehenden eventTypes\n      existingEventTypes = Array.isArray(existingMeInformer.eventType)\n        ? existingMeInformer.eventType.map(e => e.toLowerCase()).sort()\n        : typeof existingMeInformer.eventType === 'string'\n          ? existingMeInformer.eventType\n              .split(',')\n              .map(e => e.trim().toLowerCase())\n              .filter(e => e.length > 0)\n              .sort()\n          : [];\n    }\n    // Finde nur die wirklich neuen EventTypes\n    const newEventTypes = eventTypes.filter(newType => !existingEventTypes.includes(newType));\n    if (existingMeInformer && newEventTypes.length === 0) {\n      this._debug(`${dM}Client war bereits mit allen Typen registriert`, {\n        me,\n        requestedEventTypes: eventTypes,\n        existingEventTypes,\n      });\n      return false;\n    }\n\n    if (existingMeInformer) {\n      // Fge nur die neuen EventTypes hinzu\n      const combinedEventTypes = [...existingEventTypes, ...newEventTypes].sort();\n      existingMeInformer.eventType = combinedEventTypes;\n      this._debug(`${dM}Neue EventTypes hinzugefgt`, {\n        me,\n        newEventTypes,\n        existingEventTypes,\n        combinedEventTypes,\n      });\n    } else {\n      // Fge neuen Client hinzu\n      this.informAtChangesClients.push({\n        me,\n        eventType: newEventTypes,\n        callback,\n      });\n      this._debug(`${dM}Neuer Informer registriert`, {\n        me,\n        newEventTypes,\n        totalObservers: this.informAtChangesClients.length,\n      });\n    }\n    newEventTypes.forEach(eventType => {\n      // Prfe ob bereits ein Listener fr diesen EventType existiert\n      if (!this._registeredEventTypes.has(eventType)) {\n        this._debug(`${dM}Fge Listener fr EventType hinzu`, { eventType });\n        this.addEventListener(eventType + '-event', this._notifyClientsAtChanges.bind(this));\n        this._registeredEventTypes.add(eventType);\n      } else {\n        this._debug(`${dM}Listener fr EventType bereits vorhanden`, { eventType });\n      }\n      const fkt = '_onRegisterMeFor_' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n      this._debug(`${dM}Registriere Komponente fr EnvSniffer-nderungen`, { fkt });\n      if (typeof this[fkt] === 'function') {\n        this[fkt](immediately, me);\n      }\n    });\n\n    return true;\n  }\n\n  _notifyClientsAtChanges(event) {\n    this._debug('_notifyClientsAtChanges() Anfrage', {\n      event,\n    });\n    // Sichere Extraktion des EventTypes (entferne '-event' Suffix)\n    const eventType = event.type.replace('-event', '');\n    const fkt = '_on' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n    // const data = {[eventType]: (typeof this[fkt] === 'function') ? this[fkt](event.detail) : event.detail};\n\n    this._debug('_notifyClientsAtChanges() EventType extrahiert', {\n      originalEventType: event.type,\n      extractedEventType: eventType,\n      clients: this.informAtChangesClients,\n      fkt: fkt,\n    });\n\n    this.informAtChangesClients.forEach(client => {\n      // Prfe ob client.me auf ein existierendes DOM-Element verweist\n      if (\n        eventType &&\n        client.eventType.includes(eventType) &&\n        client.me &&\n        (client.me instanceof Element || client.me.nodeType)\n      ) {\n        // Zustzliche Prfung: Ist das Element noch im DOM?\n        if (document.contains(client.me) || client.me.isConnected) {\n          // Client benachrichtigen\n          const details =\n            typeof this[fkt] === 'function' ? this[fkt](client.me, event) : event.detail || {};\n          const data = { [eventType]: details };\n          if (details && client.callback && typeof client.callback === 'function') {\n            try {\n              this._debug('_notifyClientsAtChanges() Client benachrichtigen', {\n                client: client.me.constructor.name,\n                eventType: eventType,\n                data: data,\n              });\n              client.callback(data);\n            } catch (error) {\n              // Fehler beim Benachrichtigen des Clients\n            }\n          }\n        }\n      }\n    });\n  }\n}\n","import { SuperBase } from '../super-base.js';\nimport { css } from 'lit';\n\nexport class ViewBase extends SuperBase {\n  static className = 'ViewBase';\n\n  static properties = {\n    config: { type: Object },\n    epgData: { type: Array },\n    _loading: { type: Boolean },\n    _error: { type: Object },\n  };\n\n  constructor() {\n    super();\n    this._debug('ViewBase-Konstruktor: Start');\n    this.config = {};\n    this.epgData = [];\n    this._loading = false;\n    this._error = null;\n    this._debug('ViewBase-Konstruktor: Initialisierung abgeschlossen');\n  }\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n    `,\n  ];\n\n  async firstUpdated() {\n    this._debug('ViewBase firstUpdated: Start');\n    await super.firstUpdated();\n    this._debug('ViewBase firstUpdated: Ende');\n  }\n\n  async _loadData() {\n    this._debug('ViewBase _loadData wird aufgerufen');\n    if (!this._dataProvider || !this.config.entity) {\n      this._debug('ViewBase _loadData: bersprungen - dataProvider oder entity fehlt', {\n        dataProvider: !!this._dataProvider,\n        entity: this.config.entity,\n        config: this.config,\n      });\n      return;\n    }\n\n    this._loading = true;\n    this._error = null;\n\n    try {\n      this._debug('Starte _fetchViewData mit Konfiguration:', this.config);\n      const data = await this._fetchViewData(this.config);\n      this.epgData = data;\n      this._debug('_fetchViewData erfolgreich:', data);\n    } catch (error) {\n      this._error = error;\n      this._debug('Fehler in _fetchViewData:', error);\n    } finally {\n      this._loading = false;\n    }\n  }\n\n  async _fetchViewData(config) {\n    throw new Error('_fetchViewData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  // Basis-Rendering-Methode, die von den abgeleiteten Klassen berschrieben werden kann\n  render() {\n    if (this._loading) {\n      return this._renderLoading();\n    }\n    if (this._error) {\n      return this._renderError();\n    }\n    return this._renderContent();\n  }\n\n  _renderLoading() {\n    return html`<div class=\"loading\">Lade Daten...</div>`;\n  }\n\n  _renderError() {\n    return html`<div class=\"error\">${this._error}</div>`;\n  }\n\n  _renderContent() {\n    return html`<div>Keine Daten verfgbar</div>`;\n  }\n}\n","/**\n * Storage-Interface fr verschiedene Speicher-Mechanismen\n * \n * Dieses Interface ermglicht es, verschiedene Storage-Implementierungen\n * (z.B. Saver, Entity) zu kapseln und spter leicht zu entfernen oder zu wechseln.\n */\n\n/**\n * @interface IStorageAdapter\n * \n * Basis-Interface fr alle Storage-Adapter\n */\nexport class IStorageAdapter {\n  /**\n   * Prft, ob dieser Storage-Adapter fr den gegebenen store_mode verwendet werden soll\n   * @param {string} storeMode - Der store_mode aus der Config ('saver' oder 'text_entity')\n   * @returns {boolean} - true wenn dieser Adapter verwendet werden soll\n   */\n  static isApplicable(storeMode) {\n    throw new Error('isApplicable muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Initialisiert den Storage-Adapter\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @param {Function} debug - Debug-Funktion\n   */\n  constructor(hass, config, debug) {\n    this._hass = hass;\n    this._config = config;\n    this._debug = debug;\n  }\n\n  /**\n   * Speichert die serialisierten Daten\n   * @param {string} serializedData - Serialisierte Daten als String\n   * @returns {Promise<void>}\n   */\n  async saveData(serializedData) {\n    throw new Error('saveData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Ldt die Daten\n   * @returns {Promise<string|null>} - Die geladenen Daten oder null wenn keine vorhanden\n   */\n  async loadData() {\n    throw new Error('loadData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Speichert die Konfiguration\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {Promise<void>}\n   */\n  async saveConfig(activeShifts) {\n    throw new Error('saveConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Ldt die Konfiguration\n   * @returns {Promise<string|null>} - Die geladene Konfiguration oder null wenn keine vorhanden\n   */\n  async loadConfig() {\n    throw new Error('loadConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Prft, ob die Storage-Komponente verfgbar/konfiguriert ist\n   * @returns {boolean}\n   */\n  isAvailable() {\n    throw new Error('isAvailable muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Gibt Warnungen zurck (z.B. bei fehlenden Entities oder Speicherproblemen)\n   * @returns {Object|null} - Warnungsobjekt oder null\n   */\n  getWarnings() {\n    throw new Error('getWarnings muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Prft die Speichernutzung (nur fr Entity-Storage relevant)\n   * @param {number} dataLength - Lnge der zu speichernden Daten\n   * @returns {Object|null} - Nutzungsobjekt oder null\n   */\n  checkStorageUsage(dataLength) {\n    // Optional - Standard-Implementierung gibt null zurck\n    return null;\n  }\n}\n\n","/**\n * Saver-Storage-Implementierung\n * \n * Speichert Daten in Saver-Variablen (HACS Integration)\n * Kann spter leicht entfernt werden, wenn nur Entity-Storage verwendet werden soll.\n */\n\nimport { IStorageAdapter } from './storage-interface.js';\n\nexport class SaverStorage extends IStorageAdapter {\n  static isApplicable(storeMode) {\n    return storeMode === 'saver';\n  }\n\n  constructor(hass, config, debug) {\n    super(hass, config, debug);\n    this._saverKey = config?.saver_key || 'Schichtplan';\n  }\n\n  isAvailable() {\n    if (!this._hass || !this._config || !this._config.saver_key) {\n      return false;\n    }\n    // Prfe ob Saver-Entity existiert\n    const saverEntity = this._hass.states?.['saver.saver'];\n    return !!saverEntity;\n  }\n\n  /**\n   * Liest eine Saver-Variable\n   * @private\n   */\n  _readSaverVariable(key) {\n    if (!this._hass || !this._hass.states) {\n      return null;\n    }\n\n    const saverEntity = this._hass.states['saver.saver'];\n    if (!saverEntity || !saverEntity.attributes || !saverEntity.attributes.variables) {\n      return null;\n    }\n\n    const value = saverEntity.attributes.variables[key];\n    if (value === undefined || value === null) {\n      return null;\n    }\n\n    return String(value).trim();\n  }\n\n  async saveData(serializedData) {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] saveData: Nicht verfgbar');\n      return;\n    }\n\n    this._debug(\n      `[SaverStorage] saveData: Start, saver_key: \"${this._saverKey}\", Datenlnge: ${serializedData.length} Zeichen`\n    );\n\n    try {\n      // Prfe ob sich der Wert gendert hat\n      const oldValue = this._readSaverVariable(this._saverKey);\n      \n      this._debug(\n        `[SaverStorage] saveData: Saver-Variable \"${this._saverKey}\" existiert: ${oldValue !== null}, alte Lnge: ${oldValue?.length || 0} Zeichen`\n      );\n\n      // Nur schreiben wenn Variable nicht existiert oder Wert sich gendert hat\n      if (oldValue === null || oldValue !== serializedData) {\n        this._debug(\n          `[SaverStorage] saveData: Schreibe in Saver (Variable existiert nicht oder Wert hat sich gendert)`\n        );\n        await this._hass.callService('saver', 'set_variable', {\n          name: this._saverKey,\n          value: serializedData || '',\n        });\n        this._debug(`[Sync] [SaverStorage] saveData: Erfolgreich in Saver geschrieben - andere Karten sollten nderung erkennen`);\n      } else {\n        this._debug(\n          `[SaverStorage] saveData: Kein Schreiben ntig, Wert hat sich nicht gendert`\n        );\n      }\n    } catch (error) {\n      this._debug(\n        `[SaverStorage] saveData: Fehler beim Schreiben in Saver: ${error.message}`,\n        error\n      );\n      console.warn('[TG Schichtplan] Fehler beim Schreiben in Saver:', error);\n      throw error; // Wirf Fehler weiter, damit Fallback-Mechanismus greifen kann\n    }\n  }\n\n  async loadData() {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] loadData: Nicht verfgbar');\n      return null;\n    }\n\n    this._debug(\n      `[SaverStorage] loadData: Versuche Daten von Saver-Variable \"${this._saverKey}\" zu laden`\n    );\n    \n    const data = this._readSaverVariable(this._saverKey);\n\n    if (data && data.trim() !== '') {\n      this._debug(\n        `[SaverStorage] loadData: Daten erfolgreich geladen, Lnge: ${data.length} Zeichen`\n      );\n      return data;\n    }\n\n    this._debug('[SaverStorage] loadData: Keine Daten gefunden');\n    return null;\n  }\n\n  /**\n   * Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n   * Verwendet direkt das Format vom Config-Panel (calendars-Array)\n   * @private\n   */\n  _createFullJsonConfig(calendars, holidays, statusOnlyInTimeRange) {\n    const configObject = {\n      calendars: calendars,\n      holidays: holidays || {},\n      statusOnlyInTimeRange: statusOnlyInTimeRange !== undefined ? statusOnlyInTimeRange : false,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp - wird bei jedem Speichern aktualisiert\n    };\n    this._debug(`[SaverStorage] _createFullJsonConfig: lastchange auf ${configObject.lastchange} gesetzt (aktueller Unix-Timestamp)`);\n    return JSON.stringify(configObject);\n  }\n\n  async saveConfig(calendars, holidays, statusOnlyInTimeRange) {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] saveConfig: Nicht verfgbar');\n      return;\n    }\n\n    const configKey = `${this._saverKey}_config`;\n    this._debug(`[SaverStorage] saveConfig: Saver-Key: \"${this._saverKey}\", Config-Key: \"${configKey}\"`);\n    \n    const configJson = this._createFullJsonConfig(calendars, holidays, statusOnlyInTimeRange);\n    this._debug(\n      `[SaverStorage] saveConfig: JSON-Config erstellt, Lnge: ${configJson.length} Zeichen, Kalender: ${calendars?.length || 0}`\n    );\n\n    try {\n      await this._hass.callService('saver', 'set_variable', {\n        name: configKey,\n        value: String(configJson),\n      });\n      \n      this._debug(`[SaverStorage] saveConfig: Variable \"${configKey}\" wurde im Saver gespeichert`);\n    } catch (error) {\n      this._debug(\n        `[SaverStorage] saveConfig: Fehler beim Schreiben: ${error.message}`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  async loadConfig() {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] loadConfig: Nicht verfgbar');\n      return null;\n    }\n\n    const configKey = `${this._saverKey}_config`;\n    this._debug(\n      `[SaverStorage] loadConfig: Versuche Config von Saver-Variable \"${configKey}\" zu laden`\n    );\n    \n    const config = this._readSaverVariable(configKey);\n\n    if (config && config.trim() !== '') {\n      this._debug(\n        `[SaverStorage] loadConfig: Config erfolgreich geladen, Lnge: ${config.length} Zeichen`\n      );\n      return config;\n    }\n\n    this._debug('[SaverStorage] loadConfig: Keine Config gefunden');\n    return null;\n  }\n\n  getWarnings() {\n    // Saver hat keine Warnungen (keine Entity-Prfung ntig)\n    return null;\n  }\n}\n\n","/**\n * Entity-Storage-Implementierung\n * \n * Speichert Daten in input_text Entities (mit Multi-Entity-Support)\n * Kann spter leicht entfernt werden, wenn nur Saver-Storage verwendet werden soll.\n */\n\nimport { IStorageAdapter } from './storage-interface.js';\n\nexport class EntityStorage extends IStorageAdapter {\n  static isApplicable(storeMode) {\n    return storeMode === 'text_entity' || !storeMode || storeMode === '';\n  }\n\n  constructor(hass, config, debug) {\n    super(hass, config, debug);\n    this._knownEntityIds = null; // Cache fr bekannte Entities\n  }\n\n  isAvailable() {\n    return !!(this._hass && this._config && this._config.entity);\n  }\n\n  /**\n   * Findet zustzliche Entities (z.B. input_text.arbeitszeiten_001, _002, etc.)\n   * @private\n   */\n  findAdditionalEntities(baseEntityId) {\n    const additionalEntities = [];\n\n    if (!this._hass || !this._hass.states) {\n      return additionalEntities;\n    }\n\n    const entityParts = baseEntityId.split('.');\n    if (entityParts.length !== 2) {\n      return additionalEntities;\n    }\n\n    const [domain, baseName] = entityParts;\n\n    // Suche nach Entities mit _001, _002, etc. (bis _999)\n    for (let i = 1; i <= 999; i++) {\n      const suffix = String(i).padStart(3, '0');\n      const additionalEntityId = `${domain}.${baseName}_${suffix}`;\n\n      if (this._hass.states[additionalEntityId]) {\n        additionalEntities.push(additionalEntityId);\n      } else {\n        // Wenn eine Entity nicht existiert, breche ab (Entities sind sequenziell)\n        break;\n      }\n    }\n\n    return additionalEntities;\n  }\n\n  /**\n   * Ermittelt die maximale Lnge einer Entity\n   * @private\n   */\n  getEntityMaxLength(entityId) {\n    if (!this._hass || !this._hass.states || !entityId) {\n      return null;\n    }\n\n    const entity = this._hass.states[entityId];\n    if (!entity || !entity.attributes) {\n      return null;\n    }\n\n    const maxLength = entity.attributes.max;\n    if (maxLength !== undefined && maxLength !== null) {\n      return parseInt(maxLength);\n    }\n\n    return null;\n  }\n\n  /**\n   * Ermittelt die maximale Lnge aller Entities\n   * @private\n   */\n  getAllEntityMaxLengths() {\n    const maxLengths = {};\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      return maxLengths;\n    }\n\n    const mainEntityId = this._config.entity;\n    const mainMaxLength = this.getEntityMaxLength(mainEntityId);\n    if (mainMaxLength !== null) {\n      maxLengths[mainEntityId] = mainMaxLength;\n    }\n\n    const additionalEntities = this.findAdditionalEntities(mainEntityId);\n    for (const additionalEntityId of additionalEntities) {\n      const additionalMaxLength = this.getEntityMaxLength(additionalEntityId);\n      if (additionalMaxLength !== null) {\n        maxLengths[additionalEntityId] = additionalMaxLength;\n      }\n    }\n\n    return maxLengths;\n  }\n\n  /**\n   * Sammelt alle Entity-IDs (Haupt-Entity + zustzliche)\n   * @private\n   */\n  _getAllEntityIds() {\n    if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n      return [...this._knownEntityIds];\n    }\n\n    const allEntityIds = [this._config.entity];\n    const additionalEntities = this.findAdditionalEntities(this._config.entity);\n    allEntityIds.push(...additionalEntities);\n    this._knownEntityIds = [...allEntityIds];\n    return allEntityIds;\n  }\n\n  async saveData(serializedData) {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] saveData: Nicht verfgbar');\n      return;\n    }\n\n    this._debug(\n      `[EntityStorage] saveData: Start, Datenlnge: ${serializedData ? serializedData.length : 0} Zeichen`\n    );\n\n    try {\n      // Verwende die gecachte Liste der Entities, falls verfgbar\n      let allEntityIds = this._getAllEntityIds();\n\n      // Prfe ob neue Entities hinzugekommen sind\n      const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n      const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0;\n\n      if (currentAdditionalEntities.length > knownAdditionalCount) {\n        const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n        allEntityIds.push(...newEntities);\n        this._knownEntityIds = [...allEntityIds];\n      }\n\n      this._debug(\n        `[EntityStorage] saveData: Verwende ${allEntityIds.length} Entities: ${allEntityIds.join(', ')}`\n      );\n\n      // Ermittle die maximale Lnge fr jede Entity\n      const maxLengths = {};\n      let totalMaxLength = 0;\n      for (const entityId of allEntityIds) {\n        const maxLength = this.getEntityMaxLength(entityId);\n        if (maxLength !== null) {\n          maxLengths[entityId] = maxLength;\n          totalMaxLength += maxLength;\n        } else {\n          maxLengths[entityId] = 255; // Standard\n          totalMaxLength += 255;\n        }\n      }\n\n      const dataLength = serializedData ? serializedData.length : 0;\n      this._debug(\n        `[EntityStorage] saveData: Datenlnge: ${dataLength} Zeichen, verfgbarer Speicher: ${totalMaxLength} Zeichen`\n      );\n\n      // Wenn keine Daten vorhanden sind, setze alle Entities auf leer\n      if (!serializedData || serializedData.trim() === '') {\n        this._debug('[EntityStorage] saveData: Keine Daten vorhanden, setze alle Entities auf leer');\n        for (const entityId of allEntityIds) {\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: '',\n            });\n          } catch (error) {\n            this._debug(\n              `[EntityStorage] saveData: Fehler beim Leeren von \"${entityId}\": ${error.message}`\n            );\n          }\n        }\n        return;\n      }\n\n      // Verteile die Daten zeichenweise auf die Entities\n      const entityValues = {};\n      let currentEntityIndex = 0;\n      let remainingData = serializedData;\n\n      while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n        const currentEntityId = allEntityIds[currentEntityIndex];\n        const maxLength = maxLengths[currentEntityId];\n\n        const charsToTake = Math.min(remainingData.length, maxLength);\n        const valueToWrite = remainingData.substring(0, charsToTake);\n\n        entityValues[currentEntityId] = valueToWrite;\n        remainingData = remainingData.substring(charsToTake);\n\n        if (remainingData.length > 0) {\n          currentEntityIndex++;\n        }\n      }\n\n      // Wenn am Ende noch Text ber ist, prfe ob neue Entities hinzugekommen sind\n      if (remainingData.length > 0) {\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0;\n\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n\n          for (const newEntityId of newEntities) {\n            const maxLength = this.getEntityMaxLength(newEntityId);\n            if (maxLength !== null) {\n              maxLengths[newEntityId] = maxLength;\n            } else {\n              maxLengths[newEntityId] = 255;\n            }\n          }\n\n          // Versuche erneut zu verteilen\n          while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n            const currentEntityId = allEntityIds[currentEntityIndex];\n            const maxLength = maxLengths[currentEntityId];\n\n            const charsToTake = Math.min(remainingData.length, maxLength);\n            const valueToWrite = remainingData.substring(0, charsToTake);\n\n            entityValues[currentEntityId] = valueToWrite;\n            remainingData = remainingData.substring(charsToTake);\n\n            if (remainingData.length > 0) {\n              currentEntityIndex++;\n            }\n          }\n        }\n      }\n\n      // Schreibe alle Entity-Werte\n      for (const [entityId, value] of Object.entries(entityValues)) {\n        try {\n          await this._hass.callService('input_text', 'set_value', {\n            entity_id: entityId,\n            value: value,\n          });\n          this._debug(\n            `[EntityStorage] saveData: Entity \"${entityId}\" geschrieben, Lnge: ${value.length} Zeichen`\n          );\n        } catch (error) {\n          this._debug(\n            `[EntityStorage] saveData: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n          );\n        }\n      }\n\n      this._debug('[EntityStorage] saveData: Erfolgreich abgeschlossen');\n    } catch (error) {\n      this._debug(`[EntityStorage] saveData: Fehler: ${error.message}`, error);\n      throw error;\n    }\n  }\n\n  async loadData() {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] loadData: Nicht verfgbar');\n      return null;\n    }\n\n    this._debug(\n      `[EntityStorage] loadData: Start, entity: \"${this._config.entity}\"`\n    );\n\n    // Ermittle die maximale Lnge fr alle Entities\n    const maxLengths = this.getAllEntityMaxLengths();\n\n    // Sammle alle Daten-Strings aus der Haupt-Entity und zustzlichen Entities\n    const dataStrings = [];\n    const baseEntityId = this._config.entity;\n    const additionalEntities = this.findAdditionalEntities(baseEntityId);\n\n    this._debug(\n      `[EntityStorage] loadData: Gefundene Entities: Haupt: \"${baseEntityId}\", Zustzliche: ${additionalEntities.length}`\n    );\n\n    // Speichere die Liste der bekannten Entities\n    this._knownEntityIds = [baseEntityId, ...additionalEntities];\n\n    // Lade Daten aus allen Entities\n    for (const entityId of this._knownEntityIds) {\n      const entity = this._hass.states[entityId];\n      if (entity && entity.state && entity.state.trim() !== '') {\n        const entityData = entity.state;\n        dataStrings.push(entityData);\n        this._debug(\n          `[EntityStorage] loadData: Entity \"${entityId}\" hat Daten, Lnge: ${entityData.length} Zeichen`\n        );\n      } else {\n        this._debug(\n          `[EntityStorage] loadData: Entity \"${entityId}\" ist leer oder nicht vorhanden`\n        );\n      }\n    }\n\n    // Fge alle Strings zusammen (mit \";\" als Trennzeichen)\n    if (dataStrings.length > 0) {\n      const dataString = dataStrings.join(';');\n      this._debug(\n        `[EntityStorage] loadData: Daten kombiniert, Gesamtlnge: ${dataString.length} Zeichen`\n      );\n      return dataString;\n    } else {\n      this._debug('[EntityStorage] loadData: Keine Daten in Entities gefunden');\n      return null;\n    }\n  }\n\n  /**\n   * Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n   * @private\n   */\n  _createCompressedConfig(activeShifts) {\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n    }\n\n    // Entferne \"null\" aus dem String\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      configJson = configJson.replace(/,null,/g, ',,');\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    configJson = configJson.replace(/\",\"/g, ',');\n    configJson = configJson.replace(/\\[\"/g, '[');\n    configJson = configJson.replace(/\"\\]/g, ']');\n    configJson = configJson.replace(/,\"/g, ',');\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n  }\n\n  /**\n   * Ermittelt die Config-Entity-ID\n   * @private\n   */\n  getConfigEntityId() {\n    if (!this._config || !this._config.entity) {\n      return null;\n    }\n    return this._config.entity + '_config';\n  }\n\n  /**\n   * Ermittelt die Status-Entity-ID\n   * @private\n   */\n  getStatusEntityId() {\n    if (!this._config || !this._config.entity) {\n      return null;\n    }\n    return this._config.entity + '_status';\n  }\n\n  async saveConfig(activeShifts) {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] saveConfig: Nicht verfgbar');\n      return;\n    }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._debug('[EntityStorage] saveConfig: Keine configEntityId');\n      return;\n    }\n\n    this._debug(`[EntityStorage] saveConfig: Start, configEntityId: \"${configEntityId}\"`);\n\n    // Prfe ob die Entity existiert\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      this._debug(`[EntityStorage] saveConfig: Entity \"${configEntityId}\" existiert nicht`);\n      return;\n    }\n\n    // Komprimiertes Format fr text_input Entities\n    const configJson = this._createCompressedConfig(activeShifts);\n    const configJsonLength = configJson.length;\n\n    this._debug(\n      `[EntityStorage] saveConfig: Config erstellt (komprimiert), Lnge: ${configJsonLength} Zeichen`\n    );\n\n    // Prfe ob der JSON-Text in das Entity passt\n    const maxLength = this.getEntityMaxLength(configEntityId);\n    if (maxLength !== null && configJsonLength > maxLength) {\n      this._debug(\n        `[EntityStorage] saveConfig: Config ist zu lang (${configJsonLength} > ${maxLength} Zeichen)`\n      );\n      // Warnung wird von getWarnings() zurckgegeben\n    }\n\n    try {\n      await this._hass.callService('input_text', 'set_value', {\n        entity_id: configEntityId,\n        value: configJson,\n      });\n      this._debug(`[EntityStorage] saveConfig: Config erfolgreich gespeichert`);\n    } catch (error) {\n      this._debug(`[EntityStorage] saveConfig: Fehler beim Speichern: ${error.message}`, error);\n      throw error;\n    }\n  }\n\n  async loadConfig() {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] loadConfig: Nicht verfgbar');\n      return null;\n    }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      return null;\n    }\n\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity || !configEntity.state || configEntity.state.trim() === '') {\n      return null;\n    }\n\n    return configEntity.state;\n  }\n\n  checkStorageUsage(dataLength = null) {\n    if (!this.isAvailable()) {\n      return null;\n    }\n\n    const allEntityIds = this._getAllEntityIds();\n    const maxLengths = this.getAllEntityMaxLengths();\n\n    if (Object.keys(maxLengths).length === 0) {\n      return null;\n    }\n\n    // Berechne Gesamtlnge und maximale Gesamtlnge\n    let totalCurrentLength = 0;\n    let totalMaxLength = 0;\n\n    if (dataLength !== null && dataLength !== undefined) {\n      totalCurrentLength = dataLength;\n    } else {\n      // Lese Lngen aus den aktuellen States\n      for (const entityId of allEntityIds) {\n        const entity = this._hass.states[entityId];\n        if (entity && entity.state) {\n          totalCurrentLength += entity.state.length;\n        }\n      }\n    }\n\n    // Berechne maximale Gesamtlnge\n    for (const entityId of allEntityIds) {\n      const maxLength = maxLengths[entityId];\n      if (maxLength !== undefined && maxLength !== null) {\n        totalMaxLength += maxLength;\n      }\n    }\n\n    if (totalMaxLength === 0) {\n      return null;\n    }\n\n    const percentage = (totalCurrentLength / totalMaxLength) * 100;\n\n    // Prfe ob 90% berschritten werden\n    if (percentage >= 90) {\n      return {\n        show: true,\n        currentLength: totalCurrentLength,\n        maxLength: totalMaxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n    }\n\n    return null;\n  }\n\n  getWarnings() {\n    if (!this.isAvailable()) {\n      return null;\n    }\n\n    const warnings = {\n      config: null,\n      status: null,\n    };\n\n    // Prfe Config-Entity\n    const configEntityId = this.getConfigEntityId();\n    if (configEntityId) {\n      if (!this._hass || !this._hass.states[configEntityId]) {\n        warnings.config = {\n          show: true,\n          type: 'missing',\n          configEntityId: configEntityId,\n        };\n      }\n    }\n\n    // Prfe Status-Entity\n    const statusEntityId = this.getStatusEntityId();\n    if (statusEntityId) {\n      if (!this._hass || !this._hass.states[statusEntityId]) {\n        warnings.status = {\n          show: true,\n          type: 'missing',\n          statusEntityId: statusEntityId,\n        };\n      }\n    }\n\n    return warnings.config || warnings.status ? warnings : null;\n  }\n}\n\n","/**\n * Storage-Factory\n * \n * Erstellt den passenden Storage-Adapter basierend auf dem store_mode\n */\n\nimport { SaverStorage } from './saver-storage.js';\nimport { EntityStorage } from './entity-storage.js';\n\nexport class StorageFactory {\n  /**\n   * Erstellt den passenden Storage-Adapter\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @param {Function} debug - Debug-Funktion\n   * @returns {IStorageAdapter} - Der passende Storage-Adapter\n   */\n  static createStorage(hass, config, debug) {\n    const storeMode = config?.store_mode || 'text_entity';\n\n    // Prfe welche Storage-Implementierung verwendet werden soll\n    if (SaverStorage.isApplicable(storeMode)) {\n      debug('[StorageFactory] Erstelle SaverStorage');\n      return new SaverStorage(hass, config, debug);\n    } else if (EntityStorage.isApplicable(storeMode)) {\n      debug('[StorageFactory] Erstelle EntityStorage');\n      return new EntityStorage(hass, config, debug);\n    } else {\n      // Fallback zu EntityStorage\n      debug('[StorageFactory] Unbekannter store_mode, verwende EntityStorage als Fallback');\n      return new EntityStorage(hass, config, debug);\n    }\n  }\n\n  /**\n   * Prft, ob ein bestimmter Storage-Typ verfgbar ist\n   * @param {string} storeMode - Der store_mode\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @returns {boolean}\n   */\n  static isStorageAvailable(storeMode, hass, config) {\n    const storage = this.createStorage(hass, config, () => {});\n    return storage.isAvailable();\n  }\n}\n\n","/**\n * HolidayMixin - Feiertags-Berechnung fr deutsche Feiertage\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._holidayCache` - Cache-Objekt: `{}`\n * - `this._cachedHolidayEntities` - Array oder null\n * - `this._hass` - Home Assistant Objekt (optional, fr Holiday-Entities)\n * - `this.config` - Konfigurationsobjekt mit `holidays` Property (optional)\n * \n * @example\n * import { HolidayMixin } from './mixins/holiday-mixin';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     this._holidayCache = {};\n *     this._cachedHolidayEntities = null;\n *     Object.assign(this, HolidayMixin);\n *   }\n * }\n */\nexport const HolidayMixin = {\n  /**\n   * Berechnet das Osterdatum fr ein gegebenes Jahr (nach Gau-Algorithmus)\n   * @param {number} year - Jahr (z.B. 2025)\n   * @returns {Date} Osterdatum\n   */\n  _getEasterDate(year) {\n    const a = year % 19;\n    const b = Math.floor(year / 100);\n    const c = year % 100;\n    const d = Math.floor(b / 4);\n    const e = b % 4;\n    const f = Math.floor((b + 8) / 25);\n    const g = Math.floor((b - f + 1) / 3);\n    const h = (19 * a + b - d - g + 15) % 30;\n    const i = Math.floor(c / 4);\n    const k = c % 4;\n    const l = (32 + 2 * e + 2 * i - h - k) % 7;\n    const m = Math.floor((a + 11 * h + 22 * l) / 451);\n    const month = Math.floor((h + l - 7 * m + 114) / 31);\n    const day = ((h + l - 7 * m + 114) % 31) + 1;\n    return new Date(year, month - 1, day);\n  },\n\n  /**\n   * Prft ob ein Datum ein Feiertag ist (mit Cache)\n   * Versucht zuerst Home Assistant Holiday-Sensoren zu verwenden, falls vorhanden\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @param {number} day - Tag (1-31)\n   * @returns {boolean} true wenn Feiertag\n   */\n  _isHoliday(year, month, day) {\n    // Cache-Key: \"2025-12\" fr Monat/Jahr\n    const cacheKey = `${year}-${String(month + 1).padStart(2, '0')}`;\n\n    // Prfe Cache\n    if (this._holidayCache && this._holidayCache[cacheKey] && this._holidayCache[cacheKey][day] !== undefined) {\n      return this._holidayCache[cacheKey][day];\n    }\n\n    // Initialisiere Cache fr diesen Monat\n    if (!this._holidayCache) {\n      this._holidayCache = {};\n    }\n    if (!this._holidayCache[cacheKey]) {\n      this._holidayCache[cacheKey] = {};\n    }\n\n    let result = false;\n\n    // Prfe ob Home Assistant Holiday-Sensoren verfgbar sind\n    if (this._hass && this._hass.states) {\n      // Suche nach Holiday-Sensoren (z.B. sensor.germany_holidays, sensor.holidays, etc.)\n      // OPTIMIERUNG: Cache Holiday-Entities, nicht bei jedem Aufruf suchen\n      if (!this._cachedHolidayEntities) {\n        this._cachedHolidayEntities = Object.keys(this._hass.states).filter(entityId => {\n          return (\n            entityId.startsWith('sensor.') &&\n            (entityId.includes('holiday') || entityId.includes('feiertag')) &&\n            this._hass.states[entityId].state === 'on'\n          );\n        });\n      }\n\n      const holidayEntities = this._cachedHolidayEntities;\n\n      if (holidayEntities.length > 0) {\n        // Prfe ob das Datum in den Holiday-Attributen enthalten ist\n        for (const entityId of holidayEntities) {\n          const entity = this._hass.states[entityId];\n          if (entity && entity.attributes) {\n            // Prfe verschiedene mgliche Attribute-Formate\n            const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n            const dateStrShort = `${String(day).padStart(2, '0')}.${String(month + 1).padStart(2, '0')}.${year}`;\n\n            // Prfe verschiedene Attribute-Namen\n            const possibleAttrs = [\n              'dates',\n              'holidays',\n              'feiertage',\n              'date',\n              'next_date',\n              'upcoming',\n            ];\n            for (const attr of possibleAttrs) {\n              if (entity.attributes[attr]) {\n                const attrValue = entity.attributes[attr];\n                if (Array.isArray(attrValue)) {\n                  if (\n                    attrValue.some(\n                      d =>\n                        d === dateStr ||\n                        d === dateStrShort ||\n                        d.includes(dateStr) ||\n                        d.includes(dateStrShort)\n                    )\n                  ) {\n                    result = true;\n                    break;\n                  }\n                } else if (typeof attrValue === 'string') {\n                  if (attrValue.includes(dateStr) || attrValue.includes(dateStrShort)) {\n                    result = true;\n                    break;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Hole Feiertags-Konfiguration aus der Config (Standard: alle aktiviert)\n    const holidaysConfig = this.config?.holidays || {};\n    const isHolidayEnabled = key => holidaysConfig[key] !== false; // Default: true wenn nicht gesetzt\n\n    // Fallback: Berechne deutsche Feiertage selbst\n    const easter = this._getEasterDate(year);\n\n    // Feste Feiertage mit Konfigurationsprfung\n    const fixedHolidays = [\n      { month: 0, day: 1, key: 'neujahr' }, // Neujahr\n      { month: 0, day: 6, key: 'heilige_drei_koenige' }, // Heilige Drei Knige\n      { month: 4, day: 1, key: 'tag_der_arbeit' }, // Tag der Arbeit\n      { month: 7, day: 8, key: 'friedensfest' }, // Friedensfest (nur in Augsburg)\n      { month: 7, day: 15, key: 'mariae_himmelfahrt' }, // Mari Himmelfahrt\n      { month: 9, day: 3, key: 'tag_der_deutschen_einheit' }, // Tag der Deutschen Einheit\n      { month: 9, day: 31, key: 'reformationstag' }, // Reformationstag\n      { month: 10, day: 1, key: 'allerheiligen' }, // Allerheiligen\n      { month: 11, day: 25, key: 'weihnachten_1' }, // 1. Weihnachtsfeiertag\n      { month: 11, day: 26, key: 'weihnachten_2' }, // 2. Weihnachtsfeiertag\n    ];\n\n    if (!result) {\n      // Prfe feste Feiertage\n      for (const holiday of fixedHolidays) {\n        if (month === holiday.month && day === holiday.day && isHolidayEnabled(holiday.key)) {\n          result = true;\n          break;\n        }\n      }\n    }\n\n    if (!result) {\n      // Bewegliche Feiertage (abhngig von Ostern)\n      const easterTime = easter.getTime();\n      const oneDay = 24 * 60 * 60 * 1000;\n\n      // Bu- und Bettag: Mittwoch vor dem 23. November (oder am 23. November, falls es ein Mittwoch ist)\n      const nov23 = new Date(year, 10, 23); // 23. November (month ist 0-basiert)\n      const dayOfWeekNov23 = nov23.getDay(); // 0 = Sonntag, 1 = Montag, ..., 3 = Mittwoch, ..., 6 = Samstag\n      // Berechne wie viele Tage zurck zum Mittwoch\n      const daysToSubtract = dayOfWeekNov23 <= 3 ? 3 - dayOfWeekNov23 : dayOfWeekNov23 + 7 - 3;\n      const busstag = new Date(year, 10, 23 - daysToSubtract);\n\n      const movableHolidays = [\n        { date: new Date(easterTime - 2 * oneDay), key: 'karfreitag' }, // Karfreitag\n        { date: new Date(easterTime + 1 * oneDay), key: 'ostermontag' }, // Ostermontag\n        { date: new Date(easterTime + 39 * oneDay), key: 'christi_himmelfahrt' }, // Christi Himmelfahrt\n        { date: new Date(easterTime + 50 * oneDay), key: 'pfingstmontag' }, // Pfingstmontag\n        { date: new Date(easterTime + 60 * oneDay), key: 'fronleichnam' }, // Fronleichnam (nur in bestimmten Bundeslndern)\n        { date: busstag, key: 'busstag' }, // Bu- und Bettag (nur in Sachsen)\n      ];\n\n      // Prfe bewegliche Feiertage\n      for (const holiday of movableHolidays) {\n        if (\n          holiday.date.getFullYear() === year &&\n          holiday.date.getMonth() === month &&\n          holiday.date.getDate() === day &&\n          isHolidayEnabled(holiday.key)\n        ) {\n          result = true;\n          break;\n        }\n      }\n    }\n\n    // Cache speichern\n    this._holidayCache[cacheKey][day] = result;\n\n    return result;\n  },\n\n  /**\n   * Prft ob ein Datum ein Wochenende ist\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @param {number} day - Tag (1-31)\n   * @returns {boolean} true wenn Wochenende (Samstag oder Sonntag)\n   */\n  _isWeekend(year, month, day) {\n    const date = new Date(year, month, day);\n    const dayOfWeek = date.getDay();\n    return dayOfWeek === 0 || dayOfWeek === 6; // Sonntag = 0, Samstag = 6\n  },\n};\n\n","/**\n * DataManagementMixin - Serialisierung und Parsing von WorkingDays\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._workingDays` - Objekt mit WorkingDays-Daten: `{\"year:month\": {day: [elements]}}`\n * - `this.formatTwoDigits()` - Methode aus DateUtils (wird per Object.assign hinzugefgt)\n * \n * @example\n * import { DataManagementMixin } from './mixins/data-management-mixin';\n * import { DateUtils } from '../../utils/date-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     this._workingDays = {};\n *     Object.assign(this, DateUtils, DataManagementMixin);\n *   }\n * }\n */\nexport const DataManagementMixin = {\n  /**\n   * Serialisiert WorkingDays zu String-Format\n   * Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>;<jahr>:<monat>:<tag><elementen>\n   * Beispiel: \"25:11:01a,02ab,03b;25:12:01a,09a\"\n   * @returns {string} Serialisierte Daten\n   */\n  serializeWorkingDays() {\n    const parts = [];\n    // Sortiere nach Jahr:Monat\n    const keys = Object.keys(this._workingDays).sort((a, b) => {\n      const [yearA, monthA] = a.split(':').map(x => parseInt(x));\n      const [yearB, monthB] = b.split(':').map(x => parseInt(x));\n      if (yearA !== yearB) return yearA - yearB;\n      return monthA - monthB;\n    });\n\n    for (const key of keys) {\n      const days = this._workingDays[key];\n      if (!days || typeof days !== 'object' || Array.isArray(days)) continue;\n\n      // Struktur: {day: [elements]}\n      const dayEntries = Object.keys(days)\n        .map(d => parseInt(d))\n        .filter(d => !isNaN(d))\n        .sort((a, b) => a - b);\n\n      if (dayEntries.length > 0) {\n        // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n        // Beispiel: \"25:11:01a,02ab,03b\"\n        const formattedDays = dayEntries\n          .map(dayNum => {\n            const elements = days[dayNum];\n            const dayStr = this.formatTwoDigits(dayNum);\n            if (Array.isArray(elements) && elements.length > 0) {\n              // Sortiere die Kalender-Shortcuts alphabetisch (a, b, c, d, e) fr konsistente Reihenfolge\n              const sortedElements = [...elements].sort();\n              // Tag mit Elementen: \"01a\", \"02ab\", etc.\n              return dayStr + sortedElements.join('');\n            } else {\n              // Tag ohne Elemente\n              return dayStr;\n            }\n          })\n          .join(',');\n        parts.push(`${key}:${formattedDays}`);\n      }\n    }\n    return parts.join(';');\n  },\n\n  /**\n   * Parst Daten-String zu WorkingDays-Objekt\n   * @param {string} dataString - Serialisierte Daten\n   */\n  parseWorkingDays(dataString) {\n    this._workingDays = {};\n    this._parseWorkingDaysIntoObject(dataString, this._workingDays);\n  },\n\n  /**\n   * Parst Daten-String in ein Ziel-Objekt\n   * @private\n   * @param {string} dataString - Serialisierte Daten\n   * @param {Object} targetObject - Ziel-Objekt fr die geparsten Daten\n   */\n  _parseWorkingDaysIntoObject(dataString, targetObject) {\n    if (!dataString || dataString.trim() === '') return;\n\n    const parts = dataString.split(';').filter(p => p.trim() !== '');\n    for (const part of parts) {\n      const trimmedPart = part.trim();\n      if (!trimmedPart) continue;\n\n      // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen> oder altes Format\n      // Beispiel: \"25:11:01a,02ah,03b\" oder \"25:11:01,02,03\" (altes Format ohne Elemente)\n      const colons = trimmedPart.split(':');\n\n      if (colons.length === 2) {\n        // Altes Format ohne Jahr (Kompatibilitt): <monat>:<tag>,<tag>\n        const month = colons[0].trim();\n        const daysStr = colons[1].trim();\n        if (month && daysStr) {\n          const monthNum = parseInt(month);\n          if (!isNaN(monthNum) && monthNum >= 1 && monthNum <= 12) {\n            // Verwende aktuelles Jahr\n            const now = new Date();\n            const year = now.getFullYear() % 100;\n            const key = `${this.formatTwoDigits(year)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        }\n      } else if (colons.length >= 3) {\n        // Prfe ob erstes Element ein Jahr ist (kleiner als 13) oder ein Monat\n        const first = parseInt(colons[0].trim());\n        const second = parseInt(colons[1].trim());\n\n        if (first <= 12 && second > 12) {\n          // Altes Format: <monat>:<jahr>:<tag>,<tag> - konvertiere zu neuem Format\n          const monthNum = first;\n          const yearNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        } else if (first > 12 && second <= 12) {\n          // Neues Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n          const yearNum = first;\n          const monthNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Parst Tage mit Elementen: \"01a,02ah,03b\" -> {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]}\n   * Oder altes Format ohne Elemente: \"01,02,03\" -> {1: [], 2: [], 3: []}\n   * @private\n   * @param {string} daysStr - String mit Tagen und Elementen\n   * @returns {Object} Objekt mit Tagen als Keys und Elementen als Arrays\n   */\n  _parseDaysWithElements(daysStr) {\n    const result = {};\n    const dayEntries = daysStr.split(',').filter(d => d.trim() !== '');\n\n    for (const entry of dayEntries) {\n      const trimmed = entry.trim();\n      if (!trimmed) continue;\n\n      // Extrahiere Tag und Elemente: \"01a\" -> day=1, elements=[\"a\"]\n      // Oder: \"02ah\" -> day=2, elements=[\"a\", \"h\"]\n      // Oder altes Format: \"01\" -> day=1, elements=[]\n      const match = trimmed.match(/^(\\d+)([a-z]*)$/i);\n      if (match) {\n        const dayNum = parseInt(match[1]);\n        const elementsStr = match[2] || '';\n        // WICHTIG: Filtere nur leere Strings heraus, nicht einzelne Buchstaben\n        // split('') teilt jeden Buchstaben in ein separates Array-Element\n        const elements = elementsStr.split('').filter(e => e && e.trim() !== '');\n\n        if (!isNaN(dayNum) && dayNum >= 1 && dayNum <= 31) {\n          // Wenn der Tag bereits existiert, fge Elemente hinzu (keine Duplikate)\n          if (result[dayNum]) {\n            // Vereinige Arrays und entferne Duplikate\n            result[dayNum] = [...new Set([...result[dayNum], ...elements])];\n          } else {\n            result[dayNum] = elements;\n          }\n        }\n      } else {\n        // Debug-Log wenn kein Match gefunden wurde (nur wenn _debug vorhanden)\n        if (trimmed.includes('03') && this._debug) {\n          this._debug(`[Parsing] Kein Match fr \"${trimmed}\"`);\n        }\n      }\n    }\n\n    return result;\n  },\n};\n\n","/**\n * CalendarMixin - Kalender-Management und -Berechnungen\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this.config` - Konfigurationsobjekt mit `calendars` Array\n * - `this._selectedCalendar` - String mit dem Shortcut des ausgewhlten Kalenders\n * \n * **Statische Konstante (muss in Hauptklasse definiert werden):**\n * - `ShiftScheduleView.CALENDARS` - Array mit Standard-Kalender-Definitionen\n * \n * @example\n * import { CalendarMixin } from './mixins/calendar-mixin';\n * class MyView extends LitElement {\n *   static CALENDARS = [\n *     { shortcut: 'a', name: 'Schicht A', defaultColor: '#ff9800' },\n *     // ...\n *   ];\n *   \n *   constructor() {\n *     super();\n *     this._selectedCalendar = null;\n *     Object.assign(this, CalendarMixin);\n *   }\n * }\n */\nexport const CalendarMixin = {\n  /**\n   * Gibt alle aktivierten Kalender zurck\n   * @returns {Array} Array von Kalender-Objekten, sortiert nach Shortcut\n   */\n  _getAllCalendars() {\n    // Gibt nur aktivierte Kalender zurck\n    if (!this._config?.calendars) {\n      return [];\n    }\n\n    // Filtere nur aktivierte Kalender und sortiere nach Shortcut (a, b, c, d, e)\n    return this._config.calendars\n      .filter(\n        cal =>\n          cal &&\n          cal.shortcut &&\n          (cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1)\n      )\n      .sort((a, b) => a.shortcut.localeCompare(b.shortcut));\n  },\n\n  /**\n   * Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n   * @param {string} shortcut - Shortcut des Kalenders (z.B. 'a', 'b', 'c')\n   * @returns {Object|null} Kalender-Objekt oder null wenn nicht gefunden\n   */\n  _getCalendarByShortcut(shortcut) {\n    // Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n    if (!this._config?.calendars) {\n      return null;\n    }\n\n    return this._config.calendars.find(cal => cal.shortcut === shortcut) || null;\n  },\n\n  /**\n   * Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n   * @param {string} shortcut - Shortcut des Kalenders (z.B. 'a', 'b', 'c')\n   * @returns {string} Hex-Farbe (z.B. '#ff9800')\n   */\n  _getDefaultColorForShortcut(shortcut) {\n    // Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n    // Prfe ob die Hauptklasse eine CALENDARS-Konstante hat\n    const CalendarsClass = this.constructor;\n    if (CalendarsClass && CalendarsClass.CALENDARS) {\n      const defaultCalendar = CalendarsClass.CALENDARS.find(cal => cal.shortcut === shortcut);\n      return defaultCalendar ? defaultCalendar.defaultColor : '#ff9800';\n    }\n    // Fallback, falls CALENDARS nicht definiert ist\n    return '#ff9800';\n  },\n\n  /**\n   * Gibt den Shortcut des ausgewhlten Kalenders zurck\n   * @returns {string|null} Shortcut des ausgewhlten Kalenders oder null\n   */\n  _getSelectedCalendarShortcut() {\n    // Gibt den Shortcut des ausgewhlten Kalenders zurck\n\n    // Prfe zuerst _selectedCalendar\n    if (\n      this._selectedCalendar !== null &&\n      this._selectedCalendar !== undefined &&\n      this._selectedCalendar !== ''\n    ) {\n      return this._selectedCalendar;\n    }\n\n    // Falls _selectedCalendar nicht gesetzt ist, prfe die Config\n    if (this._config?.selectedCalendar) {\n      this._selectedCalendar = this._config.selectedCalendar;\n      return this._selectedCalendar;\n    }\n\n    // Fallback: Verwende den ersten aktivierten Kalender\n    const allCalendars = this._getAllCalendars();\n    if (allCalendars.length > 0) {\n      return allCalendars[0].shortcut;\n    }\n    // Wenn kein Kalender aktiviert ist, gibt es keinen Fallback\n    return null;\n  },\n};\n\n","/**\n * ConfigManagementMixin - Config-Format-Konvertierung\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._config` - Konfigurationsobjekt\n * \n * @example\n * import { ConfigManagementMixin } from './mixins/config-management-mixin';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, ConfigManagementMixin);\n *   }\n * }\n */\nexport const ConfigManagementMixin = {\n  /**\n   * Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n   * Entfernt Anfhrungszeichen und null-Werte fr kompakte Speicherung\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {string} Komprimierte Config als String\n   */\n  _createCompressedConfig(activeShifts) {\n    // Speichere als JSON (direktes Array, kein Objekt-Wrapper)\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer (erstes [ und letztes ])\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n    }\n\n    // Entferne \"null\" aus dem String (behalte Kommas)\n    // Wiederhole die Ersetzung, bis keine null mehr vorhanden sind (fr mehrere null hintereinander)\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      // Ersetze ,null, durch ,, (mehrfach, bis keine null mehr vorhanden sind)\n      configJson = configJson.replace(/,null,/g, ',,');\n      // Ersetze ,null] durch ,] (falls am Ende eines Arrays)\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      // Ersetze [null, durch [, (falls am Anfang eines Arrays)\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      // Ersetze ,null, am Ende des Strings (falls letztes Element null ist)\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    // Ersetze \",\" durch , (Anfhrungszeichen um Kommas)\n    configJson = configJson.replace(/\",\"/g, ',');\n    // Ersetze [\" durch [ (Anfhrungszeichen am Anfang eines Arrays)\n    configJson = configJson.replace(/\\[\"/g, '[');\n    // Ersetze \"] durch ] (Anfhrungszeichen am Ende eines Arrays)\n    configJson = configJson.replace(/\"\\]/g, ']');\n    // Ersetze ,\" durch , (Anfhrungszeichen nach Komma)\n    configJson = configJson.replace(/,\"/g, ',');\n    // Ersetze \", durch , (Anfhrungszeichen vor Komma)\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n  },\n\n  /**\n   * Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {string} Vollstndiges JSON als String\n   */\n  _createFullJsonConfig(activeShifts) {\n    // Vollstndiges JSON-Format: Objekt mit shifts, setup und lastchange\n    // Format: {shifts:[], setup:{}, lastchange:123456789}\n    const configObject = {\n      shifts: activeShifts,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp (Sekunden seit 1970-01-01)\n    };\n    return JSON.stringify(configObject);\n  },\n};\n\n","/**\n * RenderingMixin - DOM-Manipulation und Rendering-Helper\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._workingDays` - WorkingDays-Daten\n * - `this._storageWarning` - Storage-Warnung\n * - `this._configWarning` - Config-Warnung\n * - `this._statusWarning` - Status-Warnung\n * - `this._config` - Konfiguration\n * - `this._isInEditorMode()` - Methode aus Hauptklasse\n * - `this._getSelectedCalendarShortcut()` - Methode aus CalendarMixin\n * - `this._getCalendarByShortcut()` - Methode aus CalendarMixin\n * - `this._isHoliday()` - Methode aus HolidayMixin\n * - `this._isWeekend()` - Methode aus HolidayMixin\n * - `this._getContrastColor()` - Methode aus ColorUtils\n * - `this.formatTwoDigits()` - Methode aus DateUtils\n * - `this.getDaysInMonth()` - Methode aus DateUtils\n * - `this.getFirstDayOfMonth()` - Methode aus DateUtils\n * - `this.getMonthName()` - Methode aus DateUtils\n * \n * @example\n * import { RenderingMixin } from './mixins/rendering-mixin';\n * import { HolidayMixin } from './mixins/holiday-mixin';\n * import { CalendarMixin } from './mixins/calendar-mixin';\n * import { DateUtils } from '../../utils/date-utils';\n * import { ColorUtils } from '../../utils/color-utils';\n * \n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, HolidayMixin, CalendarMixin, DateUtils, ColorUtils, RenderingMixin);\n *   }\n * }\n */\nexport const RenderingMixin = {\n  /**\n   * Gibt die Elemente fr einen bestimmten Tag zurck\n   * @param {string} monthKey - Monats-Key (z.B. \"25:11\")\n   * @param {number} day - Tag (1-31)\n   * @returns {Array} Array von Elementen (z.B. [\"a\", \"b\"])\n   */\n  _getDayElements(monthKey, day) {\n    // Gibt die Elemente fr einen bestimmten Tag zurck\n    // Reduziere Debug-Ausgaben: Nur bei ersten 3 Tagen oder wenn keine Daten gefunden werden\n    const shouldDebug = day <= 3 || !this._workingDays[monthKey];\n    \n    if (shouldDebug && this._debug) {\n      this._debug(`[Render] _getDayElements: Suche nach monthKey=\"${monthKey}\", day=${day}`);\n    }\n    \n    if (!this._workingDays[monthKey] || typeof this._workingDays[monthKey] !== 'object') {\n      if (shouldDebug && this._debug) {\n        this._debug(`[Render] _getDayElements: Keine Daten fr monthKey=\"${monthKey}\" gefunden oder kein Objekt`);\n        this._debug(`[Render] _getDayElements: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n      }\n      return [];\n    }\n\n    if (Array.isArray(this._workingDays[monthKey])) {\n      // Altes Format: Array von Tagen\n      if (shouldDebug && this._debug) {\n        this._debug(`[Render] _getDayElements: Altes Format (Array) fr monthKey=\"${monthKey}\"`);\n      }\n      return [];\n    }\n\n    const elements = this._workingDays[monthKey][day] || [];\n    if (shouldDebug && elements.length > 0 && this._debug) {\n      this._debug(`[Render] _getDayElements: Gefundene Elemente fr \"${monthKey}\", Tag ${day}:`, elements);\n    }\n\n    return elements;\n  },\n\n  /**\n   * Rendert eine Warnung fr eine fehlende Entity\n   * @param {string} entityId - Entity-ID (z.B. \"input_text.config\")\n   * @param {string} entityName - Name der Entity (z.B. \"Konfigurations-Entity\")\n   * @param {number} maxLength - Maximale Lnge (Standard: 255)\n   * @param {boolean} isConfig - Ob es eine Config-Entity ist\n   * @returns {TemplateResult} HTML-Template\n   */\n  _renderMissingEntityWarning(entityId, entityName, maxLength = 255, isConfig = false) {\n    const entityNameShort = entityId.replace('input_text.', '');\n    // html muss aus lit importiert werden - wird in Hauptklasse verwendet\n    const { html } = this.constructor.litHtml || {};\n    if (!html) {\n      // Fallback wenn html nicht verfgbar ist\n      return null;\n    }\n    \n    return html`\n      <div class=\"storage-warning\">\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">${entityName} fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${entityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hinzufgen  Text</li>\n              <li>Name: <code>${entityNameShort}</code></li>\n              <li>Maximale Lnge: <code>${maxLength}</code> Zeichen</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  },\n};\n\n","/**\n * DateUtils - Wiederverwendbare Datum-Utilities\n * \n * Diese Utilities knnen in anderen Projekten verwendet werden.\n * \n * @example\n * import { DateUtils } from './utils/date-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, DateUtils);\n *   }\n * }\n */\nexport const DateUtils = {\n  /**\n   * Formatiert eine Zahl auf zwei Ziffern (z.B. 1 -> \"01\", 25 -> \"25\")\n   * @param {number} num - Die zu formatierende Zahl\n   * @returns {string} Formatierte Zahl als String mit fhrender Null\n   */\n  formatTwoDigits(num) {\n    return String(num).padStart(2, '0');\n  },\n\n  /**\n   * Gibt die Anzahl der Tage in einem Monat zurck\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Anzahl der Tage im Monat\n   */\n  getDaysInMonth(year, month) {\n    return new Date(year, month + 1, 0).getDate();\n  },\n\n  /**\n   * Gibt den Wochentag des ersten Tages eines Monats zurck\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Wochentag (0 = Sonntag, 1 = Montag, ..., 6 = Samstag)\n   */\n  getFirstDayOfMonth(year, month) {\n    return new Date(year, month, 1).getDay();\n  },\n\n  /**\n   * Gibt den deutschen Monatsnamen zurck\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {string} Monatsname auf Deutsch\n   */\n  getMonthName(month) {\n    const months = [\n      'Januar',\n      'Februar',\n      'Mrz',\n      'April',\n      'Mai',\n      'Juni',\n      'Juli',\n      'August',\n      'September',\n      'Oktober',\n      'November',\n      'Dezember',\n    ];\n    return months[month] || '';\n  },\n\n  /**\n   * Gibt den ersten Wochentag eines Monats zurck (Montag = 0)\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Wochentag mit Montag = 0 (0 = Montag, 1 = Dienstag, ..., 6 = Sonntag)\n   */\n  getFirstDayOfWeekMondayBased(year, month) {\n    const firstDay = this.getFirstDayOfMonth(year, month);\n    // Konvertiere von Sonntag=0 zu Montag=0\n    return (firstDay + 6) % 7;\n  },\n};\n\n","/**\n * ColorUtils - Wiederverwendbare Farb-Utilities\n * \n * Diese Utilities knnen in anderen Projekten verwendet werden.\n * \n * @example\n * import { ColorUtils } from './utils/color-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, ColorUtils);\n *   }\n * }\n */\nexport const ColorUtils = {\n  /**\n   * Berechnet die Kontrastfarbe (schwarz oder wei) fr eine gegebene Hintergrundfarbe\n   * Verwendet WCAG-Luminanz-Berechnung\n   * @param {string} hexColor - Hex-Farbe (z.B. \"#ff9800\" oder \"ff9800\")\n   * @returns {string} \"#000000\" fr helle Hintergrnde, \"#ffffff\" fr dunkle Hintergrnde\n   */\n  _getContrastColor(hexColor) {\n    if (!hexColor) return '#000000';\n\n    // Entferne # falls vorhanden\n    const hex = hexColor.replace('#', '');\n\n    // Konvertiere zu RGB\n    const r = parseInt(hex.substr(0, 2), 16);\n    const g = parseInt(hex.substr(2, 2), 16);\n    const b = parseInt(hex.substr(4, 2), 16);\n\n    // Berechne relative Luminanz (nach WCAG)\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n\n    // Wenn Luminanz > 0.5, verwende schwarz, sonst wei\n    return luminance > 0.5 ? '#000000' : '#ffffff';\n  },\n\n  /**\n   * Konvertiert eine Hex-Farbe zu RGB\n   * @param {string} hex - Hex-Farbe (z.B. \"#ff9800\" oder \"ff9800\")\n   * @returns {Object} {r, g, b} oder null bei Fehler\n   */\n  hexToRgb(hex) {\n    if (!hex) return null;\n\n    const cleanHex = hex.replace('#', '');\n    if (cleanHex.length !== 6) return null;\n\n    return {\n      r: parseInt(cleanHex.substr(0, 2), 16),\n      g: parseInt(cleanHex.substr(2, 2), 16),\n      b: parseInt(cleanHex.substr(4, 2), 16),\n    };\n  },\n\n  /**\n   * Konvertiert RGB zu Hex-Farbe\n   * @param {number} r - Rot (0-255)\n   * @param {number} g - Grn (0-255)\n   * @param {number} b - Blau (0-255)\n   * @returns {string} Hex-Farbe (z.B. \"#ff9800\")\n   */\n  rgbToHex(r, g, b) {\n    const toHex = (n) => {\n      const hex = Math.round(n).toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    };\n    return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n  },\n};\n\n","import { css } from 'lit';\n\n/**\n * Gemeinsame CSS-Styles fr Menu-Bars\n * Diese Styles werden von shiftschedule-view.js und shift-config-panel.js verwendet\n */\nexport const sharedMenuStyles = css`\n  /* Gemeinsame Vorlage fr Menu-Bar: a (links), b (zentriert), c (rechts), d (zentriert) */\n  .menu-bar-row {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n\n  .menu-bar-left {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    flex-shrink: 0;\n  }\n\n  .menu-bar-center {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex: 1;\n    min-width: 0;\n  }\n\n  .menu-bar-right {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    flex-shrink: 0;\n  }\n\n  .menu-bar-full-width {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n  }\n\n  .menu-button {\n    width: 32px;\n    height: 32px;\n    border-radius: 4px;\n    border: 1px solid var(--divider-color, #e0e0e0);\n    background-color: var(--primary-color, #03a9f4);\n    color: var(--text-primary-color, #ffffff);\n    font-size: 20px;\n    font-weight: bold;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition:\n      background-color 0.2s ease,\n      opacity 0.2s ease;\n  }\n\n  .menu-button:hover:not(:disabled) {\n    background-color: var(--primary-color-dark, #0288d1);\n  }\n\n  .menu-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .cancel-button {\n    background: none;\n    border: none;\n    color: var(--secondary-text-color, #757575);\n  }\n\n  .cancel-button:hover {\n    color: var(--error-color, #f44336);\n  }\n\n  .confirm-button {\n    background: none;\n    border: none;\n    color: var(--success-color, #4caf50);\n  }\n\n  .confirm-button:hover:not(:disabled) {\n    color: var(--success-color-dark, #45a049);\n    transform: scale(1.1);\n  }\n\n  .confirm-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .menu-controls {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 12px;\n  }\n\n  .menu-button.navigation-button {\n    background-color: var(--secondary-color, #757575);\n  }\n\n  .menu-button.navigation-button:hover:not(:disabled) {\n    background-color: var(--secondary-color-dark, #616161);\n  }\n\n  /* Gemeinsame Styles fr Farbleisten */\n  .shifts-color-bar,\n  .color-bar {\n    display: flex;\n    gap: 4px;\n    align-items: stretch;\n    width: 100%;\n  }\n\n  .shift-color-button,\n  .color-button {\n    flex: 1;\n    min-width: 0;\n    height: 30px;\n    border-radius: 4px;\n    border: 2px solid transparent;\n    cursor: pointer;\n    transition: all 0.2s;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 12px;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    padding: 0 4px;\n  }\n\n  .shift-color-button:hover,\n  .color-button:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n  }\n\n  .shift-color-button.selected,\n  .color-button.selected {\n    border: 3px solid var(--primary-color, #03a9f4);\n    box-shadow: \n      0 0 0 2px var(--card-background-color, #ffffff),\n      0 0 0 4px var(--primary-color, #03a9f4),\n      0 2px 8px rgba(0, 0, 0, 0.3);\n    transform: translateY(-1px);\n  }\n\n  .shift-color-button.disabled,\n  .color-button.disabled {\n    opacity: 0.3;\n  }\n\n  .shift-color-button.disabled::after,\n  .color-button.disabled::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: repeating-linear-gradient(\n      45deg,\n      transparent,\n      transparent 10px,\n      rgba(0, 0, 0, 0.1) 10px,\n      rgba(0, 0, 0, 0.1) 20px\n    );\n    pointer-events: none;\n  }\n`;\n\n","import { html } from 'lit';\n\n/**\n * Template-Funktion fr die gemeinsame Menu-Bar-Struktur\n * \n * @param {Object} options - Konfigurationsobjekt\n * @param {import('lit').TemplateResult|string} options.left - Inhalt fr menu-bar-left\n * @param {import('lit').TemplateResult|string} options.center - Inhalt fr menu-bar-center\n * @param {import('lit').TemplateResult|string} options.right - Inhalt fr menu-bar-right\n * @param {import('lit').TemplateResult|string} options.fullWidth - Inhalt fr menu-bar-full-width\n * @returns {import('lit').TemplateResult}\n */\nexport function renderMenuBar({ left = '', center = '', right = '', fullWidth = '' }) {\n  return html`\n    <div class=\"menu-bar-row\">\n      <div class=\"menu-bar-left\">${left}</div>\n      <div class=\"menu-bar-center\">${center}</div>\n      <div class=\"menu-bar-right\">${right}</div>\n    </div>\n    ${fullWidth ? html`<div class=\"menu-bar-full-width\">${fullWidth}</div>` : ''}\n  `;\n}\n","/**\n * ShiftConfigPanel - Konfigurationspanel fr Schichten\n * \n * Verwaltet die Konfiguration aller Schichten (aktiv/inaktiv, Reihenfolge, etc.)\n */\n\nimport { html, css, LitElement } from 'lit';\nimport { sharedMenuStyles } from './shared-menu-styles.js';\nimport { renderMenuBar } from './menu-bar-template.js';\nimport { Version } from '../../card-config.js';\n\nexport class ShiftConfigPanel extends LitElement {\n  static properties = {\n    calendars: {\n      type: Array,\n      hasChanged(newVal, oldVal) {\n        // Verhindere Updates wenn Panel bereits initialisiert wurde\n        // Nur beim ersten Setzen (oldVal ist undefined) erlauben wir Updates\n        if (oldVal === undefined) {\n          return true; // Erste Initialisierung erlauben\n        }\n        // Nach der Initialisierung: Ignoriere externe Updates\n        // Das Panel verwaltet seine eigenen calendars intern\n        return false;\n      }\n    },\n    selectedShortcut: { type: String },\n    hass: { type: Object },\n    _validationErrors: { type: Object, state: true },\n    _currentView: { type: String, state: true },\n    holidays: { type: Object },\n    statusOnlyInTimeRange: { type: Boolean },\n  };\n\n  static styles = [\n    sharedMenuStyles,\n    css`\n    :host {\n      display: block;\n      width: 100%;\n    }\n\n    /* Gemeinsame Menu-Styles werden aus shared-menu-styles.js importiert */\n\n    .config-menu-bar {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      padding: 12px;\n      background-color: var(--card-background-color, #ffffff);\n      border-radius: 4px 4px 0 0;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-bottom: none;\n    }\n\n    .config-panel {\n      background-color: var(--card-background-color, #ffffff);\n      border-radius: 0 0 4px 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-top: none;\n      display: flex;\n      flex-direction: column;\n      padding: 12px;\n      position: relative;\n      min-height: 200px;\n    }\n\n\n    /* Gemeinsame Menu-Styles und Farbleisten-Styles werden aus shared-menu-styles.js importiert */\n\n    .control-button {\n      width: 40px;\n      height: 40px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: background-color 0.2s;\n      font-size: 18px;\n    }\n\n    .control-button:hover:not(:disabled) {\n      background-color: var(--divider-color, #e0e0e0);\n    }\n\n    .control-button:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    .control-button.delete {\n      color: var(--error-color, #f44336);\n    }\n\n    .control-button.delete:hover:not(:disabled) {\n      background-color: var(--error-color, #f44336);\n      color: white;\n    }\n\n    .add-shift-color-button {\n      flex: 0 0 30px !important;\n      background-color: var(--divider-color, #e0e0e0) !important;\n      color: var(--primary-text-color, #212121);\n      font-size: 24px;\n      font-weight: bold;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border: 2px dashed var(--divider-color, #e0e0e0) !important;\n      min-width: 30px;\n      max-width: 30px;\n    }\n\n    .add-shift-color-button:hover:not(:disabled) {\n      background-color: var(--primary-color, #03a9f4) !important;\n      color: white;\n      border-color: var(--primary-color, #03a9f4) !important;\n    }\n\n    .add-shift-color-button:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n\n    .shift-item.disabled {\n      opacity: 0.5;\n    }\n\n    .shifts-list {\n      margin-bottom: 24px;\n    }\n\n    .shift-editor {\n      border-top: 1px solid var(--divider-color, #e0e0e0);\n      padding-top: 16px;\n      margin-top: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 20px;\n    }\n\n    .editor-row {\n      display: flex;\n      align-items: flex-start;\n      gap: 16px;\n      flex-wrap: wrap;\n    }\n\n    .editor-field {\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      min-width: 150px;\n    }\n\n    .editor-field.id-field {\n      flex: 0 0 auto;\n      min-width: 80px;\n      max-width: 100px;\n    }\n\n    .editor-field label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n      color: var(--primary-text-color, #212121);\n    }\n\n    ha-textfield[error] {\n      --mdc-text-field-outline-color: var(--error-color, #f44336);\n      --mdc-text-field-focus-outline-color: var(--error-color, #f44336);\n    }\n\n    .editor-section {\n      margin-bottom: 0;\n      flex: 1;\n      min-width: 100%;\n    }\n\n    .editor-section.full-width {\n      width: 100%;\n    }\n\n    .editor-section label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n      color: var(--primary-text-color, #212121);\n    }\n\n    .color-input-group {\n      display: flex;\n      gap: 12px;\n      align-items: center;\n      position: relative;\n    }\n\n    .color-picker-input {\n      position: absolute;\n      opacity: 0;\n      width: 0;\n      height: 0;\n      pointer-events: none;\n    }\n\n    .color-preview-large {\n      width: 60px;\n      height: 60px;\n      border-radius: 4px;\n      border: 2px solid var(--divider-color, #e0e0e0);\n      flex-shrink: 0;\n    }\n\n    .color-picker-input {\n      position: absolute;\n      opacity: 0;\n      width: 0;\n      height: 0;\n      pointer-events: none;\n    }\n\n    .action-buttons {\n      display: flex;\n      gap: 8px;\n      align-items: center;\n    }\n\n    .view-switcher {\n      display: flex;\n      gap: 8px;\n      align-items: center;\n      justify-content: center;\n      padding: 8px;\n      margin: 8px 0;\n      border-top: 1px solid var(--divider-color, #e0e0e0);\n      border-bottom: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .view-radio-button {\n      flex: 1;\n      padding: 8px 16px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-radius: 4px;\n      background-color: var(--card-background-color, #ffffff);\n      color: var(--primary-text-color, #212121);\n      cursor: pointer;\n      transition: all 0.2s;\n      text-align: center;\n      font-size: 14px;\n    }\n\n    .view-radio-button:hover {\n      background-color: var(--divider-color, #e0e0e0);\n    }\n\n    .view-radio-button.selected {\n      background-color: var(--primary-color, #03a9f4);\n      color: var(--text-primary-color, #ffffff);\n      border-color: var(--primary-color, #03a9f4);\n    }\n\n    .view-content {\n      flex: 1;\n      overflow-y: auto;\n    }\n\n    .no-selection {\n      padding: 20px;\n      text-align: center;\n      color: var(--secondary-text-color);\n    }\n\n    .holidays-view,\n    .other-view {\n      padding: 20px;\n    }\n\n    .holidays-view h3,\n    .other-view h3 {\n      margin-top: 0;\n      color: var(--primary-text-color);\n    }\n\n    .other-options {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      margin-top: 16px;\n    }\n\n    .option-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 12px;\n      padding: 12px;\n      background-color: var(--card-background-color, #ffffff);\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-radius: 4px;\n    }\n\n    .option-label {\n      flex: 1;\n      font-size: 14px;\n      color: var(--primary-text-color, #000000);\n      cursor: pointer;\n    }\n\n    .holidays-fields {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      margin-top: 16px;\n    }\n\n    .holiday-switch-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 12px;\n      padding: 8px 0;\n    }\n\n    .holiday-label {\n      flex: 1;\n      font-size: 14px;\n      color: var(--primary-text-color);\n      cursor: pointer;\n    }\n\n    .holidays-fields ha-switch {\n      flex-shrink: 0;\n    }\n\n    .version-info {\n      position: absolute;\n      bottom: 8px;\n      right: 12px;\n      font-size: 11px;\n      color: var(--secondary-text-color, #757575);\n    }\n\n    .switch-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 12px;\n      flex: 1;\n      min-width: 200px;\n    }\n\n    .switch-label {\n      flex: 1;\n      font-size: 14px;\n      color: var(--primary-text-color, #000000);\n      cursor: pointer;\n    }\n\n    .switch-item ha-switch {\n      flex-shrink: 0;\n    }\n\n    .time-ranges-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n    }\n\n    .time-range-add-button {\n      width: 28px;\n      height: 28px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      color: var(--primary-color, #03a9f4);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 18px;\n      font-weight: bold;\n      transition: background-color 0.2s;\n    }\n\n    .time-range-add-button:hover:not(:disabled) {\n      background-color: var(--primary-color, #03a9f4);\n      color: white;\n    }\n\n    .time-range-add-button:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    .time-ranges-table {\n      display: flex;\n      flex-direction: column;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-radius: 4px;\n      overflow: hidden;\n    }\n\n    .time-ranges-header-row {\n      display: grid;\n      grid-template-columns: 60px 1fr 1fr 40px;\n      background-color: var(--divider-color, #f5f5f5);\n      border-bottom: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-header-cell {\n      padding: 8px 12px;\n      font-weight: bold;\n      font-size: 14px;\n      color: var(--primary-text-color, #212121);\n      border-right: 1px solid var(--divider-color, #e0e0e0);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .time-range-header-cell:last-child {\n      border-right: none;\n    }\n\n    .time-range-row {\n      display: grid;\n      grid-template-columns: 60px 1fr 1fr 40px;\n      border-bottom: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-row:last-child {\n      border-bottom: none;\n    }\n\n    .time-range-cell {\n      padding: 8px 6px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border-right: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-cell:last-child {\n      border-right: none;\n    }\n\n    .time-range-cell.id-cell {\n      padding: 8px;\n    }\n\n    .time-range-cell.action-cell {\n      padding: 4px;\n      justify-content: center;\n    }\n\n    .time-range-cell ha-textfield {\n      width: 100%;\n      max-width: 120px;\n      margin: 0 auto;\n    }\n\n    .time-range-delete-button {\n      width: 28px;\n      height: 28px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      color: var(--error-color, #f44336);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 20px;\n      font-weight: bold;\n      transition: background-color 0.2s;\n      flex-shrink: 0;\n    }\n\n    .time-range-delete-button:hover:not(:disabled) {\n      background-color: var(--error-color, #f44336);\n      color: white;\n    }\n\n    .time-range-delete-button:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    ha-textfield[error] {\n      --mdc-text-field-outline-color: var(--error-color, #f44336);\n      --mdc-text-field-focus-outline-color: var(--error-color, #f44336);\n    }\n    `,\n  ];\n\n  constructor() {\n    super();\n    this.calendars = [];\n    this.selectedShortcut = null;\n    this._validationErrors = {};\n    this._currentView = 'shifts'; // 'shifts', 'holidays', 'other'\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._updateValidationErrors();\n  }\n\n  updated(changedProperties) {\n    super.updated(changedProperties);\n\n    // Ignoriere calendars-Updates von auen, wenn Panel bereits initialisiert wurde\n    // (nur beim ersten Setzen akzeptieren wir externe calendars)\n    if (changedProperties.has('calendars')) {\n      const oldCalendars = changedProperties.get('calendars');\n      console.log('[ConfigPanel] updated() aufgerufen mit calendars-nderung', {\n        oldCalendars: oldCalendars?.length,\n        newCalendars: this.calendars?.length,\n        hasChanged: this.constructor.properties.calendars.hasChanged\n      });\n\n      // Wenn calendars bereits gesetzt waren und sich jetzt ndern, knnte es ein externes Update sein\n      // Prfe ob die Daten wirklich unterschiedlich sind\n      if (oldCalendars && oldCalendars.length > 0 && this.calendars && this.calendars.length > 0) {\n        const oldStr = JSON.stringify(oldCalendars);\n        const newStr = JSON.stringify(this.calendars);\n        // Wenn die Daten gleich sind, ignoriere das Update (nur Referenz-nderung)\n        if (oldStr === newStr) {\n          console.log('[ConfigPanel] calendars: Update ignoriert (Daten identisch)');\n          return; // Ignoriere Update, da Daten identisch sind\n        }\n      }\n      this._updateValidationErrors();\n    }\n\n    if (changedProperties.has('selectedShortcut')) {\n      this._updateValidationErrors();\n    }\n  }\n\n  _validateCalendar(calendar) {\n    const errors = {};\n    \n    // Validiere Schicht-ID\n    if (!calendar.shortcut || !/^[a-z]$/.test(calendar.shortcut)) {\n      errors.shortcut = true;\n    }\n    \n    // Validiere Zeitrume\n    if (calendar.timeRanges && Array.isArray(calendar.timeRanges)) {\n      const timeRangeIds = [];\n      \n      calendar.timeRanges.forEach((range, index) => {\n        const rangeData = typeof range === 'object' && range.times ? range : { id: null, times: range || [null, null] };\n        \n        // Validiere Zeitraum-ID\n        if (!rangeData.id || !/^[1-9]$/.test(rangeData.id)) {\n          errors[`timeRange_${index}_id`] = true;\n        } else {\n          // Prfe auf doppelte IDs\n          const idNum = parseInt(rangeData.id);\n          if (timeRangeIds.includes(idNum)) {\n            errors[`timeRange_${index}_id`] = true;\n          } else {\n            timeRangeIds.push(idNum);\n          }\n        }\n        \n        // Validiere Zeit-Format (optional, aber wenn vorhanden, muss es gltig sein)\n        if (rangeData.times && rangeData.times[0] && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(rangeData.times[0])) {\n          errors[`timeRange_${index}_start`] = true;\n        }\n        if (rangeData.times && rangeData.times[1] && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(rangeData.times[1])) {\n          errors[`timeRange_${index}_end`] = true;\n        }\n      });\n    }\n    \n    return errors;\n  }\n\n  _hasValidationErrors() {\n    if (!this.selectedShortcut) {\n      return false;\n    }\n    const calendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    if (!calendar) {\n      return false;\n    }\n    const errors = this._validateCalendar(calendar);\n    return Object.keys(errors).length > 0;\n  }\n\n  _triggerColorPicker(shortcut) {\n    // Finde das versteckte Color-Input-Element und triggere den Click\n    const colorInput = this.shadowRoot.querySelector(`input[type=\"color\"]`);\n    if (colorInput) {\n      colorInput.click();\n    }\n  }\n\n  render() {\n    const editingCalendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    const selectedIndex = this.calendars.findIndex(cal => cal.shortcut === this.selectedShortcut);\n    \n    return html`\n      <div class=\"config-menu-bar\">\n        ${renderMenuBar({\n          left: html`\n            <button class=\"cancel-button menu-button\" @click=${this._handleClose} title=\"Abbrechen\"></button>\n          `,\n          center: html`\n            <div class=\"view-switcher\">\n              <button\n                class=\"view-radio-button ${this._currentView === 'shifts' ? 'selected' : ''}\"\n                @click=${() => {\n                  this._currentView = 'shifts';\n                  this.requestUpdate();\n                }}\n                title=\"Schichten\"\n              >\n                Schichten\n              </button>\n              <button\n                class=\"view-radio-button ${this._currentView === 'holidays' ? 'selected' : ''}\"\n                @click=${() => {\n                  this._currentView = 'holidays';\n                  this.requestUpdate();\n                }}\n                title=\"Feiertage\"\n              >\n                Feiertage\n              </button>\n              <button\n                class=\"view-radio-button ${this._currentView === 'other' ? 'selected' : ''}\"\n                @click=${() => {\n                  this._currentView = 'other';\n                  this.requestUpdate();\n                }}\n                title=\"Sonstiges\"\n              >\n                Sonstiges\n              </button>\n            </div>\n          `,\n          right: html`\n            <button \n              class=\"confirm-button menu-button\" \n              @click=${this._handleSave} \n              title=\"Speichern\"\n              ?disabled=${this._hasValidationErrors()}\n            ></button>\n          `,\n          fullWidth: this._currentView === 'shifts' ? html`\n            <div class=\"color-bar\">\n              ${this.calendars.map((calendar, index) => {\n                const isSelected = calendar.shortcut === this.selectedShortcut;\n                const hasErrors = this._hasValidationErrors() && isSelected;\n                return html`\n                  <button\n                    class=\"color-button ${isSelected ? 'selected' : ''} ${calendar.enabled ? '' : 'disabled'}\"\n                    style=\"background-color: ${calendar.color || '#ff9800'};\"\n                    @click=${() => {\n                      if (!this._hasValidationErrors()) {\n                        this.selectedShortcut = calendar.shortcut;\n                        this._updateValidationErrors();\n                      }\n                    }}\n                    ?disabled=${hasErrors}\n                    title=\"${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`} ${calendar.enabled ? '' : '(deaktiviert)'}${hasErrors ? ' (Fehlerhafte Eingabe)' : ''}\"\n                  ></button>\n                `;\n              })}\n              <button\n                class=\"color-button add-shift-color-button\"\n                @click=${this._addShift}\n                title=\"Neue Schicht hinzufgen\"\n                ?disabled=${this._hasValidationErrors()}\n              >\n                +\n              </button>\n            </div>\n          ` : '',\n        })}\n      </div>\n      <div class=\"config-panel\">\n        <div class=\"view-content\">\n          ${this._currentView === 'shifts' ? this._renderShiftsView(editingCalendar, selectedIndex) : ''}\n          ${this._currentView === 'holidays' ? this._renderHolidaysView() : ''}\n          ${this._currentView === 'other' ? this._renderOtherView() : ''}\n        </div>\n        <span class=\"version-info\">v${Version}</span>\n      </div>\n    `;\n  }\n\n  _renderShiftsView(editingCalendar, selectedIndex) {\n    return editingCalendar\n      ? html`\n              <div class=\"shift-editor\">\n                <!-- Zeile 1: Name, Farbe, ID -->\n                <div class=\"editor-row\">\n                  <div class=\"editor-field\">\n                    <label>Name</label>\n                    <ha-textfield\n                      .value=${editingCalendar.name || ''}\n                      @input=${e => this._updateCalendar(editingCalendar.shortcut, { name: e.target.value })}\n                      placeholder=\"Schichtname\"\n                    ></ha-textfield>\n                  </div>\n                  \n                  <div class=\"editor-field\">\n                    <label>Farbe</label>\n                    <div class=\"color-input-group\">\n                      <input\n                        type=\"color\"\n                        .value=${editingCalendar.color || '#ff9800'}\n                        @input=${e => this._updateCalendar(editingCalendar.shortcut, { color: e.target.value })}\n                        class=\"color-picker-input\"\n                        title=\"Farbauswahl ffnen\"\n                      />\n                      <div\n                        class=\"color-preview-large\"\n                        style=\"background-color: ${editingCalendar.color || '#ff9800'}; cursor: pointer;\"\n                        @click=${() => this._triggerColorPicker(editingCalendar.shortcut)}\n                        title=\"Farbauswahl ffnen\"\n                      ></div>\n                    </div>\n                  </div>\n                  \n                  <div class=\"editor-field id-field\">\n                    <label>ID</label>\n                    <ha-textfield\n                      .value=${editingCalendar.shortcut || ''}\n                      @input=${e => {\n                        this._updateCalendarId(editingCalendar.shortcut, e.target.value);\n                        this._updateValidationErrors();\n                      }}\n                      placeholder=\"a\"\n                      maxlength=\"1\"\n                      pattern=\"[a-z]\"\n                      .error=${this._validationErrors[`${editingCalendar.shortcut}_shortcut`] || false}\n                    ></ha-textfield>\n                  </div>\n                </div>\n                \n                <!-- Zeile 2: Aktiviert, Relevant -->\n                <div class=\"editor-row\">\n                  <div class=\"switch-item\">\n                    <label class=\"switch-label\">Aktiviert</label>\n                    <ha-switch\n                      .checked=${editingCalendar.enabled !== false}\n                      @change=${e => this._updateCalendar(editingCalendar.shortcut, { enabled: e.target.checked })}\n                    ></ha-switch>\n                  </div>\n                  <div class=\"switch-item\">\n                    <label class=\"switch-label\">Status relevant</label>\n                    <ha-switch\n                      .checked=${editingCalendar.statusRelevant !== false}\n                      @change=${e => this._updateCalendar(editingCalendar.shortcut, { statusRelevant: e.target.checked })}\n                    ></ha-switch>\n                  </div>\n                </div>\n                \n                <!-- Zeile 3: Zeitrume -->\n                <div class=\"editor-row\">\n                  <div class=\"editor-section full-width\">\n                    <div class=\"time-ranges-header\">\n                      <label>Zeitrume</label>\n                      <button\n                        class=\"time-range-add-button\"\n                        @click=${() => this._addTimeRange(editingCalendar.shortcut)}\n                        title=\"Zeitbereich hinzufgen\"\n                        ?disabled=${(editingCalendar.timeRanges && editingCalendar.timeRanges.length >= 9) || false}\n                      >\n                        +\n                      </button>\n                    </div>\n                    ${editingCalendar.timeRanges && editingCalendar.timeRanges.length > 0\n                      ? html`\n                        <div class=\"time-ranges-table\">\n                          <div class=\"time-ranges-header-row\">\n                            <div class=\"time-range-header-cell id-header\">ID</div>\n                            <div class=\"time-range-header-cell\">Start</div>\n                            <div class=\"time-range-header-cell\">ENDE</div>\n                            <div class=\"time-range-header-cell action-header\"></div>\n                          </div>\n                          ${editingCalendar.timeRanges.map((range, rangeIndex) => {\n                        const rangeData = typeof range === 'object' && range.times ? range : { id: null, times: range || [null, null] };\n                        return html`\n                        <div class=\"time-range-row\">\n                          <div class=\"time-range-cell id-cell\">\n                            <ha-textfield\n                              .value=${rangeData.id || ''}\n                              @input=${e => {\n                                this._updateTimeRangeId(editingCalendar.shortcut, rangeIndex, e.target.value);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"1\"\n                              maxlength=\"1\"\n                              pattern=\"[1-9]\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_id`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell\">\n                            <ha-textfield\n                              type=\"time\"\n                              .value=${rangeData.times[0] || ''}\n                              @input=${e => {\n                                this._updateTimeRange(editingCalendar.shortcut, rangeIndex, 0, e.target.value || null);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"HH:MM\"\n                              pattern=\"[0-9]{2}:[0-9]{2}\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_start`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell\">\n                            <ha-textfield\n                              type=\"time\"\n                              .value=${rangeData.times[1] || ''}\n                              @input=${e => {\n                                this._updateTimeRange(editingCalendar.shortcut, rangeIndex, 1, e.target.value || null);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"HH:MM\"\n                              pattern=\"[0-9]{2}:[0-9]{2}\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_end`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell action-cell\">\n                            <button\n                              class=\"time-range-delete-button\"\n                              @click=${() => this._removeTimeRange(editingCalendar.shortcut, rangeIndex)}\n                              title=\"Zeitbereich entfernen\"\n                            >\n                              \n                            </button>\n                          </div>\n                        </div>\n                        `;\n                          })}\n                        </div>\n                      `\n                      : ''}\n                  </div>\n                </div>\n                \n                <!-- Zeile 4: Papierkorb und Pfeile -->\n                <div class=\"editor-row\">\n                  <div class=\"action-buttons\">\n                    <button\n                      class=\"control-button delete\"\n                      @click=${() => this._deleteShift(editingCalendar.shortcut)}\n                      title=\"Lschen\"\n                    >\n                      \n                    </button>\n                    <button\n                      class=\"control-button\"\n                      @click=${() => this._moveShift(selectedIndex, -1)}\n                      ?disabled=${selectedIndex <= 0}\n                      title=\"Nach oben\"\n                    >\n                      \n                    </button>\n                    <button\n                      class=\"control-button\"\n                      @click=${() => this._moveShift(selectedIndex, 1)}\n                      ?disabled=${selectedIndex >= this.calendars.length - 1}\n                      title=\"Nach unten\"\n                    >\n                      \n                    </button>\n                  </div>\n                </div>\n              </div>\n              `\n      : html`<div class=\"no-selection\">Bitte whlen Sie eine Schicht aus</div>`;\n  }\n\n  _renderHolidaysView() {\n    // Stelle sicher, dass holidays Konfiguration existiert\n    if (!this.holidays) {\n      this.holidays = {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      };\n    }\n\n    const holidays = [\n      { key: 'neujahr', label: 'Neujahr (1. Januar)' },\n      { key: 'heilige_drei_koenige', label: 'Heilige Drei Knige (6. Januar)' },\n      { key: 'tag_der_arbeit', label: 'Tag der Arbeit (1. Mai)' },\n      { key: 'friedensfest', label: 'Friedensfest (8. August)' },\n      { key: 'mariae_himmelfahrt', label: 'Mari Himmelfahrt (15. August)' },\n      { key: 'tag_der_deutschen_einheit', label: 'Tag der Deutschen Einheit (3. Oktober)' },\n      { key: 'reformationstag', label: 'Reformationstag (31. Oktober)' },\n      { key: 'allerheiligen', label: 'Allerheiligen (1. November)' },\n      { key: 'weihnachten_1', label: '1. Weihnachtsfeiertag (25. Dezember)' },\n      { key: 'weihnachten_2', label: '2. Weihnachtsfeiertag (26. Dezember)' },\n      { key: 'karfreitag', label: 'Karfreitag' },\n      { key: 'ostermontag', label: 'Ostermontag' },\n      { key: 'christi_himmelfahrt', label: 'Christi Himmelfahrt' },\n      { key: 'pfingstmontag', label: 'Pfingstmontag' },\n      { key: 'fronleichnam', label: 'Fronleichnam' },\n      { key: 'busstag', label: 'Bu- und Bettag' },\n    ];\n\n    return html`\n      <div class=\"holidays-view\">\n        <h3>Feiertage</h3>\n        <div class=\"holidays-fields\">\n          ${holidays.map(\n            holiday => html`\n              <div class=\"holiday-switch-item\">\n                <label class=\"holiday-label\">${holiday.label}</label>\n                <ha-switch\n                  .checked=${this.holidays[holiday.key] !== false}\n                  @change=${e => this._updateHoliday(holiday.key, e.target.checked)}\n                ></ha-switch>\n              </div>\n            `\n          )}\n        </div>\n      </div>\n    `;\n  }\n\n  _updateHoliday(key, enabled) {\n    if (!this.holidays) {\n      this.holidays = {};\n    }\n    this.holidays = {\n      ...this.holidays,\n      [key]: enabled,\n    };\n    this.requestUpdate();\n  }\n\n  _renderOtherView() {\n    return html`\n      <div class=\"other-view\">\n        <h3>Sonstiges</h3>\n        <div class=\"other-options\">\n          <div class=\"option-item\">\n            <label class=\"option-label\">Status nur bei aktivem Zeitraum setzen</label>\n            <ha-switch\n              .checked=${this.statusOnlyInTimeRange || false}\n              @change=${e => {\n                this.statusOnlyInTimeRange = e.target.checked;\n                this.requestUpdate();\n              }}\n            ></ha-switch>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n\n  _handleClose() {\n    this._hasLocalCopy = false;\n    this.dispatchEvent(new CustomEvent('close'));\n  }\n\n  _handleSave() {\n    this.dispatchEvent(\n      new CustomEvent('save', {\n        detail: {\n          calendars: this.calendars,\n          holidays: this.holidays,\n          statusOnlyInTimeRange: this.statusOnlyInTimeRange,\n        },\n      })\n    );\n  }\n\n  _moveShift(index, direction) {\n    if (index + direction < 0 || index + direction >= this.calendars.length) {\n      return;\n    }\n\n    const newCalendars = [...this.calendars];\n    const [moved] = newCalendars.splice(index, 1);\n    newCalendars.splice(index + direction, 0, moved);\n    this.calendars = newCalendars;\n    this._updateValidationErrors();\n  }\n\n  _deleteShift(shortcut) {\n    if (this.calendars.length <= 1) {\n      return; // Mindestens eine Schicht muss vorhanden sein\n    }\n\n    this.calendars = this.calendars.filter(cal => cal.shortcut !== shortcut);\n    if (this.selectedShortcut === shortcut) {\n      this.selectedShortcut = this.calendars.length > 0 ? this.calendars[0].shortcut : null;\n    }\n    this._updateValidationErrors();\n  }\n\n  _toggleEnabled(shortcut, enabled) {\n    this.calendars = this.calendars.map(cal =>\n      cal.shortcut === shortcut ? { ...cal, enabled } : cal\n    );\n    this._updateValidationErrors();\n  }\n\n  _addShift() {\n    // Finde den nchsten verfgbaren Shortcut\n    const existingShortcuts = this.calendars.map(cal => cal.shortcut);\n    const allShortcuts = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'];\n    const availableShortcut = allShortcuts.find(s => !existingShortcuts.includes(s));\n\n    if (!availableShortcut) {\n      return; // Maximale Anzahl von Schichten erreicht\n    }\n\n    const defaultColors = [\n      '#ff9800',\n      '#ff0000',\n      '#00ff00',\n      '#0000ff',\n      '#ffff00',\n      '#ff00ff',\n      '#00ffff',\n      '#ffa500',\n      '#800080',\n      '#008000',\n    ];\n\n    const newShift = {\n      shortcut: availableShortcut,\n      name: `Schicht ${availableShortcut.toUpperCase()}`,\n      color: defaultColors[this.calendars.length % defaultColors.length],\n      enabled: true,\n      statusRelevant: true,\n      timeRanges: [],\n    };\n\n    this.calendars = [...this.calendars, newShift];\n    this.selectedShortcut = newShift.shortcut;\n    this._updateValidationErrors();\n  }\n\n  _updateCalendar(shortcut, updates) {\n    this.calendars = this.calendars.map(cal =>\n      cal.shortcut === shortcut ? { ...cal, ...updates } : cal\n    );\n    this._updateValidationErrors();\n  }\n\n  _normalizeTimeRange(range) {\n    // Konvertiere altes Format [start, end] zu neuem Format { id, times: [start, end] }\n    if (Array.isArray(range)) {\n      return { id: null, times: range };\n    }\n    if (typeof range === 'object' && range.times) {\n      return range;\n    }\n    return { id: null, times: [null, null] };\n  }\n\n  _normalizeTimeRanges(timeRanges) {\n    if (!timeRanges || !Array.isArray(timeRanges)) {\n      return [];\n    }\n    return timeRanges.map((range) => {\n      const normalized = this._normalizeTimeRange(range);\n      // Keine Default-ID setzen - ID muss explizit gesetzt werden\n      return normalized;\n    });\n  }\n\n  _updateTimeRange(shortcut, rangeIndex, timeIndex, value) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        if (!newTimeRanges[rangeIndex]) {\n          newTimeRanges[rangeIndex] = { id: null, times: [null, null] };\n        }\n        newTimeRanges[rangeIndex] = {\n          ...newTimeRanges[rangeIndex],\n          times: [...newTimeRanges[rangeIndex].times],\n        };\n        newTimeRanges[rangeIndex].times[timeIndex] = value;\n        return { ...cal, timeRanges: newTimeRanges };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _updateTimeRangeId(shortcut, rangeIndex, newId) {\n    // Validiere die neue ID (nur Ziffern 1-9)\n    const normalizedId = newId.trim() || null;\n\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        if (newTimeRanges[rangeIndex]) {\n          newTimeRanges[rangeIndex] = {\n            ...newTimeRanges[rangeIndex],\n            id: normalizedId,\n          };\n        }\n        return { ...cal, timeRanges: newTimeRanges };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _addTimeRange(shortcut) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        \n        // Prfe ob bereits 9 Zeitrume vorhanden sind\n        if (timeRanges.length >= 9) {\n          return cal; // Keine weiteren Zeitrume mglich\n        }\n        \n        // Finde die erste verfgbare ID im Bereich 1-9\n        const existingIds = timeRanges.map(r => r.id).map(id => parseInt(id) || 0).filter(id => id >= 1 && id <= 9);\n        let newId = null;\n        // Prfe alle IDs von 1 bis 9 und finde die erste, die nicht verwendet wird\n        for (let i = 1; i <= 9; i++) {\n          if (!existingIds.includes(i)) {\n            newId = String(i);\n            break;\n          }\n        }\n        return { ...cal, timeRanges: [...timeRanges, { id: newId, times: [null, null] }] };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _removeTimeRange(shortcut, rangeIndex) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        newTimeRanges.splice(rangeIndex, 1);\n        // Erlaube leeres Array (keine Zeitrume)\n        return { ...cal, timeRanges: newTimeRanges.length > 0 ? newTimeRanges : [] };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _updateValidationErrors() {\n    const errors = {};\n    this.calendars.forEach(cal => {\n      const calErrors = this._validateCalendar(cal);\n      Object.keys(calErrors).forEach(key => {\n        errors[`${cal.shortcut}_${key}`] = true;\n      });\n    });\n    this._validationErrors = errors;\n    \n    // Debug: Zeige Validierungsergebnis\n    const hasErrors = Object.keys(errors).length > 0;\n    const selectedCalendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    const selectedHasErrors = selectedCalendar ? Object.keys(errors).some(key => key.startsWith(`${this.selectedShortcut}_`)) : false;\n    \n    console.log('[ShiftConfigPanel] Validierung:', {\n      erfolgreich: !hasErrors,\n      fehlerfrei: !selectedHasErrors,\n      gesamtFehler: Object.keys(errors).length,\n      fehlerDetails: errors,\n      aktuelleSchicht: this.selectedShortcut,\n      aktuelleSchichtFehler: selectedHasErrors\n    });\n    \n    this.requestUpdate();\n  }\n\n  _updateCalendarId(oldShortcut, newShortcut) {\n    // Validiere die neue ID (nur ein Zeichen, a-z)\n    const normalizedNewShortcut = newShortcut.toLowerCase().trim();\n    if (!normalizedNewShortcut || normalizedNewShortcut.length === 0) {\n      this._updateValidationErrors();\n      return; // Leere ID nicht erlauben\n    }\n    \n    // Prfe ob es ein einzelner Kleinbuchstabe ist\n    if (normalizedNewShortcut.length !== 1 || !/^[a-z]$/.test(normalizedNewShortcut)) {\n      this._updateValidationErrors();\n      return;\n    }\n    \n    // Prfe ob die neue ID bereits verwendet wird\n    const existingCalendar = this.calendars.find(cal => cal.shortcut === normalizedNewShortcut && cal.shortcut !== oldShortcut);\n    if (existingCalendar) {\n      this._updateValidationErrors();\n      return;\n    }\n\n    // Aktualisiere die ID\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === oldShortcut) {\n        return { ...cal, shortcut: normalizedNewShortcut };\n      }\n      return cal;\n    });\n\n    // Aktualisiere selectedShortcut falls ntig\n    if (this.selectedShortcut === oldShortcut) {\n      this.selectedShortcut = normalizedNewShortcut;\n    }\n\n    this._updateValidationErrors();\n  }\n}\n\ncustomElements.define('shift-config-panel', ShiftConfigPanel);\n\n","import { html, css, unsafeCSS } from 'lit';\nimport { ViewBase } from '../view-base.js';\nimport { SaveDebounceTime } from '../../card-config.js';\nimport { StorageFactory } from '../../storage/storage-factory.js';\n// Mixins fr wiederverwendbare Funktionalitt\nimport { HolidayMixin } from './mixins/holiday-mixin.js';\nimport { DataManagementMixin } from './mixins/data-management-mixin.js';\nimport { CalendarMixin } from './mixins/calendar-mixin.js';\nimport { ConfigManagementMixin } from './mixins/config-management-mixin.js';\nimport { RenderingMixin } from './mixins/rendering-mixin.js';\n// Utilities\nimport { DateUtils } from '../../utils/date-utils.js';\nimport { ColorUtils } from '../../utils/color-utils.js';\n// Gemeinsame Menu-Styles\nimport { sharedMenuStyles } from './shared-menu-styles.js';\n// Menu-Bar Template\nimport { renderMenuBar } from './menu-bar-template.js';\n// Konfigurationspanel\nimport './shift-config-panel.js';\n\nexport class ShiftScheduleView extends ViewBase {\n  static className = 'ShiftScheduleView';\n\n  // Zentrale Definition der Standardfarbe fr ausgewhlte Tage im Single-Modus\n  static DEFAULT_SELECTED_DAY_COLOR = '#ff9800'; // Orange\n\n  // Fixe Schicht-Definition: 5 gleichberechtigte Schichten (a, b, c, d, e)\n  static CALENDARS = [\n    { shortcut: 'a', name: 'Schicht A', defaultColor: '#ff9800' },\n    { shortcut: 'b', name: 'Schicht B', defaultColor: '#ff0000' },\n    { shortcut: 'c', name: 'Schicht C', defaultColor: '#00ff00' },\n    { shortcut: 'd', name: 'Schicht D', defaultColor: '#0000ff' },\n    { shortcut: 'e', name: 'Schicht E', defaultColor: '#ffff00' },\n  ];\n\n  static get properties() {\n    return {\n      ...super.properties,\n      hass: { type: Object },\n      config: { type: Object },\n      lovelace: { type: Object },\n      _workingDays: { type: Object },\n      _storageWarning: { type: Object },\n      _configWarning: { type: Object },\n      _statusWarning: { type: Object },\n      _displayedMonths: { type: Number },\n      _startMonthOffset: { type: Number },\n      _selectedCalendar: { type: String },\n      _showConfigPanel: { type: Boolean },\n    };\n                }\n\n  constructor() {\n    super();\n    this._workingDays = {}; // {\"year:month\": {day: [elements]}} - z.B. {\"25:11\": {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]}                              }\n    this._storageWarning = null; // { show: boolean, currentLength: number, maxLength: number, percentage: number                               }\n    this._configWarning = null; // { show: boolean, configEntityId: string                               }\n    this._statusWarning = null; // { show: boolean, statusEntityId: string                               }\n    this._knownEntityIds = null; // Cache fr bekannte Entities [mainEntity, ...additionalEntities] - WIRD VON ENTITY-STORAGE VERWENDET\n    this._cleanupDone = false; // Flag, ob die Bereinigung bereits beim initialen Laden ausgefhrt wurde\n    this._displayedMonths = 2; // Anzahl der angezeigten Monate (wird aus config.numberOfMonths initialisiert)\n    this._startMonthOffset = 0; // Offset fr den Startmonat (0 = aktueller Monat, -1 = Vormonat, +1 = nchster Monat)\n    this._isWriting = false; // Flag, ob gerade geschrieben wird\n    this._writeLockTimer = null; // Timer fr das 5-Sekunden-Lock nach dem Schreiben\n    this._selectedCalendar = null; // Shortcut des ausgewhlten Kalenders (wird beim Setzen der Config initialisiert)\n    this._isInitialLoad = true; // Flag, ob gerade der initiale Load luft (verhindert Config-Schreiben beim Laden)\n    this._directDOMUpdateInProgress = new Set(); // Set von Button-Keys, die gerade per direkter DOM-Manipulation aktualisiert werden\n    // Performance-Caches\n    this._holidayCache = {}; // Cache fr Feiertage: {\"2025-12\": {1: true, 25: true, ...}                              }\n    this._cachedHolidayEntities = null; // Cache fr Holiday-Entities (wird bei hass-Update invalidiert)\n    this._editorModeCache = null; // Cache fr Editor-Mode-Erkennung\n    this._editorModeCacheTime = 0; // Zeitstempel fr Cache-Invalidierung\n    // Debouncing fr Speicher-Operationen\n    this._saveDebounceTimer = null; // Timer fr Debouncing beim Speichern\n    // Storage-Adapter (wird bei setConfig oder set hass initialisiert)\n    this._storage = null;\n    // Konfigurationspanel\n    this._showConfigPanel = false;\n    this._configPanelCalendars = null; // Gespeicherte calendars beim ffnen des Panels\n    this._configPanelHolidays = null; // Gespeicherte holidays beim ffnen des Panels\n    this._configPanelStatusOnlyInTimeRange = null; // Gespeicherte statusOnlyInTimeRange beim ffnen des Panels\n    \n    // Mixins hinzufgen (fr wiederverwendbare Funktionalitt)\n    Object.assign(this, DateUtils);\n    Object.assign(this, ColorUtils);\n    Object.assign(this, HolidayMixin);\n    Object.assign(this, DataManagementMixin);\n    Object.assign(this, CalendarMixin);\n    Object.assign(this, ConfigManagementMixin);\n    Object.assign(this, RenderingMixin);\n                }\n\n  // formatTwoDigits() ist jetzt in DateUtils\n\n  // Prft, ob die Karte im Editor-Modus angezeigt wird (mit Cache)\n  _isInEditorMode() {\n    // Cache: Prfe ob Cache noch gltig ist (5 Sekunden)\n    const now = Date.now();\n    if (this._editorModeCache !== null && now - this._editorModeCacheTime < 5000) {\n      return this._editorModeCache;\n                }\n\n    let result = false;\n\n    // Methode 1: Prfe URL-Parameter ?edit=1\n    if (typeof window !== 'undefined' && window.location) {\n      const urlParams = new URLSearchParams(window.location.search);\n      if (urlParams.get('edit') === '1') {\n        result = true;\n                }\n                }\n\n    if (!result) {\n      // Methode 2: Prfe lovelace.editMode\n      if (this.lovelace?.editMode === true) {\n        result = true;\n                }\n                }\n\n    if (!result) {\n      // Methode 3: Prfe, ob hui-dialog-edit-card im DOM existiert\n      if (typeof document !== 'undefined') {\n        const editDialog = document.querySelector('hui-dialog-edit-card');\n        if (editDialog) {\n          result = true;\n                }\n                }\n                }\n\n    if (!result) {\n      // Methode 4: Prfe, ob die Karte in einem Editor-Container ist\n      let element = this;\n      let depth = 0;\n      const maxDepth = 20; // Erhht fr bessere Erkennung\n\n      while (element && depth < maxDepth) {\n        // Prfe auf hui-dialog-edit-card im Parent-Baum\n        if (element.tagName?.toLowerCase() === 'hui-dialog-edit-card') {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische Klassen oder Attribute\n        if (\n          element.classList?.contains('card-editor') ||\n          element.classList?.contains('hui-card-editor') ||\n          element.classList?.contains('edit-mode') ||\n          element.classList?.contains('hui-card-config-editor') ||\n          element.getAttribute?.('data-card-editor') === 'true' ||\n          element.tagName?.toLowerCase().includes('editor') ||\n          element.tagName?.toLowerCase() === 'hui-card-element-editor'\n        ) {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische IDs\n        if (element.id && (element.id.includes('editor') || element.id.includes('config'))) {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische Attribute\n        if (\n          element.hasAttribute &&\n          (element.hasAttribute('data-card-editor') || element.hasAttribute('data-editor'))\n        ) {\n          result = true;\n          break;\n                }\n\n        element = element.parentElement || element.parentNode;\n        depth++;\n                }\n                }\n\n    if (!result) {\n      // Methode 5: Prfe, ob die Karte in einem Shadow DOM mit Editor-Klassen ist\n      const root = this.getRootNode();\n      if (root && root !== document) {\n        const host = root.host;\n        if (host) {\n          if (\n            host.tagName?.toLowerCase() === 'hui-dialog-edit-card' ||\n            host.classList?.contains('card-editor') ||\n            host.classList?.contains('hui-card-editor') ||\n            host.classList?.contains('edit-mode') ||\n            host.classList?.contains('hui-card-config-editor') ||\n            host.tagName?.toLowerCase() === 'hui-card-element-editor'\n          ) {\n            result = true;\n                }\n                }\n                }\n                }\n\n    if (!result) {\n      // Methode 6: Prfe URL-Pfad (falls im Editor-Modus)\n      if (typeof window !== 'undefined' && window.location) {\n        const url = window.location.href || window.location.pathname;\n        if (url && (url.includes('/config/lovelace/dashboards') || url.includes('/editor'))) {\n          result = true;\n                }\n                }\n                }\n\n    // Cache speichern\n    this._editorModeCache = result;\n    this._editorModeCacheTime = now;\n\n    return result;\n                }\n\n  // Berechnet die Kontrastfarbe (schwarz oder wei) fr eine gegebene Hintergrundfarbe\n  // _getContrastColor() ist jetzt in ColorUtils\n  // _getEasterDate(), _isHoliday(), _isWeekend() sind jetzt in HolidayMixin\n\n  /**\n   * Initialisiert den Storage-Adapter basierend auf der Konfiguration\n   * @private\n   */\n  _initializeStorage() {\n    if (!this._hass || !this._config) {\n      this._debug('[Storage] _initializeStorage: hass oder config fehlt');\n      this._storage = null;\n      return;\n                }\n\n    try {\n      this._storage = StorageFactory.createStorage(this._hass, this._config, this._debug.bind(this));\n      this._debug(`[Storage] _initializeStorage: Storage-Adapter erstellt, store_mode: \"${this._config.store_mode}\"`);\n    } catch (error) {\n      this._debug(`[Storage] _initializeStorage: Fehler beim Erstellen des Storage-Adapters: ${error.message}`, error);\n      this._storage = null;\n                }\n                }\n\n  get hass() {\n    return this._hass;\n                }\n\n  set hass(hass) {\n    // WICHTIG: Verhindere alle hass-Updates wenn das Konfigurationspanel geffnet ist\n    if (this._showConfigPanel) {\n      // Aktualisiere hass trotzdem (fr spter), aber fhre keine Operationen aus\n      this._debug('[Update-Block] set hass() blockiert (Panel ist geffnet)');\n      this._hass = hass;\n      return; // Kein requestUpdate(), kein Laden von Daten, nichts\n                }\n\n    // Ignoriere Updates whrend des Schreibens und 5 Sekunden danach\n    if (this._isWriting) {\n      this._hass = hass; // Aktualisiere hass trotzdem, aber lade keine Daten\n      this.requestUpdate();\n      return;\n                }\n\n    const previousEntityState = this._hass?.states?.[this._config?.entity]?.state;\n    const newEntityState = hass?.states?.[this._config?.entity]?.state;\n\n    // Prfe auch zustzliche Entities auf nderungen\n    let hasAnyEntityChanged = previousEntityState !== newEntityState;\n    if (!hasAnyEntityChanged && this._config && this._knownEntityIds && hass?.states) {\n      // Prfe alle bekannten zustzlichen Entities\n      for (let i = 1; i < this._knownEntityIds.length; i++) {\n        const entityId = this._knownEntityIds[i];\n        const prevState = this._hass?.states?.[entityId]?.state;\n        const newState = hass?.states?.[entityId]?.state;\n        if (prevState !== newState) {\n          hasAnyEntityChanged = true;\n          break;\n                }\n                }\n                }\n\n    // Prfe ob sich die saver_config oder die saver-Daten gendert haben (nur bei store_mode === 'saver')\n    let hasSaverConfigChanged = false;\n    let hasSaverDataChanged = false;\n    if (this._config && this._config.store_mode === 'saver' && this._hass && hass && hass?.states) {\n      try {\n        const saverEntity = hass.states['saver.saver'];\n        const previousSaverEntity = this._hass?.states?.['saver.saver'];\n        if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n          const configKey = `${this._config.saver_key || 'Schichtplan'}_config`;\n          const dataKey = this._config.saver_key || 'Schichtplan';\n\n          // Prfe Config-Variable\n          const previousConfigValue = previousSaverEntity?.attributes?.variables?.[configKey];\n          const newConfigValue = saverEntity.attributes.variables[configKey];\n          if (previousConfigValue !== newConfigValue) {\n            hasSaverConfigChanged = true;\n            this._debug('[Config] set hass: saver_config hat sich gendert, lade Konfiguration neu');\n          }\n\n          // Prfe Daten-Variable\n          const previousDataValue = previousSaverEntity?.attributes?.variables?.[dataKey];\n          const newDataValue = saverEntity.attributes.variables[dataKey];\n          if (previousDataValue !== newDataValue) {\n            hasSaverDataChanged = true;\n            this._debug(`[Sync] set hass: Saver-Daten-Variable \"${dataKey}\" hat sich gendert (alte Lnge: ${previousDataValue?.length || 0}, neue Lnge: ${newDataValue?.length || 0}), lade Daten neu`);\n          }\n        }\n      } catch (error) {\n        this._debug('[Config] set hass: Fehler beim Prfen der saver-Variablen:', error);\n      }\n    }\n\n    const wasHassSet = !!this._hass;\n    this._hass = hass;\n\n    // Cache-Invalidierung: Holiday-Entities Cache zurcksetzen bei hass-Update\n    this._cachedHolidayEntities = null;\n    \n    // Initialisiere Storage-Adapter neu, falls Config bereits vorhanden\n    if (this._config) {\n      this._initializeStorage();\n                }\n\n    // Wenn hass zum ersten Mal gesetzt wird und die Konfiguration bereits vorhanden ist,\n    // markiere initialen Load als abgeschlossen\n    if (!wasHassSet && hass && this._config && this._isInitialLoad) {\n      this._debug('[Config] set hass: hass zum ersten Mal gesetzt - markiere initialen Load als abgeschlossen');\n      this._isInitialLoad = false;\n                }\n\n    if (this._config) {\n      // Lade Daten beim ersten Setzen von hass, wenn sich ein State gendert hat, oder wenn sich Saver-Daten gendert haben\n      if ((!wasHassSet || hasAnyEntityChanged || hasSaverDataChanged) && hass?.states) {\n        if (hasSaverDataChanged) {\n          this._debug('[Sync] set hass: Lade Daten neu aufgrund von Saver-Daten-nderung (Synchronisation mit anderer Karte)');\n        }\n        try {\n          this.loadWorkingDays();\n        } catch (error) {\n          this._debug('[Config] set hass: Fehler beim Laden der Arbeitszeiten:', error);\n        }\n      }\n\n      // Beim ersten Setzen von hass: Lade die Konfiguration aus dem Storage, falls noch nicht geladen\n      // ABER: Nicht wenn das Konfigurationspanel offen ist, um ungespeicherte nderungen nicht zu berschreiben\n      if (!wasHassSet && this._storage && !this._showConfigPanel) {\n        this._debug('[Config] set hass: hass zum ersten Mal gesetzt - lade Konfiguration aus Storage');\n        // Verwende Promise ohne await, da set hass() nicht async ist\n        this._storage.loadConfig().then(storageConfig => {\n          // WICHTIG: Prfe nochmal, ob das Panel geffnet wurde, whrend das Promise lief\n          // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n          const isPanelOpen = this._showConfigPanel;\n          this._debug('[Config] set hass: Promise-Callback aufgerufen. _showConfigPanel=' + isPanelOpen + ', storageConfig vorhanden=' + !!storageConfig);\n          if (isPanelOpen) {\n            this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (beim ersten hass-Set). _showConfigPanel=' + isPanelOpen);\n            return;\n                }\n\n          if (storageConfig) {\n            try {\n              const parsedConfig = JSON.parse(storageConfig);\n              \n              // WICHTIG: Prfe NOCHMAL nach dem Parsen, ob das Panel geffnet wurde\n              const isPanelOpenAfterParse = this._showConfigPanel;\n              if (isPanelOpenAfterParse) {\n                this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (nach Parsen). _showConfigPanel=' + isPanelOpenAfterParse);\n                return;\n                }\n\n              // Neues Format: Objekt mit \"calendars\" Property\n              if (parsedConfig && typeof parsedConfig === 'object' && Array.isArray(parsedConfig.calendars)) {\n                this._debug('[Config] set hass: Konfiguration aus Storage geladen (neues Format mit calendars) beim ersten hass-Set');\n                \n                // WICHTIG: Prfe NOCHMAL vor dem Aktualisieren von this._config.calendars\n                const isPanelOpenBeforeUpdate = this._showConfigPanel;\n                if (isPanelOpenBeforeUpdate) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (vor calendars-Update). _showConfigPanel=' + isPanelOpenBeforeUpdate);\n                  return;\n                }\n\n                // WICHTIG: Finale Prfung direkt vor dem Aktualisieren von this._config.calendars\n                // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n                const finalPanelCheck = this._showConfigPanel;\n                if (finalPanelCheck) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (finale Prfung vor calendars-Update). _showConfigPanel=' + finalPanelCheck);\n                  return;\n                }\n\n                // Ersetze this._config.calendars vollstndig mit den geladenen Kalendern\n                this._config.calendars = parsedConfig.calendars.map(cal => {\n                  // Stelle sicher, dass timeRanges im korrekten Format sind\n                  let timeRanges = [];\n                  if (cal.timeRanges && Array.isArray(cal.timeRanges)) {\n                    timeRanges = cal.timeRanges.map((range, idx) => {\n                      // Prfe zuerst, ob es ein Array ist (altes Format)\n                      if (Array.isArray(range)) {\n                        // Altes Format: [start, end] - konvertiere zu neuem Format\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Altes Format [start, end] erkannt`);\n                        return {\n                          id: null,\n                          times: [...range],\n                        };\n                      } else if (typeof range === 'object' && range !== null && range.times && Array.isArray(range.times)) {\n                        // Neues Format: { id, times: [start, end]                               }\n                        const normalizedRange = {\n                          id: range.id || null,\n                          times: [...range.times],\n                        };\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Neues Format erkannt, id=\"${normalizedRange.id}\", times=[${normalizedRange.times.join(',')}]`);\n                        return normalizedRange;\n                      } else {\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Unbekanntes Format, verwende Default`);\n                        return { id: null, times: [null, null] };\n                }\n          });\n                }\n\n                  return {\n                    shortcut: cal.shortcut,\n                    name: cal.name || `Schicht ${cal.shortcut?.toUpperCase() || ''}`,\n                    color: cal.color || this._getDefaultColorForShortcut(cal.shortcut),\n                    enabled: cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1,\n                    statusRelevant: cal.statusRelevant === true || cal.statusRelevant === 'true' || cal.statusRelevant === 1,\n                    timeRanges: timeRanges,\n                  };\n                });\n                \n                // Lade Feiertage aus der Config, falls vorhanden\n                if (parsedConfig.holidays && typeof parsedConfig.holidays === 'object') {\n                  this._config.holidays = { ...parsedConfig.holidays };\n                  this._debug('[Config] set hass: Feiertage aus Saver geladen:', this._config.holidays);\n                  // Invalidiere Holiday-Cache, damit Feiertage neu berechnet werden\n                  this._holidayCache = {};\n                  this._debug('[Config] set hass: Holiday-Cache invalidiert aufgrund von Feiertags-nderung');\n                }\n                if (parsedConfig.statusOnlyInTimeRange !== undefined) {\n                  this._config.statusOnlyInTimeRange = parsedConfig.statusOnlyInTimeRange;\n                  this._debug('[Config] set hass: statusOnlyInTimeRange aus Saver geladen:', this._config.statusOnlyInTimeRange);\n                }\n\n                this._debug(`[Config] set hass: ${this._config.calendars.length} Kalender geladen beim ersten hass-Set`);\n                this._config.calendars.forEach(cal => {\n                  this._debug(`[Config] set hass: Kalender \"${cal.shortcut}\":`, {\n                    name: cal.name,\n                    enabled: cal.enabled,\n                    statusRelevant: cal.statusRelevant,\n                    timeRanges_count: cal.timeRanges?.length || 0,\n                  });\n                });\n                \n                this._debug('[Config] set hass: Konfiguration aus Saver geladen und this._config aktualisiert');\n                // Prfe nochmal, ob das Panel geffnet wurde, bevor wir updaten\n                if (!this._showConfigPanel) {\n                  this.requestUpdate();\n                } else {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe requestUpdate()');\n                }\n    } else {\n                this._debug('[Config] set hass: Konfiguration konnte nicht geparst werden - erwartetes Format: { calendars: [...] }');\n                }\n  } catch (error) {\n              this._debug('[Config] set hass: Fehler beim Parsen der Konfiguration aus dem Storage:', error);\n                }\n                }\n        }).catch(error => {\n          this._debug('[Config] set hass: Fehler beim Laden der Konfiguration aus dem Storage:', error);\n        });\n                }\n\n      // Wenn sich die saver_config gendert hat, lade die Konfiguration neu\n      // ABER: Nicht wenn das Konfigurationspanel offen ist, um ungespeicherte nderungen nicht zu berschreiben\n      if (hasSaverConfigChanged && this._storage && !this._showConfigPanel) {\n        this._debug('[Config] set hass: Lade Konfiguration aus Storage neu');\n        // Lade die Konfiguration aus dem Storage und aktualisiere this._config\n        this._storage.loadConfig().then(storageConfig => {\n          // WICHTIG: Prfe nochmal, ob das Panel geffnet wurde, whrend das Promise lief\n          if (this._showConfigPanel) {\n            this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (bei saver_config-nderung)');\n            return;\n                }\n\n          if (storageConfig) {\n            try {\n              const parsedConfig = JSON.parse(storageConfig);\n              \n              // WICHTIG: Prfe NOCHMAL nach dem Parsen, ob das Panel geffnet wurde\n              if (this._showConfigPanel) {\n                this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (nach Parsen bei saver_config)');\n                return;\n                }\n\n              // Neues Format: Objekt mit \"calendars\" Property\n              if (parsedConfig && typeof parsedConfig === 'object' && Array.isArray(parsedConfig.calendars)) {\n                this._debug('[Config] set hass: Konfiguration aus Saver neu geladen (neues Format mit calendars)');\n                \n                // WICHTIG: Prfe NOCHMAL vor dem Aktualisieren von this._config.calendars\n                if (this._showConfigPanel) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (vor calendars-Update bei saver_config)');\n                  return;\n                }\n\n                // WICHTIG: Finale Prfung direkt vor dem Aktualisieren von this._config.calendars\n                // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n                const finalPanelCheckSaver = this._showConfigPanel;\n                if (finalPanelCheckSaver) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (finale Prfung vor calendars-Update bei saver_config). _showConfigPanel=' + finalPanelCheckSaver);\n                  return;\n                }\n\n                // Ersetze this._config.calendars vollstndig mit den geladenen Kalendern\n                this._config.calendars = parsedConfig.calendars.map(cal => {\n                  // Stelle sicher, dass timeRanges im korrekten Format sind\n                  let timeRanges = [];\n                  if (cal.timeRanges && Array.isArray(cal.timeRanges)) {\n                    timeRanges = cal.timeRanges.map((range, idx) => {\n                      // Prfe zuerst, ob es ein Array ist (altes Format)\n                      if (Array.isArray(range)) {\n                        // Altes Format: [start, end] - konvertiere zu neuem Format\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Altes Format [start, end] erkannt`);\n                        return {\n                          id: null,\n                          times: [...range],\n                        };\n                      } else if (typeof range === 'object' && range !== null && range.times && Array.isArray(range.times)) {\n                        // Neues Format: { id, times: [start, end]                               }\n                        const normalizedRange = {\n                          id: range.id || null,\n                          times: [...range.times],\n                        };\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Neues Format erkannt, id=\"${normalizedRange.id}\", times=[${normalizedRange.times.join(',')}]`);\n                        return normalizedRange;\n                      } else {\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Unbekanntes Format, verwende Default`);\n                        return { id: null, times: [null, null] };\n                }\n          });\n                }\n\n                  return {\n                    shortcut: cal.shortcut,\n                    name: cal.name || `Schicht ${cal.shortcut?.toUpperCase() || ''}`,\n                    color: cal.color || this._getDefaultColorForShortcut(cal.shortcut),\n                    enabled: cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1,\n                    statusRelevant: cal.statusRelevant === true || cal.statusRelevant === 'true' || cal.statusRelevant === 1,\n                    timeRanges: timeRanges,\n                  };\n                });\n                \n                // Lade Feiertage aus der Config, falls vorhanden\n                if (parsedConfig.holidays && typeof parsedConfig.holidays === 'object') {\n                  this._config.holidays = { ...parsedConfig.holidays };\n                  this._debug('[Config] set hass: Feiertage aus Saver neu geladen:', this._config.holidays);\n                  // Invalidiere Holiday-Cache, damit Feiertage neu berechnet werden\n                  this._holidayCache = {};\n                  this._debug('[Config] set hass: Holiday-Cache invalidiert aufgrund von Feiertags-nderung');\n                }\n                if (parsedConfig.statusOnlyInTimeRange !== undefined) {\n                  this._config.statusOnlyInTimeRange = parsedConfig.statusOnlyInTimeRange;\n                  this._debug('[Config] set hass: statusOnlyInTimeRange aus Saver neu geladen:', this._config.statusOnlyInTimeRange);\n                }\n\n                this._debug(`[Config] set hass: ${this._config.calendars.length} Kalender geladen`);\n                this._config.calendars.forEach(cal => {\n                  this._debug(`[Config] set hass: Kalender \"${cal.shortcut}\":`, {\n                    name: cal.name,\n                    enabled: cal.enabled,\n                    statusRelevant: cal.statusRelevant,\n                    timeRanges_count: cal.timeRanges?.length || 0,\n                  });\n                });\n                \n                this._debug('[Config] set hass: Konfiguration aus Storage neu geladen und this._config aktualisiert');\n                // Prfe nochmal, ob das Panel geffnet wurde, bevor wir updaten\n                if (!this._showConfigPanel) {\n                  this.requestUpdate();\n                } else {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe requestUpdate()');\n                }\n    } else {\n                this._debug('[Config] set hass: Konfiguration konnte nicht geparst werden - erwartetes Format: { calendars: [...] }');\n                }\n} catch (error) {\n            this._debug('[Config] set hass: Fehler beim Parsen der neu geladenen Konfiguration:', error);\n                }\n                }\n        }).catch(error => {\n          this._debug('[Config] set hass: Fehler beim Neuladen der Konfiguration aus dem Storage:', error);\n        });\n                }\n\n      // Prfe Config-Entity und Status-Entity nur bei text_entity Modus\n      // (bei Saver werden diese nicht bentigt)\n      if (this._config.store_mode !== 'saver' && hass?.states) {\n        try {\n          this.checkConfigEntity();\n          this.checkStatusEntity();\n        } catch (error) {\n          this._debug('[Config] set hass: Fehler beim Prfen der Config/Status-Entities:', error);\n                }\n                }\n                }\n    // Nur updaten, wenn das Panel nicht geffnet ist\n    if (!this._showConfigPanel) {\n      this.requestUpdate();\n                }\n                }\n\n  get config() {\n    return this._config;\n                }\n\n  set config(config) {\n    this._debug('[Config] set config: === WIRD AUFGERUFEN ===');\n    this._debug('[Config] set config: _isInitialLoad Status:', this._isInitialLoad);\n    \n    // Editor und View sind unabhngig: Editor verwendet nur YAML-Config, View ldt Schichtdaten aus Saver\n    // Die bergebene Config wird direkt verwendet, ohne Merge mit Saver-Config\n    this._config = config;\n    this._debug('[Config] set config: Neue Konfiguration erhalten', {\n      store_mode: config?.store_mode,\n      saver_key: config?.saver_key,\n      calendars_count: config?.calendars?.length,\n      hasHass: !!this._hass,\n    });\n\n    // Initialisiere _displayedMonths aus der Config\n    if (config && config.initialDisplayedMonths) {\n      // Verwende initialDisplayedMonths als Standardwert\n      const maxMonths = config.numberOfMonths || 14;\n      this._displayedMonths = Math.min(config.initialDisplayedMonths, maxMonths);\n    } else if (config && config.numberOfMonths && !this._displayedMonths) {\n      // Fallback: Verwende numberOfMonths, falls initialDisplayedMonths nicht gesetzt ist\n      this._displayedMonths = config.numberOfMonths;\n    } else if (config && config.numberOfMonths) {\n      // Stelle sicher, dass _displayedMonths nicht grer als numberOfMonths ist\n      this._displayedMonths = Math.min(this._displayedMonths || 2, config.numberOfMonths);\n                }\n\n    // Initialisiere _selectedCalendar - prfe nur aktivierte Kalender\n    const allCalendars = this._getAllCalendars();\n\n    // Synchronisiere _selectedCalendar immer mit config.selectedCalendar\n    if (config && config.selectedCalendar) {\n      // Prfe ob der ausgewhlte Kalender aktiviert ist\n      const exists = allCalendars.some(cal => cal.shortcut === config.selectedCalendar);\n      if (exists) {\n        // Aktualisiere _selectedCalendar, auch wenn es bereits gesetzt ist\n        this._selectedCalendar = config.selectedCalendar;\n      } else {\n        // Wenn der ausgewhlte Kalender nicht aktiviert ist, verwende den ersten aktivierten\n        if (allCalendars.length > 0) {\n          this._selectedCalendar = allCalendars[0].shortcut;\n          if (config) {\n            config.selectedCalendar = this._selectedCalendar;\n                }\n        } else {\n          // Ausgewhlter Kalender ist nicht aktiviert, verwende den ersten aktivierten\n          if (allCalendars.length > 0) {\n            this._selectedCalendar = allCalendars[0].shortcut;\n            if (config) {\n              config.selectedCalendar = this._selectedCalendar;\n                }\n} else {\n            // Kein Kalender aktiviert - keine automatische Aktivierung\n            this._selectedCalendar = null;\n            if (config) {\n              config.selectedCalendar = null;\n                }\n                }\n                }\n                }\n    } else {\n      // Wenn kein selectedCalendar gesetzt ist, verwende den ersten aktivierten Kalender\n      if (allCalendars.length > 0) {\n        this._selectedCalendar = allCalendars[0].shortcut;\n        if (config) {\n          config.selectedCalendar = this._selectedCalendar;\n                }\n      } else {\n        // Kein Kalender aktiviert - keine automatische Aktivierung\n        this._selectedCalendar = null;\n        if (config) {\n          config.selectedCalendar = null;\n                }\n                }\n                }\n\n    // Wenn hass vorhanden ist, bedeutet das, dass die Karte bereits initialisiert wurde\n    // Setze _isInitialLoad auf false, wenn hass vorhanden ist (Karte ist bereit)\n    if (this._hass && this._isInitialLoad) {\n      this._debug('[Config] set config: hass vorhanden - markiere initialen Load als abgeschlossen');\n      this._isInitialLoad = false;\n                }\n\n    if (this._hass) {\n      // Initialisiere Storage-Adapter\n      this._initializeStorage();\n      \n      this.loadWorkingDays();\n      // Prfe Warnungen ber Storage-Adapter\n      this._updateWarnings();\n      \n      // Wenn die Konfiguration gesetzt wird und es nicht der initiale Load ist,\n      // speichere die Konfiguration (z.B. wenn der Editor geschlossen wird)\n      // Dies stellt sicher, dass nderungen im Editor immer gespeichert werden\n      // Prfe jetzt nochmal, da _isInitialLoad mglicherweise gerade auf false gesetzt wurde\n      const isStillInitialLoad = this._isInitialLoad;\n      if (!isStillInitialLoad && this._config) {\n        this._debug('[Config] set config: Konfiguration wurde gesetzt (nicht initialer Load)');\n        this._debug('[Config] set config: Editor wurde geschlossen - speichere Konfiguration');\n        // Verwende setTimeout, um sicherzustellen, dass die Konfiguration vollstndig gesetzt ist\n        setTimeout(() => {\n          this._debug('[Config] set config: Starte saveConfigToEntity() nach setTimeout');\n          this.saveConfigToEntity();\n        }, 0);\n      } else if (isStillInitialLoad) {\n        this._debug('[Config] set config: Initialer Load erkannt - berspringe Speichern');\n                }\n    } else {\n      this._debug('[Config] set config: hass noch nicht verfgbar - warte auf Initialisierung');\n                }\n\n    // Markiere initialen Load als abgeschlossen NACH dem ersten Rendering\n    // (nicht hier, sondern in firstUpdated oder nach dem ersten config-changed Event)\n\n    this.requestUpdate();\n                }\n\n  // Wird aufgerufen, wenn ein config-changed Event empfangen wird\n  // (nur dann wird die Config gespeichert, nicht beim initialen Laden)\n  _handleConfigChanged() {\n    this._debug('[Config] _handleConfigChanged: Event empfangen - Konfiguration wurde gendert');\n    \n    // Verhindere Speichern beim initialen Load\n    if (this._isInitialLoad) {\n      this._debug('[Config] _handleConfigChanged: Initialer Load erkannt, berspringe Config-Speichern');\n      this._debug('[Config] _handleConfigChanged: Markiere initialen Load als abgeschlossen');\n      // Markiere initialen Load als abgeschlossen NACH dem ersten Event\n      this._isInitialLoad = false;\n      return;\n                }\n\n    if (!this._hass) {\n      this._debug('[Config] _handleConfigChanged: Abbruch - hass nicht verfgbar');\n      return;\n                }\n\n    if (!this._config) {\n      this._debug('[Config] _handleConfigChanged: Abbruch - config nicht verfgbar');\n      return;\n                }\n\n    this._debug('[Config] _handleConfigChanged: Starte saveConfigToEntity()');\n    this.saveConfigToEntity();\n                }\n\n  // Liest eine Saver-Variable (z.B. \"Schichtplan\" aus saver.saver.attributes.variables)\n  _readSaverVariable(key) {\n    if (!this._hass || !this._hass.states || !key) {\n      this._debug('[Saver] _readSaverVariable: Kein hass oder key vorhanden');\n      return null;\n                }\n\n    // Saver-Variablen sind in saver.saver.attributes.variables gespeichert\n    const saverEntity = this._hass?.states?.['saver.saver'];\n    if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n      const variables = saverEntity.attributes.variables;\n      const variableValue = variables[key];\n\n      if (variableValue !== undefined && variableValue !== null) {\n        // Konvertiere zu String und trimme\n        const value = String(variableValue).trim();\n        if (value !== '') {\n          this._debug(\n            `[Saver] _readSaverVariable: Variable \"${key}\" gefunden in saver.saver.attributes.variables, Lnge: ${value.length} Zeichen`\n          );\n          // Zeige ersten 100 Zeichen der Daten fr Debug\n          if (value.length > 0) {\n            const preview = value.substring(0, 100);\n            this._debug(\n              `[Saver] _readSaverVariable: Daten-Vorschau: \"${preview}${value.length > 100 ? '...' : ''}\"`\n            );\n                }\nreturn value;\n                }\n                }\n\n      // Debug: Zeige verfgbare Variablen\n      const availableKeys = Object.keys(variables);\n      this._debug(\n        `[Saver] _readSaverVariable: Variable \"${key}\" nicht gefunden. Verfgbare Variablen: ${availableKeys.length > 0 ? availableKeys.join(', ') : 'keine'}`\n      );\n    } else {\n      this._debug(\n        `[Saver] _readSaverVariable: saver.saver Entity nicht gefunden oder hat keine variables-Attribute`\n      );\n                }\n\n    this._debug(`[Saver] _readSaverVariable: Variable \"${key}\" nicht gefunden oder leer`);\n    return null;\n                }\n\n  // Prft ob Saver verfgbar ist (mindestens eine Saver-Entity existiert)\n  _isSaverAvailable() {\n    if (!this._hass || !this._hass.states) {\n      return false;\n                }\n    // Prfe ob irgendeine saver.* Entity existiert\n    return Object.keys(this._hass.states).some(entityId => entityId.startsWith('saver.'));\n                }\n\n  // Liest Daten vom Saver (wenn store_mode == 'saver' und Saver verfgbar)\n  _loadDataFromSaver() {\n    if (!this._config || this._config.store_mode !== 'saver') {\n      this._debug('[Saver] _loadDataFromSaver: store_mode ist nicht \"saver\"');\n      return null;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    this._debug(\n      `[Saver] _loadDataFromSaver: Versuche Daten von Saver-Variable \"${saverKey}\" zu laden`\n    );\n    const data = this._readSaverVariable(saverKey);\n\n    // Wenn Daten vorhanden, gib sie zurck\n    if (data && data.trim() !== '') {\n      this._debug(\n        `[Saver] _loadDataFromSaver: Daten erfolgreich geladen, Lnge: ${data.length} Zeichen`\n      );\n      return data;\n                }\n\n    this._debug('[Saver] _loadDataFromSaver: Keine Daten gefunden');\n    return null;\n                }\n\n  // Liest Config vom Saver (wenn store_mode == 'saver' und Saver verfgbar)\n  _loadConfigFromSaver() {\n    if (!this._config || this._config.store_mode !== 'saver') {\n      this._debug('[Saver] _loadConfigFromSaver: store_mode ist nicht \"saver\"');\n      return null;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    const configKey = `${saverKey}_config`;\n    this._debug(\n      `[Saver] _loadConfigFromSaver: Versuche Config von Saver-Variable \"${configKey}\" zu laden`\n    );\n    const config = this._readSaverVariable(configKey);\n\n    // Wenn Config vorhanden, gib sie zurck\n    if (config && config.trim() !== '') {\n      this._debug(\n        `[Saver] _loadConfigFromSaver: Config erfolgreich geladen, Lnge: ${config.length} Zeichen`\n      );\n      return config;\n                }\n\n    this._debug('[Saver] _loadConfigFromSaver: Keine Config gefunden');\n    return null;\n                }\n\n  /**\n   * Aktualisiert Warnungen basierend auf dem Storage-Adapter\n   * @private\n   */\n  _updateWarnings() {\n    if (!this._storage) {\n      return;\n                }\n\n    const warnings = this._storage.getWarnings();\n    if (warnings) {\n      if (warnings.config) {\n        this._configWarning = warnings.config;\n        this._updateConfigWarningDirectly();\n                }\n      if (warnings.status) {\n        this._statusWarning = warnings.status;\n        this._updateStatusWarningDirectly();\n                }\n    } else {\n      // Keine Warnungen - setze auf null\n      if (this._configWarning) {\n        this._configWarning = null;\n        this._updateConfigWarningDirectly();\n                }\n      if (this._statusWarning) {\n        this._statusWarning = null;\n        this._updateStatusWarningDirectly();\n                }\n                }\n                }\n\n  async loadWorkingDays() {\n    if (!this._hass || !this._config) {\n      this._debug('[Laden] loadWorkingDays: Kein hass oder config vorhanden');\n      return;\n                }\n\n    // Prfe Entity nur bei text_entity Modus (bei Saver wird keine Entity bentigt)\n    if (this._config.store_mode !== 'saver' && !this._config.entity) {\n      this._debug('[Laden] loadWorkingDays: Keine entity vorhanden (text_entity Modus bentigt entity)');\n      return;\n                }\n\n    // Stelle sicher, dass Storage initialisiert ist\n    if (!this._storage) {\n      this._initializeStorage();\n                }\n\n    if (!this._storage) {\n      this._debug('[Laden] loadWorkingDays: Kein Storage-Adapter verfgbar');\n      return;\n                }\n\n    this._debug(\n      `[Laden] loadWorkingDays: Start, store_mode: \"${this._config.store_mode}\", entity: \"${this._config.entity || 'nicht bentigt (Saver-Modus)'}\"`\n    );\n\n    let dataString = null;\n    let dataSource = 'none';\n\n    // Versuche zuerst den primren Storage-Adapter\n    try {\n      dataString = await this._storage.loadData();\n      if (dataString) {\n        dataSource = this._config.store_mode === 'saver' ? 'saver' : 'entities';\n        this._debug(\n          `[Laden] loadWorkingDays: Daten von ${dataSource} geladen, Lnge: ${dataString.length} Zeichen`\n        );\n                }\n    } catch (error) {\n      this._debug(`[Laden] loadWorkingDays: Fehler beim Laden: ${error.message}`, error);\n                }\n\n    // Fallback: Wenn Saver-Modus und keine Daten, versuche EntityStorage\n    if ((!dataString || dataString.trim() === '') && this._config.store_mode === 'saver') {\n      this._debug('[Laden] loadWorkingDays: Keine Daten vom Saver, Fallback zu Entities');\n      try {\n        const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n        dataString = await fallbackStorage.loadData();\n        if (dataString) {\n          dataSource = 'entities-fallback';\n          this._debug(\n            `[Laden] loadWorkingDays: Daten von Entities (Fallback) geladen, Lnge: ${dataString.length} Zeichen`\n          );\n                }\n      } catch (error) {\n        this._debug(`[Laden] loadWorkingDays: Fehler beim Fallback-Laden: ${error.message}`, error);\n                }\n                }\n\n    // Synchronisiere _knownEntityIds mit EntityStorage (falls verwendet)\n    if (this._storage && this._storage._knownEntityIds) {\n      this._knownEntityIds = this._storage._knownEntityIds;\n                }\n\n    // Parse die Daten (egal ob von Saver oder Entities)\n    if (dataString && dataString.trim() !== '') {\n      this._debug(`[Laden] loadWorkingDays: Parse Daten von Quelle: \"${dataSource}\"`);\n      this._debug(`[Laden] loadWorkingDays: Daten-String (erste 200 Zeichen): ${dataString.substring(0, 200)}...`);\n      this.parseWorkingDays(dataString);\n      const workingDaysCount = Object.keys(this._workingDays).length;\n      this._debug(`[Laden] loadWorkingDays: Daten geparst, ${workingDaysCount} Monate gefunden`);\n      this._debug(`[Laden] loadWorkingDays: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n      // Zeige Details fr jeden Monat\n      Object.keys(this._workingDays).forEach(key => {\n        const monthData = this._workingDays[key];\n        if (typeof monthData === 'object' && !Array.isArray(monthData)) {\n          const daysCount = Object.keys(monthData).length;\n          this._debug(`[Laden] loadWorkingDays: Monat \"${key}\": ${daysCount} Tage mit Daten`);\n          // Zeige erste 5 Tage als Beispiel\n          const sampleDays = Object.keys(monthData).slice(0, 5);\n          sampleDays.forEach(day => {\n            this._debug(`[Laden] loadWorkingDays: Monat \"${key}\", Tag ${day}:`, monthData[day]);\n          });\n                }\n      });\n    } else {\n      this._debug(\n        '[Laden] loadWorkingDays: Keine Daten zum Parsen vorhanden, setze _workingDays auf {}'\n      );\n      this._workingDays = {};\n                }\n\n    // Prfe Speicherverbrauch und zeige Warnung bei 90%+\n    // Nur bei text_entity Modus (Saver hat keine Lngenbegrenzung)\n    if (this._config.store_mode !== 'saver') {\n      this.checkStorageUsage();\n    } else {\n      // Bei Saver-Modus keine Speicherwarnung ntig\n      this._storageWarning = null;\n                }\n\n    // Bereinige alte Monate: entferne alle Monate, die nicht angezeigt werden\n    // Die Karte zeigt numberOfMonths Monate an (ab aktueller Monat)\n    // Behalten wir: Vormonat (aktuell - 1) und alle angezeigten Monate (aktuell bis aktuell + numberOfMonths - 1)\n    // Fhre die Bereinigung nur beim initialen Laden aus, nicht bei jedem State-Update\n    // (um zu verhindern, dass gerade geschriebene Daten sofort wieder gelscht werden)\n    if (Object.keys(this._workingDays).length > 0 && !this._cleanupDone) {\n      this._cleanupDone = true;\n      const numberOfMonths = this._config.numberOfMonths || 2;\n      const now = new Date();\n      const currentMonth = now.getMonth() + 1; // 1-12\n      const currentYearFull = now.getFullYear();\n      const currentYear = currentYearFull % 100; // Kurzform, z.B. 25\n\n      // Berechne Vormonat und sein Jahr\n      let previousMonth, previousYear;\n      if (currentMonth === 1) {\n        previousMonth = 12;\n        previousYear = (currentYearFull - 1) % 100; // Jahr des Vormonats (Dezember des Vorjahres)\n      } else {\n        previousMonth = currentMonth - 1;\n        previousYear = currentYear;\n                }\n\n      // Erstelle Liste aller Monate, die behalten werden sollen\n      const monthsToKeep = [];\n\n      // Fge Vormonat hinzu\n      monthsToKeep.push({ year: previousYear, month: previousMonth });\n\n      // Fge alle angezeigten Monate hinzu\n      for (let i = 0; i < numberOfMonths; i++) {\n        const date = new Date(currentYearFull, currentMonth - 1 + i, 1);\n        const year = date.getFullYear() % 100;\n        const month = date.getMonth() + 1;\n        monthsToKeep.push({ year, month });\n                }\n\n      let hasChanges = false;\n\n      for (const key of Object.keys(this._workingDays)) {\n        // Parse den Key um zu prfen, ob er behalten werden soll\n        const keyParts = key.split(':');\n        if (keyParts.length === 2) {\n          const keyYear = parseInt(keyParts[0]);\n          const keyMonth = parseInt(keyParts[1]);\n\n          // Prfe ob dieser Key in der Liste der zu behaltenden Monate ist\n          const shouldKeep = monthsToKeep.some(m => m.year === keyYear && m.month === keyMonth);\n\n          //   key,\n          //   keyYear,\n          //   keyMonth,\n          //   shouldKeep,\n          //   monthsToKeep: monthsToKeep.map(m => `${m.year}:${m.month}`)\n          // });\n\n          if (!shouldKeep) {\n            delete this._workingDays[key];\n            hasChanges = true;\n                }\n        } else {\n          // Ungltiges Format, entfernen\n          delete this._workingDays[key];\n          hasChanges = true;\n                }\n                }\n\n      // Wenn nderungen vorgenommen wurden, speichere die bereinigten Daten\n      if (hasChanges) {\n        const cleanedValue = this.serializeWorkingDays();\n        try {\n          await this._hass.callService('input_text', 'set_value', {\n            entity_id: this._config.entity,\n            value: cleanedValue,\n          });\n        } catch (error) {                              }\n                }\n                }\n\n    this.requestUpdate();\n                }\n\n  _parseWorkingDaysIntoObject(dataString, targetObject) {\n    if (!dataString || dataString.trim() === '') return;\n\n    const parts = dataString.split(';').filter(p => p.trim() !== '');\n    for (const part of parts) {\n      const trimmedPart = part.trim();\n      if (!trimmedPart) continue;\n\n      // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen> oder altes Format\n      // Beispiel: \"25:11:01a,02ah,03b\" oder \"25:11:01,02,03\" (altes Format ohne Elemente)\n      const colons = trimmedPart.split(':');\n\n      if (colons.length === 2) {\n        // Altes Format ohne Jahr (Kompatibilitt): <monat>:<tag>,<tag>\n        const month = colons[0].trim();\n        const daysStr = colons[1].trim();\n        if (month && daysStr) {\n          const monthNum = parseInt(month);\n          if (!isNaN(monthNum) && monthNum >= 1 && monthNum <= 12) {\n            // Verwende aktuelles Jahr\n            const now = new Date();\n            const year = now.getFullYear() % 100;\n            const key = `${this.formatTwoDigits(year)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n                }\n      } else if (colons.length >= 3) {\n        // Prfe ob erstes Element ein Jahr ist (kleiner als 13) oder ein Monat\n        const first = parseInt(colons[0].trim());\n        const second = parseInt(colons[1].trim());\n\n        if (first <= 12 && second > 12) {\n          // Altes Format: <monat>:<jahr>:<tag>,<tag> - konvertiere zu neuem Format\n          const monthNum = first;\n          const yearNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n        } else if (first > 12 && second <= 12) {\n          // Neues Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n          const yearNum = first;\n          const monthNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n                }\n                }\n                }\n                }\n\n  // Parst Tage mit Elementen: \"01a,02ah,03b\" -> {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]                              }\n  // Oder altes Format ohne Elemente: \"01,02,03\" -> {1: [], 2: [], 3: []                              }\n  _parseDaysWithElements(daysStr) {\n    const result = {};\n    const dayEntries = daysStr.split(',').filter(d => d.trim() !== '');\n\n    for (const entry of dayEntries) {\n      const trimmed = entry.trim();\n      if (!trimmed) continue;\n\n      // Extrahiere Tag und Elemente: \"01a\" -> day=1, elements=[\"a\"]\n      // Oder: \"02ah\" -> day=2, elements=[\"a\", \"h\"]\n      // Oder altes Format: \"01\" -> day=1, elements=[]\n      const match = trimmed.match(/^(\\d+)([a-z]*)$/i);\n      if (match) {\n        const dayNum = parseInt(match[1]);\n        const elementsStr = match[2] || '';\n        // WICHTIG: Filtere nur leere Strings heraus, nicht einzelne Buchstaben\n        // split('') teilt jeden Buchstaben in ein separates Array-Element\n        const elements = elementsStr.split('').filter(e => e && e.trim() !== '');\n\n        if (!isNaN(dayNum) && dayNum >= 1 && dayNum <= 31) {\n          // Wenn der Tag bereits existiert, fge Elemente hinzu (keine Duplikate)\n          if (result[dayNum]) {\n            // Vereinige Arrays und entferne Duplikate\n            result[dayNum] = [...new Set([...result[dayNum], ...elements])];\n          } else {\n            result[dayNum] = elements;\n                }\n                }\n      } else {\n        // Debug-Log wenn kein Match gefunden wurde\n        if (trimmed.includes('03')) {\n          this._debug(`[Parsing] Kein Match fr \"${trimmed}\"`);\n                }\n                }\n                }\n\n    return result;\n                }\n\n  parseWorkingDays(dataString) {\n    this._workingDays = {};\n    this._parseWorkingDaysIntoObject(dataString, this._workingDays);\n                }\n\n  findAdditionalEntities(baseEntityId) {\n    const additionalEntities = [];\n\n    if (!this._hass || !this._hass.states) {\n      return additionalEntities;\n                }\n\n    // Extrahiere den Domain-Teil (z.B. \"input_text.arbeitszeiten\")\n    const entityParts = baseEntityId.split('.');\n    if (entityParts.length !== 2) {\n      return additionalEntities;\n                }\n\n    const [domain, baseName] = entityParts;\n\n    // Suche nach Entities mit _001, _002, etc. (bis _999)\n    for (let i = 1; i <= 999; i++) {\n      const suffix = String(i).padStart(3, '0'); // _001, _002, ..., _999\n      const additionalEntityId = `${domain}.${baseName}_${suffix}`;\n\n      if (this._hass?.states?.[additionalEntityId]) {\n        additionalEntities.push(additionalEntityId);\n      } else {\n        // Wenn eine Entity nicht existiert, breche ab (Entities sind sequenziell)\n        // Es macht keinen Sinn weiterzusuchen, wenn _001 fehlt\n        break;\n                }\n                }\n\n    return additionalEntities;\n                }\n\n  getEntityMaxLength(entityId) {\n    if (!this._hass || !this._hass.states || !entityId) {\n      return null;\n                }\n\n    const entity = this._hass?.states?.[entityId];\n    if (!entity || !entity.attributes) {\n      return null;\n                }\n\n    // input_text Entities haben ein 'max' Attribut, das die maximale Lnge definiert\n    const maxLength = entity.attributes.max;\n\n    if (maxLength !== undefined && maxLength !== null) {\n      return parseInt(maxLength);\n                }\n\n    return null;\n                }\n\n  getAllEntityMaxLengths() {\n    const maxLengths = {};\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      return maxLengths;\n                }\n\n    // Prfe Haupt-Entity\n    const mainEntityId = this._config.entity;\n    const mainMaxLength = this.getEntityMaxLength(mainEntityId);\n    if (mainMaxLength !== null) {\n      maxLengths[mainEntityId] = mainMaxLength;\n                }\n\n    // Prfe zustzliche Entities\n    const additionalEntities = this.findAdditionalEntities(mainEntityId);\n    for (const additionalEntityId of additionalEntities) {\n      const additionalMaxLength = this.getEntityMaxLength(additionalEntityId);\n      if (additionalMaxLength !== null) {\n        maxLengths[additionalEntityId] = additionalMaxLength;\n                }\n                }\n\n    return maxLengths;\n                }\n\n  checkStorageUsage(serializedDataLength = null) {\n    // Warnungen nur bei text_entity Modus (Saver hat keine Lngenbegrenzung)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    // Verwende _knownEntityIds falls verfgbar, sonst suche neu\n    let allEntityIds;\n    if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n      allEntityIds = [...this._knownEntityIds];\n    } else {\n      // Fallback: Suche Entities neu\n      allEntityIds = [this._config.entity, ...this.findAdditionalEntities(this._config.entity)];\n                }\n\n    const maxLengths = this.getAllEntityMaxLengths();\n    if (Object.keys(maxLengths).length === 0) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    // Berechne Gesamtlnge und maximale Gesamtlnge\n    let totalCurrentLength = 0;\n    let totalMaxLength = 0;\n\n    // Wenn eine serializedDataLength bergeben wurde, verwende diese (z.B. nach toggleDay)\n    // Ansonsten lese die Lngen aus den aktuellen States\n    if (serializedDataLength !== null && serializedDataLength !== undefined) {\n      totalCurrentLength = serializedDataLength;\n    } else {\n      // Lese Lngen aus den aktuellen States\n      for (const entityId of allEntityIds) {\n        const entity = this._hass?.states?.[entityId];\n        if (entity && entity.state) {\n          totalCurrentLength += entity.state.length;\n                }\n                }\n                }\n\n    // Berechne maximale Gesamtlnge\n    for (const entityId of allEntityIds) {\n      const maxLength = maxLengths[entityId];\n      if (maxLength !== undefined && maxLength !== null) {\n        totalMaxLength += maxLength;\n                }\n                }\n\n    if (totalMaxLength === 0) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    const percentage = (totalCurrentLength / totalMaxLength) * 100;\n\n    // Prfe ob 90% berschritten werden\n    if (percentage >= 90) {\n      this._storageWarning = {\n        show: true,\n        currentLength: totalCurrentLength,\n        maxLength: totalMaxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n    } else {\n      this._storageWarning = null;\n                }\n\n    // Aktualisiere Warnung direkt im DOM ohne Re-Rendering\n    this._updateStorageWarningDirectly();\n                }\n\n  getConfigEntityId() {\n    // Leite die Config-Entity-ID aus der Haupt-Entity ab\n    if (!this._config || !this._config.entity) {\n      return null;\n                }\n    // Fge \"_config\" an die Entity-ID an\n    // z.B. \"input_text.arbeitszeiten\" -> \"input_text.arbeitszeiten_config\"\n    return this._config.entity + '_config';\n                }\n\n  getStatusEntityId() {\n    // Leite die Status-Entity-ID aus der Haupt-Entity ab\n    if (!this._config || !this._config.entity) {\n      return null;\n                }\n    // Fge \"_status\" an die Entity-ID an\n    // z.B. \"input_text.arbeitszeiten\" -> \"input_text.arbeitszeiten_status\"\n    return this._config.entity + '_status';\n                }\n\n  checkConfigEntity() {\n    // Warnungen nur bei text_entity Modus (bei Saver wird Config anders gespeichert)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    // Prfe ob die Config-Entity existiert\n    if (!this._config || !this._config.entity) {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    // Wenn kein hass vorhanden ist (z.B. im Editor), zeige Warnung im Editor-Modus\n    if (!this._hass || !this._hass.states) {\n      if (this._isInEditorMode()) {\n        this._configWarning = {\n          show: true,\n          type: 'missing',\n          configEntityId: configEntityId,\n        };\n      } else {\n        this._configWarning = null;\n                }\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      this._configWarning = {\n        show: true,\n        type: 'missing',\n        configEntityId: configEntityId,\n      };\n    } else {\n      // Prfe ob es eine Gren-Warnung gibt, die beibehalten werden soll\n      if (this._configWarning && this._configWarning.type === 'size') {\n        // Behalte die Gren-Warnung\n      } else {\n        this._configWarning = null;\n                }\n                }\n\n    this._updateConfigWarningDirectly();\n                }\n\n  // Rendert eine Warnung fr eine fehlende Entity\n  _renderMissingEntityWarning(entityId, entityName, maxLength = 255, isConfig = false) {\n    const entityNameShort = entityId.replace('input_text.', '');\n    return html`\n      <div class=\"storage-warning\">\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">${entityName} fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${entityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hinzufgen  Text</li>\n              <li>Name: <code>${entityNameShort}</code></li>\n              <li>Maximale Lnge: <code>${maxLength}</code> Zeichen</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n                }\n\n  checkStatusEntity() {\n    // Warnungen nur bei text_entity Modus (bei Saver wird Status anders gespeichert)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    // Prfe ob die Status-Entity existiert\n    if (!this._config || !this._config.entity) {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    const statusEntityId = this.getStatusEntityId();\n    if (!statusEntityId) {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    // Wenn kein hass vorhanden ist (z.B. im Editor), zeige Warnung im Editor-Modus\n    if (!this._hass || !this._hass.states) {\n      if (this._isInEditorMode()) {\n        this._statusWarning = {\n          show: true,\n          type: 'missing',\n          statusEntityId: statusEntityId,\n        };\n      } else {\n        this._statusWarning = null;\n                }\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    const statusEntity = this._hass.states[statusEntityId];\n    if (!statusEntity) {\n      this._statusWarning = {\n        show: true,\n        type: 'missing',\n        statusEntityId: statusEntityId,\n      };\n    } else {\n      this._statusWarning = null;\n                }\n\n    this._updateStatusWarningDirectly();\n                }\n\n  // Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n  _createCompressedConfig(activeShifts) {\n    // Speichere als JSON (direktes Array, kein Objekt-Wrapper)\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer (erstes [ und letztes ])\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n                }\n\n    // Entferne \"null\" aus dem String (behalte Kommas)\n    // Wiederhole die Ersetzung, bis keine null mehr vorhanden sind (fr mehrere null hintereinander)\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      // Ersetze ,null, durch ,, (mehrfach, bis keine null mehr vorhanden sind)\n      configJson = configJson.replace(/,null,/g, ',,');\n      // Ersetze ,null] durch ,] (falls am Ende eines Arrays)\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      // Ersetze [null, durch [, (falls am Anfang eines Arrays)\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      // Ersetze ,null, am Ende des Strings (falls letztes Element null ist)\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    // Ersetze \",\" durch , (Anfhrungszeichen um Kommas)\n    configJson = configJson.replace(/\",\"/g, ',');\n    // Ersetze [\" durch [ (Anfhrungszeichen am Anfang eines Arrays)\n    configJson = configJson.replace(/\\[\"/g, '[');\n    // Ersetze \"] durch ] (Anfhrungszeichen am Ende eines Arrays)\n    configJson = configJson.replace(/\"\\]/g, ']');\n    // Ersetze ,\" durch , (Anfhrungszeichen nach Komma)\n    configJson = configJson.replace(/,\"/g, ',');\n    // Ersetze \", durch , (Anfhrungszeichen vor Komma)\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n                }\n\n  // Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n  _createFullJsonConfig(activeShifts) {\n    // Vollstndiges JSON-Format: Objekt mit shifts, setup und lastchange\n    // Format: {shifts:[], setup:{}, lastchange:123456789                              }\n    const configObject = {\n      shifts: activeShifts,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp (Sekunden seit 1970-01-01)\n    };\n    return JSON.stringify(configObject);\n                }\n\n  async saveConfigToEntity() {\n    this._debug('[Config] saveConfigToEntity: === START: Speichere Konfiguration ===');\n    \n    // Speichere die Konfiguration in der Config-Entity oder im Saver\n    // Verhindere Speichern beim initialen Load\n    if (this._isInitialLoad) {\n      this._debug('[Config] saveConfigToEntity: Initialer Load, berspringe Config-Speichern');\n      return;\n                }\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._debug('[Config] saveConfigToEntity: Abbruch - hass, config oder entity fehlt', {\n        hasHass: !!this._hass,\n        hasConfig: !!this._config,\n        hasEntity: !!(this._config && this._config.entity),\n      });\n      return;\n                }\n\n    this._debug('[Config] saveConfigToEntity: Prfe Konfiguration', {\n      store_mode: this._config.store_mode,\n      saver_key: this._config.saver_key,\n      entity: this._config.entity,\n      calendars_count: this._config.calendars ? this._config.calendars.length : 0,\n    });\n\n    // Debug: Zeige alle empfangenen Kalender-Daten\n    if (this._config.calendars && this._config.calendars.length > 0) {\n      this._debug('[Config] saveConfigToEntity: Empfangene Kalender-Daten:', \n        JSON.stringify(this._config.calendars, null, 2)\n      );\n      this._config.calendars.forEach((cal, index) => {\n        this._debug(`[Config] saveConfigToEntity: Kalender ${index + 1}:`, {\n          shortcut: cal.shortcut,\n          name: cal.name,\n          color: cal.color,\n          enabled: cal.enabled,\n          statusRelevant: cal.statusRelevant,\n          timeRanges_count: cal.timeRanges ? cal.timeRanges.length : 0,\n          timeRanges: cal.timeRanges || []\n        });\n      });\n    } else {\n      this._debug('[Config] saveConfigToEntity: Keine Kalender-Daten vorhanden');\n                }\n\n    // Verwende direkt das calendars-Format vom Config-Panel (keine Konvertierung mehr ntig)\n    const calendars = this._config.calendars || [];\n    \n    this._debug(`[Config] saveConfigToEntity: Speichere ${calendars.length} Kalender im neuen Format (direkt vom Config-Panel)`);\n    \n    // Debug: Zeige alle Kalender-Daten\n    calendars.forEach((cal, index) => {\n      this._debug(`[Config] saveConfigToEntity: Kalender ${index + 1}:`, {\n        shortcut: cal.shortcut,\n        name: cal.name,\n        color: cal.color,\n        enabled: cal.enabled,\n        statusRelevant: cal.statusRelevant,\n        timeRanges_count: cal.timeRanges ? cal.timeRanges.length : 0,\n        timeRanges: cal.timeRanges || []\n      });\n    });\n\n    // Stelle sicher, dass Storage initialisiert ist\n    if (!this._storage) {\n      this._debug('[Config] saveConfigToEntity: Storage nicht initialisiert, initialisiere...');\n      this._initializeStorage();\n                }\n\n    if (!this._storage) {\n      this._debug('[Config] saveConfigToEntity: Kein Storage-Adapter verfgbar');\n      return;\n                }\n\n    this._debug('[Config] saveConfigToEntity: Storage-Adapter gefunden, starte Speichern...', {\n      storageType: this._config.store_mode,\n      storageAdapter: this._storage.constructor.name\n    });\n\n    try {\n      // Verwende Storage-Adapter zum Speichern der Config\n      // Fr Saver: Direkt calendars-Format verwenden\n      // Fr Entity: Konvertierung zu komprimiertem Format (bleibt unverndert)\n      this._debug('[Config] saveConfigToEntity: Rufe _storage.saveConfig() auf...');\n      if (this._config.store_mode === 'saver') {\n        // Saver: Direkt calendars-Format verwenden und holidays bergeben\n        const holidays = this._config.holidays || {};\n        const statusOnlyInTimeRange = this._config.statusOnlyInTimeRange || false;\n        await this._storage.saveConfig(calendars, holidays, statusOnlyInTimeRange);\n      } else {\n        // Entity: Konvertierung zu komprimiertem Format (fr Rckwrtskompatibilitt)\n        // TODO: Knnte spter auch auf calendars-Format umgestellt werden\n        const allShifts = this._convertCalendarsToShifts(calendars);\n        await this._storage.saveConfig(allShifts);\n                }\n\n      // Aktualisiere Warnungen\n      this._updateWarnings();\n      \n      this._debug('[Config] saveConfigToEntity: === ENDE: Erfolgreich gespeichert ===');\n    } catch (error) {\n      // Fehler beim Schreiben - versuche Fallback\n      this._debug(`[Config] saveConfigToEntity: === FEHLER === Beim Schreiben: ${error.message}`, error);\n      \n      // Fallback: Wenn SaverStorage fehlschlgt, versuche EntityStorage\n      if (this._config.store_mode === 'saver') {\n        this._debug('[Config] saveConfigToEntity: Fallback zu EntityStorage');\n        try {\n          const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n          // Entity-Storage bentigt komprimiertes Format\n          const allShifts = this._convertCalendarsToShifts(calendars);\n          await fallbackStorage.saveConfig(allShifts);\n          this._updateWarnings();\n        } catch (fallbackError) {\n          this._debug(`[Config] saveConfigToEntity: Auch Fallback fehlgeschlagen: ${fallbackError.message}`, fallbackError);\n          this.checkConfigEntity();\n                }\n      } else {\n        this.checkConfigEntity();\n                }\n                }\n                }\n\n  /**\n   * Konvertiert calendars-Format zu komprimiertem shifts-Format (fr Entity-Storage)\n   * @private\n   */\n  _convertCalendarsToShifts(calendars) {\n    const allShifts = [];\n    if (calendars && Array.isArray(calendars)) {\n      for (const calendar of calendars) {\n        if (calendar && calendar.shortcut) {\n          const isEnabled = calendar.enabled === true || calendar.enabled === 'true' || calendar.enabled === 1;\n          const shiftData = [\n            calendar.shortcut,\n            calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`,\n          ];\n\n          // Konvertiere Zeitrume vom neuen Format zu altem Format\n          if (calendar.timeRanges && Array.isArray(calendar.timeRanges) && calendar.timeRanges.length > 0) {\n            // Zeitraum 1\n            const range1 = calendar.timeRanges[0];\n            let start1 = null;\n            let end1 = null;\n            if (range1) {\n              if (typeof range1 === 'object' && range1.times && Array.isArray(range1.times)) {\n                start1 = range1.times[0] && range1.times[0].trim() !== '' ? range1.times[0].trim() : null;\n                end1 = range1.times[1] && range1.times[1].trim() !== '' ? range1.times[1].trim() : null;\n              } else if (Array.isArray(range1) && range1.length >= 2) {\n                start1 = range1[0] && range1[0].trim() !== '' ? range1[0].trim() : null;\n                end1 = range1[1] && range1[1].trim() !== '' ? range1[1].trim() : null;\n                }\n                }\n            shiftData.push(start1, end1);\n\n            // Zeitraum 2\n            const range2 = calendar.timeRanges[1];\n            let start2 = null;\n            let end2 = null;\n            if (range2) {\n              if (typeof range2 === 'object' && range2.times && Array.isArray(range2.times)) {\n                start2 = range2.times[0] && range2.times[0].trim() !== '' ? range2.times[0].trim() : null;\n                end2 = range2.times[1] && range2.times[1].trim() !== '' ? range2.times[1].trim() : null;\n              } else if (Array.isArray(range2) && range2.length >= 2) {\n                start2 = range2[0] && range2[0].trim() !== '' ? range2[0].trim() : null;\n                end2 = range2[1] && range2[1].trim() !== '' ? range2[1].trim() : null;\n                }\n                }\n            shiftData.push(start2, end2);\n          } else {\n            shiftData.push(null, null, null, null);\n                }\n\n          // statusRelevant\n          const statusRelevant = calendar.statusRelevant !== false ? 1 : 0;\n          shiftData.push(statusRelevant);\n\n          // enabled\n          const enabled = isEnabled ? 1 : 0;\n          shiftData.push(enabled);\n\n          allShifts.push(shiftData);\n                }\n                }\n                }\n    return allShifts;\n                }\n\n  async _saveConfigToEntityFallback(activeShifts) {\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._debug('[Config] _saveConfigToEntityFallback: Keine configEntityId');\n      return;\n                }\n\n    this._debug(`[Config] _saveConfigToEntityFallback: Start, configEntityId: \"${configEntityId}\"`);\n\n    // Prfe ob die Entity existiert\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      // Entity existiert nicht, zeige Warnung\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Entity \"${configEntityId}\" existiert nicht`\n      );\n      this.checkConfigEntity();\n      return;\n                }\n\n    // Komprimiertes Format fr text_input Entities\n    const configJson = this._createCompressedConfig(activeShifts);\n    const configJsonLength = configJson.length;\n    this._debug(\n      `[Config] _saveConfigToEntityFallback: Config erstellt (komprimiert), Lnge: ${configJsonLength} Zeichen`\n    );\n\n    // Prfe ob der JSON-Text in das Entity passt\n    const maxLength = this.getEntityMaxLength(configEntityId);\n    if (maxLength !== null && configJsonLength > maxLength) {\n      // JSON ist zu lang, zeige Warnung\n      const percentage = (configJsonLength / maxLength) * 100;\n      this._configWarning = {\n        show: true,\n        type: 'size',\n        configEntityId: configEntityId,\n        currentLength: configJsonLength,\n        maxLength: maxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    try {\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Schreibe Config in Entity \"${configEntityId}\"`\n      );\n      await this._hass.callService('input_text', 'set_value', {\n        entity_id: configEntityId,\n        value: configJson,\n      });\n      this._debug(`[Config] _saveConfigToEntityFallback: Erfolgreich in Entity geschrieben`);\n      // Warnung entfernen, da Entity existiert und erfolgreich beschrieben wurde\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n    } catch (error) {\n      // Fehler beim Schreiben - knnte bedeuten, dass Entity nicht existiert\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Fehler beim Schreiben in Entity: ${error.message}`,\n        error\n      );\n      this.checkConfigEntity();\n                }\n                }\n\n  serializeWorkingDays() {\n    const parts = [];\n    // Sortiere nach Jahr:Monat\n    const keys = Object.keys(this._workingDays).sort((a, b) => {\n      const [yearA, monthA] = a.split(':').map(x => parseInt(x));\n      const [yearB, monthB] = b.split(':').map(x => parseInt(x));\n      if (yearA !== yearB) return yearA - yearB;\n      return monthA - monthB;\n    });\n\n    for (const key of keys) {\n      const days = this._workingDays[key];\n      if (!days || typeof days !== 'object' || Array.isArray(days)) continue;\n\n      // Struktur: {day: [elements]                              }\n      const dayEntries = Object.keys(days)\n        .map(d => parseInt(d))\n        .filter(d => !isNaN(d))\n        .sort((a, b) => a - b);\n\n      if (dayEntries.length > 0) {\n        // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n        // Beispiel: \"25:11:01a,02ab,03b\"\n        const formattedDays = dayEntries\n          .map(dayNum => {\n            const elements = days[dayNum];\n            const dayStr = this.formatTwoDigits(dayNum);\n            if (Array.isArray(elements) && elements.length > 0) {\n              // Sortiere die Kalender-Shortcuts alphabetisch (a, b, c, d, e) fr konsistente Reihenfolge\n              const sortedElements = [...elements].sort();\n              // Tag mit Elementen: \"01a\", \"02ab\", etc.\n              return dayStr + sortedElements.join('');\n            } else {\n              // Tag ohne Elemente\n              return dayStr;\n                }\n})\n          .join(',');\n        parts.push(`${key}:${formattedDays}`);\n                }\n                }\n    return parts.join(';');\n                }\n\n  async distributeDataToEntities(serializedData) {\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._debug('[Speichern] distributeDataToEntities: Kein hass, config oder entity vorhanden');\n      return;\n                }\n\n    this._debug(\n      `[Speichern] distributeDataToEntities: Start, Datenlnge: ${serializedData ? serializedData.length : 0} Zeichen`\n    );\n\n    // Setze Schreib-Lock\n    this._isWriting = true;\n    this._debug('[Speichern] distributeDataToEntities: Schreib-Lock gesetzt');\n\n    // Lsche vorhandenen Timer, falls vorhanden\n    if (this._writeLockTimer) {\n      clearTimeout(this._writeLockTimer);\n      this._writeLockTimer = null;\n                }\n\n    try {\n      // Verwende die gecachte Liste der Entities, falls verfgbar\n      // Prfe aber auch, ob neue Entities hinzugekommen sind\n      let allEntityIds;\n      if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n        // Verwende gecachte Liste\n        allEntityIds = [...this._knownEntityIds];\n\n        // Prfe ob neue Entities hinzugekommen sind\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds.length - 1; // -1 fr Haupt-Entity\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          // Neue Entities gefunden, aktualisiere die Liste\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n                }\n      } else {\n        // Keine gecachte Liste vorhanden, sammle Entities neu\n        allEntityIds = [this._config.entity];\n        const additionalEntities = this.findAdditionalEntities(this._config.entity);\n        allEntityIds.push(...additionalEntities);\n        this._knownEntityIds = [...allEntityIds];\n                }\n\n      this._debug(\n        `[Speichern] distributeDataToEntities: Verwende ${allEntityIds.length} Entities: ${allEntityIds.join(', ')}`\n      );\n\n      // Ermittle die maximale Lnge fr jede Entity\n      const maxLengths = {};\n      let totalMaxLength = 0;\n      for (const entityId of allEntityIds) {\n        const maxLength = this.getEntityMaxLength(entityId);\n        if (maxLength !== null) {\n          maxLengths[entityId] = maxLength;\n          totalMaxLength += maxLength;\n        } else {\n          // Wenn keine max-Lnge bekannt ist, verwende einen Standardwert (z.B. 255)\n          maxLengths[entityId] = 255;\n          totalMaxLength += 255;\n                }\n                }\n\n      // Debug: Zeige wie viele Zeichen wir schreiben wollen vs. knnen\n      const dataLength = serializedData ? serializedData.length : 0;\n      this._debug(\n        `[Speichern] distributeDataToEntities: Datenlnge: ${dataLength} Zeichen, verfgbarer Speicher: ${totalMaxLength} Zeichen`\n      );\n\n      // Wenn keine Daten vorhanden sind, setze alle Entities auf leer\n      if (!serializedData || serializedData.trim() === '') {\n        this._debug(\n          '[Speichern] distributeDataToEntities: Keine Daten vorhanden, setze alle Entities auf leer'\n        );\n        for (const entityId of allEntityIds) {\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: '',\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Entity \"${entityId}\" auf leer gesetzt`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Leeren von \"${entityId}\": ${error.message}`\n            );\n                }\n                }\n        // Setze Timer auch wenn keine Daten vorhanden waren\n        this._writeLockTimer = setTimeout(() => {\n          this._isWriting = false;\n          this._writeLockTimer = null;\n          this._debug(\n            '[Speichern] distributeDataToEntities: Schreib-Lock nach 5 Sekunden entfernt (keine Daten)'\n          );\n        }, 5000);\n        return;\n                }\n\n      // Verteile die Daten zeichenweise auf die Entities (umgekehrt zum Einlesen)\n      // Wir haben einen Datenstring ber alles und schreiben nur so viele Zeichen wie aufgenommen werden knnen\n      const entityValues = {};\n      let currentEntityIndex = 0;\n      let remainingData = serializedData;\n\n      // Verteile die Daten auf die verfgbaren Entities\n      while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n        const currentEntityId = allEntityIds[currentEntityIndex];\n        const maxLength = maxLengths[currentEntityId];\n\n        // Nimm so viele Zeichen wie mglich aus remainingData\n        const charsToTake = Math.min(remainingData.length, maxLength);\n        const valueToWrite = remainingData.substring(0, charsToTake);\n\n        entityValues[currentEntityId] = valueToWrite;\n        remainingData = remainingData.substring(charsToTake);\n\n        // Wenn noch Daten brig sind, wechsle zur nchsten Entity\n        if (remainingData.length > 0) {\n          currentEntityIndex++;\n                }\n                }\n\n      // Wenn am Ende noch Text ber ist, prfe ob zwischenzeitlich eine zustzliche Entitt angelegt wurde\n      if (remainingData.length > 0) {\n        // Prfe ob neue Entities hinzugekommen sind\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0; // -1 fr Haupt-Entity\n\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          // Neue Entities gefunden\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n\n          // Aktualisiere die Liste\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n\n          // Ermittle max-Lngen fr neue Entities\n          for (const newEntityId of newEntities) {\n            const maxLength = this.getEntityMaxLength(newEntityId);\n            if (maxLength !== null) {\n              maxLengths[newEntityId] = maxLength;\n            } else {\n              maxLengths[newEntityId] = 255;\n                }\n                }\n\n          // Verteile die verbleibenden Daten auf die neuen Entities\n          currentEntityIndex = allEntityIds.length - newEntities.length;\n          while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n            const currentEntityId = allEntityIds[currentEntityIndex];\n            const maxLength = maxLengths[currentEntityId];\n\n            const charsToTake = Math.min(remainingData.length, maxLength);\n            const valueToWrite = remainingData.substring(0, charsToTake);\n\n            entityValues[currentEntityId] = valueToWrite;\n            remainingData = remainingData.substring(charsToTake);\n\n            if (remainingData.length > 0) {\n              currentEntityIndex++;\n                }\n                }\n        } else {\n                }\n                }\n\n      // Schreibe die Werte in die Entities (sequenziell, um sicherzustellen, dass alle Calls abgeschlossen sind)\n      this._debug(\n        `[Speichern] distributeDataToEntities: Schreibe in ${allEntityIds.length} Entities`\n      );\n      for (const entityId of allEntityIds) {\n        const value = entityValues[entityId] || '';\n        const maxLength = maxLengths[entityId];\n\n        // Der Wert sollte nie die maximale Lnge berschreiten, da wir zeichenweise verteilen\n        if (value.length > maxLength) {\n          // Krze den Wert auf die maximale Lnge (als Notfall-Lsung)\n          const truncatedValue = value.substring(0, maxLength);\n          this._debug(\n            `[Speichern] distributeDataToEntities: Schreibe in \"${entityId}\" (gekrzt von ${value.length} auf ${truncatedValue.length} Zeichen)`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: truncatedValue,\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Erfolgreich in \"${entityId}\" geschrieben`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n            );\n                }\n        } else {\n          this._debug(\n            `[Speichern] distributeDataToEntities: Schreibe in \"${entityId}\" (${value.length} Zeichen)`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: value,\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Erfolgreich in \"${entityId}\" geschrieben`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n            );\n                }\n                }\n                }\n\n      // Leere alle zustzlichen Entities, die nicht verwendet wurden (um alte Daten zu entfernen)\n      // Wir mssen alle bekannten zustzlichen Entities prfen, nicht nur die in allEntityIds\n      const allAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n      this._debug(\n        `[Speichern] distributeDataToEntities: Prfe ${allAdditionalEntities.length} zustzliche Entities zum Leeren`\n      );\n      for (const additionalEntityId of allAdditionalEntities) {\n        // Wenn diese Entity nicht in entityValues ist, bedeutet das, dass sie nicht verwendet wurde\n        if (!(additionalEntityId in entityValues)) {\n          this._debug(\n            `[Speichern] distributeDataToEntities: Leere nicht verwendete Entity \"${additionalEntityId}\"`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: additionalEntityId,\n              value: '',\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Entity \"${additionalEntityId}\" erfolgreich geleert`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Leeren von \"${additionalEntityId}\": ${error.message}`\n            );\n                }\n                }\n                }\n\n      // Wenn noch Daten brig sind, die nicht gespeichert werden konnten\n      if (remainingData.length > 0) {\n        this._debug(\n          `[Speichern] distributeDataToEntities: WARNUNG - ${remainingData.length} Zeichen konnten nicht gespeichert werden!`\n        );\n                }\n    } catch (error) {\n      this._debug(\n        `[Speichern] distributeDataToEntities: Fehler beim Verteilen der Daten: ${error.message}`,\n        error\n      );\n    } finally {\n      // Schreib-Lock fr weitere 5 Sekunden aufrechterhalten (um sicherzustellen, dass alle Updates verarbeitet wurden)\n      this._writeLockTimer = setTimeout(() => {\n        this._isWriting = false;\n        this._writeLockTimer = null;\n        this._debug('[Speichern] distributeDataToEntities: Schreib-Lock nach 5 Sekunden entfernt');\n      }, 5000);\n      this._debug(\n        '[Speichern] distributeDataToEntities: Abgeschlossen, Schreib-Lock wird in 5 Sekunden entfernt'\n      );\n                }\n                }\n\n  async toggleDay(month, day, year = null) {\n    // Stelle sicher, dass month und day Zahlen sind\n    const monthNum = parseInt(month);\n    const dayNum = parseInt(day);\n\n    if (isNaN(monthNum) || isNaN(dayNum)) {\n      return;\n                }\n\n    // Prfe ob dieser Monat der Vormonat ist (schreibgeschtzt)\n    const now = new Date();\n    const currentMonth = now.getMonth() + 1; // 1-12\n    const currentYearFull = now.getFullYear();\n    const currentYear = currentYearFull % 100;\n\n    // Bestimme das Jahr (Kurzform, z.B. 25 fr 2025)\n    if (!year) {\n      year = currentYear;\n                }\n    const yearNum = parseInt(year);\n\n    let isPreviousMonth = false;\n    if (currentMonth === 1) {\n      // Aktuell ist Januar, Vormonat ist Dezember des Vorjahres\n      isPreviousMonth = monthNum === 12 && yearNum === (currentYearFull - 1) % 100;\n    } else {\n      // Vormonat ist aktueller Monat - 1 im gleichen Jahr\n      isPreviousMonth = monthNum === currentMonth - 1 && yearNum === currentYear;\n                }\n\n    if (isPreviousMonth) {\n      return;\n                }\n\n    // Prfe ob hass und config vorhanden sind\n    // Im Saver-Modus wird keine entity bentigt\n    if (!this._hass || !this._config) {\n      return;\n                }\n\n    // Bei text_entity Modus muss eine entity vorhanden sein\n    if (this._config.store_mode !== 'saver' && !this._config.entity) {\n      return;\n                }\n\n    // yearNum wurde bereits oben deklariert\n    const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n\n    // Stelle sicher, dass die Struktur ein Objekt ist (nicht Array)\n    if (!this._workingDays[key] || Array.isArray(this._workingDays[key])) {\n      this._workingDays[key] = {};\n                }\n\n    // Hole das ausgewhlte Kalender-Shortcut\n    const selectedCalendarShortcut = this._getSelectedCalendarShortcut();\n\n    if (!selectedCalendarShortcut) {\n      // Kein Kalender ausgewhlt - kann nicht togglen\n      return;\n                }\n\n    // Tag mit Kalender\n    if (!this._workingDays[key][dayNum]) {\n      this._workingDays[key][dayNum] = [];\n                }\n\n    // WICHTIG: Erstelle eine Kopie des Arrays, um sicherzustellen, dass wir mit dem richtigen Array arbeiten\n    const elements = [...(this._workingDays[key][dayNum] || [])];\n\n    const elementIndex = elements.indexOf(selectedCalendarShortcut);\n\n    // MARKIERE BUTTON ALS \"WIRD DIREKT AKTUALISIERT\" BEVOR _workingDays GENDERT WIRD\n    // Dies verhindert, dass Lit ein Update auslst, whrend wir direkt manipulieren\n    const buttonKey = `${yearNum}:${monthNum}:${dayNum}`;\n    this._directDOMUpdateInProgress.add(buttonKey);\n\n    let finalElements = [];\n\n    if (elementIndex > -1) {\n      // Kalender entfernen\n      elements.splice(elementIndex, 1);\n      // Speichere die finalen Elemente BEVOR wir mglicherweise den Monat lschen\n      finalElements = elements;\n      // Wenn keine Kalender mehr vorhanden sind, entferne den Tag\n      if (elements.length === 0) {\n        delete this._workingDays[key][dayNum];\n        // Wenn keine Tage mehr vorhanden sind, entferne den Monat\n        if (Object.keys(this._workingDays[key]).length === 0) {\n          delete this._workingDays[key];\n                }\n      } else {\n        // Aktualisiere das Array im _workingDays\n        this._workingDays[key][dayNum] = elements;\n                }\n    } else {\n      // Kalender hinzufgen (nur wenn noch nicht vorhanden)\n      if (!elements.includes(selectedCalendarShortcut)) {\n        elements.push(selectedCalendarShortcut);\n        // Aktualisiere das Array im _workingDays\n        this._workingDays[key][dayNum] = elements;\n                }\n      // Speichere die finalen Elemente\n      finalElements =\n        this._workingDays[key] && this._workingDays[key][dayNum]\n          ? this._workingDays[key][dayNum]\n          : elements;\n                }\n\n    // OPTIMIERUNG: Direkte DOM-Manipulation statt komplettes Re-Rendering\n    // Verwende die finalen elements (bereits vor dem mglichen Lschen gespeichert)\n    this._updateDayButtonDirectly(monthNum, dayNum, yearNum, key, finalElements);\n\n    // OPTIMIERUNG: Debounced Speichern - warte nach dem letzten Klick, bevor gespeichert wird\n    this._debug(`[Sync] toggleDay: Tag gendert (${yearNum}:${monthNum}:${dayNum}), plane Speichern fr Synchronisation`);\n    this._scheduleDebouncedSave();\n                }\n\n  // Plant ein debounced Speichern der Daten\n  _scheduleDebouncedSave() {\n    // Lese Debounce-Zeit aus der Config (Standard: 300ms)\n    const debounceTime = this._getSaveDebounceTime();\n\n    // Wenn Debounce-Zeit 0 ist, speichere sofort\n    if (debounceTime === 0) {\n      this._debug('[Sync] _scheduleDebouncedSave: Speichere sofort (Debounce=0)');\n      this._saveToHA();\n      return;\n                }\n\n    // Lsche vorhandenen Timer\n    if (this._saveDebounceTimer) {\n      this._debug(`[Sync] _scheduleDebouncedSave: Timer bereits vorhanden, setze neu (${debounceTime}ms)`);\n      clearTimeout(this._saveDebounceTimer);\n      this._saveDebounceTimer = null;\n                } else {\n      this._debug(`[Sync] _scheduleDebouncedSave: Neuer Timer gesetzt (${debounceTime}ms)`);\n                }\n\n    // Setze neuen Timer\n    this._saveDebounceTimer = setTimeout(() => {\n      this._saveDebounceTimer = null;\n      this._debug('[Sync] _scheduleDebouncedSave: Timer abgelaufen, speichere jetzt');\n      this._saveToHA();\n    }, debounceTime);\n                }\n\n  // Speichert die Daten asynchron in Home Assistant\n  async _saveToHA() {\n    try {\n      this._debug('[Speichern] _saveToHA: Start');\n      \n      // Stelle sicher, dass Storage initialisiert ist\n      if (!this._storage) {\n        this._initializeStorage();\n                }\n\n      if (!this._storage) {\n        this._debug('[Speichern] _saveToHA: Kein Storage-Adapter verfgbar');\n        return;\n                }\n\n      const serializedData = this.serializeWorkingDays();\n      this._debug(\n        `[Speichern] _saveToHA: Daten serialisiert, Lnge: ${serializedData.length} Zeichen, store_mode: \"${this._config.store_mode}\"`\n      );\n\n      // Setze Schreib-Lock\n      this._isWriting = true;\n      if (this._writeLockTimer) {\n        clearTimeout(this._writeLockTimer);\n                }\n\n      try {\n        // Verwende Storage-Adapter zum Speichern\n        await this._storage.saveData(serializedData);\n        \n        // Prfe Speicherverbrauch (nur fr EntityStorage relevant)\n        const storageUsage = this._storage.checkStorageUsage(serializedData.length);\n        if (storageUsage) {\n          this._storageWarning = storageUsage;\n          this._updateStorageWarningDirectly();\n        } else {\n          this._storageWarning = null;\n          this._updateStorageWarningDirectly();\n                }\n\n        this._debug('[Speichern] _saveToHA: Erfolgreich abgeschlossen');\n      } catch (error) {\n        // Fehler beim Speichern - versuche Fallback\n        this._debug(`[Speichern] _saveToHA: Fehler beim Speichern, versuche Fallback: ${error.message}`, error);\n        \n        // Fallback: Wenn SaverStorage fehlschlgt, versuche EntityStorage\n        if (this._config.store_mode === 'saver') {\n          this._debug('[Speichern] _saveToHA: Fallback zu EntityStorage');\n          const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n          await fallbackStorage.saveData(serializedData);\n        } else {\n          throw error; // Bei EntityStorage gibt es keinen Fallback\n                }\n      } finally {\n        // Setze Timer fr Schreib-Lock (5 Sekunden)\n        this._writeLockTimer = setTimeout(() => {\n          this._isWriting = false;\n          this._writeLockTimer = null;\n          this._debug('[Speichern] _saveToHA: Schreib-Lock entfernt');\n        }, 5000);\n                }\n    } catch (error) {\n      this._debug(`[Speichern] _saveToHA: Fehler beim Speichern: ${error.message}`, error);\n      console.error('[TG Schichtplan] Fehler beim Speichern:', error);\n      // Optional: Hier knnte man eine Fehlermeldung anzeigen\n                }\n                }\n\n  // Speichert Daten in den Saver\n  async _saveDataToSaver(serializedData) {\n    if (!this._hass || !this._config || !this._config.saver_key) {\n      this._debug('[Speichern] _saveDataToSaver: Kein hass, config oder saver_key vorhanden');\n      return;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    this._debug(\n      `[Speichern] _saveDataToSaver: Start, saver_key: \"${saverKey}\", Datenlnge: ${serializedData.length} Zeichen`\n    );\n\n    try {\n      // Prfe ob die Saver-Variable existiert und ob sich der Wert gendert hat\n      // Saver-Variablen sind in saver.saver.attributes.variables gespeichert\n      const saverEntity = this._hass?.states?.['saver.saver'];\n      let oldValue = '';\n\n      if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n        const existingValue = saverEntity.attributes.variables[saverKey];\n        if (existingValue !== undefined && existingValue !== null) {\n          oldValue = String(existingValue).trim();\n                }\n                }\n\n      this._debug(\n        `[Speichern] _saveDataToSaver: Saver-Variable \"${saverKey}\" existiert: ${oldValue !== ''}, alte Lnge: ${oldValue.length} Zeichen`\n      );\n\n      // Nur schreiben wenn Variable nicht existiert oder Wert sich gendert hat\n      if (oldValue === '' || oldValue !== serializedData) {\n        this._debug(\n          `[Speichern] _saveDataToSaver: Schreibe in Saver (Variable existiert nicht oder Wert hat sich gendert)`\n        );\n        await this._hass.callService('saver', 'set_variable', {\n          name: saverKey,\n          value: serializedData || '',\n        });\n        this._debug(`[Speichern] _saveDataToSaver: Erfolgreich in Saver geschrieben`);\n      } else {\n        this._debug(\n          `[Speichern] _saveDataToSaver: Kein Schreiben ntig, Wert hat sich nicht gendert`\n        );\n                }\n    } catch (error) {\n      // Fehler beim Schreiben in Saver - Fallback zu Entities\n      this._debug(\n        `[Speichern] _saveDataToSaver: Fehler beim Schreiben in Saver, Fallback zu Entities: ${error.message}`,\n        error\n      );\n      console.warn('[TG Schichtplan] Fehler beim Schreiben in Saver, Fallback zu Entities:', error);\n      await this.distributeDataToEntities(serializedData);\n                }\n                }\n\n  // Liest die Debounce-Zeit aus der Config\n  _getSaveDebounceTime() {\n    // Versuche aus Config zu lesen\n    if (this._config && typeof this._config.saveDebounceTime === 'number') {\n      return Math.max(0, this._config.saveDebounceTime); // Mindestens 0\n                }\n\n    // Fallback: Verwende Standard-Wert aus card-config.js\n    return SaveDebounceTime || 300; // Standard: 300ms\n                }\n\n  // Aktualisiert einen einzelnen Button direkt im DOM ohne komplettes Re-Rendering\n  _updateDayButtonDirectly(monthNum, dayNum, yearNum, key, dayElements) {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    // Button sollte bereits in _directDOMUpdateInProgress sein (wurde in toggleDay gesetzt)\n    // Falls nicht, fge ihn hinzu (Fallback fr direkte Aufrufe)\n    const buttonKey = `${yearNum}:${monthNum}:${dayNum}`;\n    if (!this._directDOMUpdateInProgress.has(buttonKey)) {\n      this._directDOMUpdateInProgress.add(buttonKey);\n                }\n\n    // Finde den Button im DOM\n    const button = this.shadowRoot.querySelector(\n      `button[data-month=\"${monthNum}\"][data-day=\"${dayNum}\"][data-year=\"${yearNum}\"]`\n    );\n\n    if (!button) {\n      // Button nicht gefunden, Fallback zu requestUpdate\n      this._directDOMUpdateInProgress.delete(buttonKey);\n      this.requestUpdate();\n      return;\n                }\n\n    // Berechne die neuen Werte fr diesen Button\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n\n    // Finde die erste aktivierte Schicht\n    let firstActiveShift = null;\n    const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n    for (const shortcut of shiftOrder) {\n      if (dayElements.includes(shortcut)) {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled) {\n          firstActiveShift = shortcut;\n          break;\n                }\n                }\n                }\n\n    // Bestimme welche Schicht den Tag frben soll\n    let activeShiftForColor = null;\n    if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n      activeShiftForColor = selectedShortcut;\n    } else if (firstActiveShift) {\n      activeShiftForColor = firstActiveShift;\n                }\n\n    const isWorking = activeShiftForColor !== null;\n\n    // Aktualisiere CSS-Klasse\n    if (isWorking) {\n      button.classList.add('working');\n    } else {\n      button.classList.remove('working');\n                }\n\n    // Aktualisiere Hintergrundfarbe\n    if (activeShiftForColor) {\n      const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n      if (activeCalendar && activeCalendar.color) {\n        button.style.backgroundColor = activeCalendar.color;\n      } else {\n        button.style.backgroundColor = '';\n                }\n    } else {\n      button.style.backgroundColor = '';\n                }\n\n    // Aktualisiere Shift-Indikatoren\n    // Entferne zuerst alle vorhandenen Container und Indikatoren\n    const existingContainer = button.querySelector('.shifts-container');\n    if (existingContainer) {\n      existingContainer.remove();\n                }\n\n    // Erstelle neue Indikatoren fr alle Schichten auer der, die den Tag frbt\n    const shiftIndicators = dayElements\n      .filter(shortcut => shortcut !== activeShiftForColor)\n      .map(shortcut => {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled && calendar.color) {\n          const indicator = document.createElement('span');\n          indicator.className = 'shift-indicator';\n          indicator.style.backgroundColor = calendar.color;\n          indicator.title = calendar.name || `Schicht ${shortcut.toUpperCase()}`;\n          return indicator;\n                }\n        return null;\n      })\n      .filter(indicator => indicator !== null);\n\n    // Fge Indikatoren nur hinzu, wenn welche vorhanden sind\n    if (shiftIndicators.length > 0) {\n      const container = document.createElement('div');\n      container.className = 'shifts-container';\n      // Markiere Container als manuell erstellt, damit das Template sie nicht berschreibt\n      container.setAttribute('data-manual-update', 'true');\n      shiftIndicators.forEach(ind => container.appendChild(ind));\n      button.appendChild(container);\n                }\n\n    // Entferne Markierung nach Abschluss der direkten DOM-Manipulation\n    // Verzgert, damit Lit-Updates, die durch _workingDays-nderung ausgelst werden, bersprungen werden knnen\n    setTimeout(() => {\n      this._directDOMUpdateInProgress.delete(buttonKey);\n    }, 100); // Lnger warten, damit Lit-Updates abgeschlossen sind\n                }\n\n  getDaysInMonth(year, month) {\n    return new Date(year, month + 1, 0).getDate();\n                }\n\n  getFirstDayOfMonth(year, month) {\n    return new Date(year, month, 1).getDay();\n                }\n\n  getWeekNumber(date) {\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n    const dayNum = d.getUTCDay() || 7;\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n    return Math.ceil(((d - yearStart) / 86400000 + 1) / 7);\n                }\n\n  getMonthName(month) {\n    const months = [\n      'Januar',\n      'Februar',\n      'Mrz',\n      'April',\n      'Mai',\n      'Juni',\n      'Juli',\n      'August',\n      'September',\n      'Oktober',\n      'November',\n      'Dezember',\n    ];\n    return months[month];\n                }\n\n  /**\n   * Rendert einen einzelnen Tag-Button fr den Kalender\n   * @param {number} currentDay - Der Tag (1-31)\n   * @param {number} monthKey - Der Monat (1-12)\n   * @param {number} yearKey - Das Jahr in Kurzform (z.B. 25 fr 2025)\n   * @param {string} key - Der Schlssel fr diesen Monat (z.B. \"25:11\")\n   * @param {number[]} workingDays - Array der Arbeitstage fr diesen Monat\n   * @param {boolean} isPreviousMonth - Ob dieser Monat der Vormonat ist (schreibgeschtzt)\n   * @param {number} year - Das vollstndige Jahr\n   * @param {number} month - Der Monat (0-11)\n   * @returns {TemplateResult} HTML-Template fr den Tag-Button\n   */\n  renderDay(currentDay, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month) {\n    const now = new Date();\n    const today = now.getDate();\n    const currentMonth = now.getMonth();\n    const currentYear = now.getFullYear();\n\n    const dayElements = this._getDayElements(key, currentDay);\n    const isToday = year === currentYear && month === currentMonth && currentDay === today;\n\n    // Prfe ob der ausgewhlte Kalender an diesem Tag aktiv ist\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n    let buttonStyle = '';\n\n    // Finde die erste aktivierte Schicht (in der Reihenfolge a, b, c, d, e)\n    // die an diesem Tag aktiv ist\n    let firstActiveShift = null;\n    const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n    for (const shortcut of shiftOrder) {\n      if (dayElements.includes(shortcut)) {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled) {\n          firstActiveShift = shortcut;\n          break;\n                }\n                }\n                }\n\n    // Bestimme welche Schicht den Tag frben soll\n    let activeShiftForColor = null;\n    if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n      // Wenn der ausgewhlte Kalender aktiv ist, verwende diesen\n      activeShiftForColor = selectedShortcut;\n    } else if (firstActiveShift) {\n      // Ansonsten verwende die erste aktivierte Schicht\n      activeShiftForColor = firstActiveShift;\n                }\n\n    // isWorking ist true, wenn eine Schicht den Tag frbt\n    const isWorking = activeShiftForColor !== null;\n\n    // Verwende die Farbe der aktiven Schicht\n    if (activeShiftForColor) {\n      const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n      if (activeCalendar && activeCalendar.color) {\n        buttonStyle = `background-color: ${activeCalendar.color};`;\n                }\n                }\n\n    // Prfe ob es ein Wochenende oder Feiertag ist\n    const isWeekend = this._isWeekend(year, month, currentDay);\n    const isHoliday = this._isHoliday(year, month, currentDay);\n\n    // Erstelle visuelle Darstellung der Kalender (alle auer der Schicht, die den Tag frbt)\n    // Nur aktivierte Kalender werden angezeigt\n    const shiftIndicators = dayElements\n      .filter(shortcut => shortcut !== activeShiftForColor) // Filtere die Schicht heraus, die den Tag frbt\n      .map(shortcut => {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        // Nur anzeigen, wenn der Kalender aktiviert ist\n        if (calendar && calendar.enabled && calendar.color) {\n          return html`\n            <span\n              class=\"shift-indicator\"\n              style=\"background-color: ${calendar.color};\"\n              title=\"${calendar.name || `Schicht ${shortcut.toUpperCase()}`}\"\n            >\n            </span>\n          `;\n                }\n        return null; // Nicht anzeigen, wenn Kalender deaktiviert ist\n      })\n      .filter(indicator => indicator !== null); // Entferne null-Werte\n\n    return html`\n      <td>\n        <button\n          class=\"day-button ${isWorking ? 'working' : ''} ${isToday\n            ? 'today'\n            : ''} ${isPreviousMonth ? 'readonly' : ''} ${isWeekend ? 'weekend' : ''} ${isHoliday\n            ? 'holiday'\n            : ''}\"\n          style=\"${buttonStyle}\"\n          @click=${e => {\n            if (!isPreviousMonth) {\n              this.toggleDay(monthKey, currentDay, yearKey);\n              // Entferne Fokus nach Klick (wichtig fr mobile Gerte)\n              // Setze Fokus explizit auf die Karte selbst\n              setTimeout(() => {\n                e.target.blur();\n                // Setze Fokus auf das Hauptcontainer-Element der Karte\n                if (this.shadowRoot) {\n                  const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n                  if (wrapper) {\n                    // Stelle sicher, dass das Element fokussierbar ist\n                    if (!wrapper.hasAttribute('tabindex')) {\n                      wrapper.setAttribute('tabindex', '-1');\n                }\n          wrapper.focus();\n                  } else {\n                    // Fallback: Setze Fokus auf die Komponente selbst\n                    if (this.focus) {\n                      this.focus();\n                }\n                }\n                }\n    }, 0);\n                }\n}                              }\n          ?disabled=${isPreviousMonth                              }\n          data-month=\"${monthKey}\"\n          data-day=\"${currentDay}\"\n          data-year=\"${yearKey}\"\n        >\n          <span class=\"day-number\">${currentDay}</span>\n          ${(() => {\n            // Prfe ob dieser Button bereits manuell aktualisiert wurde\n            // Wenn ja, rendere keine Indikatoren (werden per direkter DOM-Manipulation verwaltet)\n            const buttonKey = `${yearKey}:${monthKey}:${currentDay}`;\n            if (this._directDOMUpdateInProgress && this._directDOMUpdateInProgress.has(buttonKey)) {\n              return '';\n                }\n  // Prfe auch, ob im DOM bereits ein manuell erstellter Container existiert\n            if (this.shadowRoot) {\n              const existingButton = this.shadowRoot.querySelector(\n                `button[data-month=\"${monthKey}\"][data-day=\"${currentDay}\"][data-year=\"${yearKey}\"]`\n              );\n              if (\n                existingButton &&\n                existingButton.querySelector('.shifts-container[data-manual-update=\"true\"]')\n              ) {\n                return '';\n                }\n                }\n            return shiftIndicators.length > 0\n              ? html`<div class=\"shifts-container\">${shiftIndicators}</div>`\n              : '';\n          })()                              }\n        </button>\n      </td>\n    `;\n                }\n\n  renderMonth(year, month) {\n    const daysInMonth = this.getDaysInMonth(year, month);\n    const firstDay = this.getFirstDayOfMonth(year, month);\n    const firstDayMonday = (firstDay + 6) % 7;\n\n    const monthKey = month + 1;\n    const yearKey = year % 100; // Kurzform, z.B. 25 fr 2025\n    const key = `${this.formatTwoDigits(yearKey)}:${this.formatTwoDigits(monthKey)}`;\n\n    // Hole alle Tage fr diesen Monat (neue Struktur: {day: [elements]})\n    let workingDays = [];\n    if (this._workingDays[key]) {\n      if (Array.isArray(this._workingDays[key])) {\n        // Kompatibilitt: Altes Format [days]\n        workingDays = this._workingDays[key].map(d => parseInt(d)).filter(d => !isNaN(d));\n      } else if (typeof this._workingDays[key] === 'object') {\n        // Neue Struktur: {day: [elements]                              }\n        workingDays = Object.keys(this._workingDays[key])\n          .map(d => parseInt(d))\n          .filter(d => !isNaN(d));\n                }\n                }\n\n    const now = new Date();\n    const today = now.getDate();\n    const currentMonth = now.getMonth();\n    const currentYear = now.getFullYear();\n\n    // Prfe ob dieser Monat der Vormonat ist (schreibgeschtzt)\n    let isPreviousMonth = false;\n    if (currentMonth === 0) {\n      // Aktuell ist Januar, Vormonat ist Dezember des Vorjahres\n      isPreviousMonth = month === 11 && year === currentYear - 1;\n    } else {\n      // Vormonat ist aktueller Monat - 1 im gleichen Jahr\n      isPreviousMonth = month === currentMonth - 1 && year === currentYear;\n                }\n\n    const rows = [];\n    let day = 1;\n\n    // Erste Woche\n    const firstDate = new Date(year, month, 1);\n    const weekNumber = this.getWeekNumber(firstDate);\n    const firstRowCells = [html`<td class=\"week-label\">${weekNumber}</td>`];\n\n    for (let i = 0; i < firstDayMonday; i++) {\n      firstRowCells.push(html`<td></td>`);\n                }\n\n    for (let i = firstDayMonday; i < 7 && day <= daysInMonth; i++) {\n      firstRowCells.push(\n        this.renderDay(day, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month)\n      );\n      day++;\n                }\n    rows.push(\n      html`<tr>\n        ${firstRowCells                              }\n      </tr>`\n    );\n\n    // Weitere Wochen\n    while (day <= daysInMonth) {\n      const date = new Date(year, month, day);\n      const weekNum = this.getWeekNumber(date);\n      const rowCells = [html`<td class=\"week-label\">${weekNum}</td>`];\n\n      // Rendere immer 7 Zellen pro Woche (Tage oder leere Zellen)\n      for (let i = 0; i < 7; i++) {\n        if (day <= daysInMonth) {\n          rowCells.push(\n            this.renderDay(day, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month)\n          );\n          day++;\n        } else {\n          // Leere Zelle am Ende der letzten Woche\n          rowCells.push(html`<td></td>`);\n                }\n                }\n      rows.push(\n        html`<tr>\n          ${rowCells                              }\n        </tr>`\n      );\n                }\n\n    return html`\n      <div class=\"month-container\">\n        <div class=\"month-header\">${this.getMonthName(month)} ${year}</div>\n        <table class=\"calendar-table\">\n          <thead>\n            <tr>\n              <th class=\"week-label\">KW</th>\n              <th>Mo</th>\n              <th>Di</th>\n              <th>Mi</th>\n              <th>Do</th>\n              <th>Fr</th>\n              <th>Sa</th>\n              <th>So</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows                              }\n          </tbody>\n        </table>\n      </div>\n    `;\n                }\n\n  changeDisplayedMonths(delta) {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const newValue = Math.max(1, Math.min(maxMonths, (this._displayedMonths || 2) + delta));\n    if (newValue !== this._displayedMonths) {\n      this._displayedMonths = newValue;\n      this.requestUpdate();\n                }\n                }\n\n  changeStartMonth(delta) {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const currentOffset = this._startMonthOffset || 0;\n\n    // Berechne die Grenzen fr die Navigation\n    // Minimum: -1 (Vormonat)\n    // Maximum: maxMonths - displayedMonths (damit der letzte angezeigte Monat nicht ber maxMonths hinausgeht)\n    const minOffset = -1;\n    const maxOffset = maxMonths - displayedMonths;\n\n    const newOffset = Math.max(minOffset, Math.min(maxOffset, currentOffset + delta));\n\n    if (newOffset !== currentOffset) {\n      this._startMonthOffset = newOffset;\n      this.requestUpdate();\n                }\n                }\n\n  getNavigationBounds() {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const currentOffset = this._startMonthOffset || 0;\n\n    const minOffset = -1;\n    const maxOffset = maxMonths - displayedMonths;\n\n    return {\n      canGoBack: currentOffset > minOffset,\n      canGoForward: currentOffset < maxOffset,\n    };\n                }\n\n  _getSelectedCalendarShortcut() {\n    // Gibt den Shortcut des ausgewhlten Kalenders zurck\n\n    // Prfe zuerst _selectedCalendar\n    if (\n      this._selectedCalendar !== null &&\n      this._selectedCalendar !== undefined &&\n      this._selectedCalendar !== ''\n    ) {\n      return this._selectedCalendar;\n                }\n\n    // Falls _selectedCalendar nicht gesetzt ist, prfe die Config\n    if (this._config?.selectedCalendar) {\n      this._selectedCalendar = this._config.selectedCalendar;\n      return this._selectedCalendar;\n                }\n\n    // Fallback: Verwende den ersten aktivierten Kalender\n    const allCalendars = this._getAllCalendars();\n    if (allCalendars.length > 0) {\n      return allCalendars[0].shortcut;\n                }\n    // Wenn kein Kalender aktiviert ist, gibt es keinen Fallback\n    return null;\n                }\n\n  _getCalendarByShortcut(shortcut) {\n    // Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n    if (!this._config?.calendars) {\n      return null;\n                }\n\n    return this._config.calendars.find(cal => cal.shortcut === shortcut) || null;\n                }\n\n  _getDefaultColorForShortcut(shortcut) {\n    // Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n    const defaultCalendar = ShiftScheduleView.CALENDARS.find(cal => cal.shortcut === shortcut);\n    return defaultCalendar ? defaultCalendar.defaultColor : '#ff9800';\n                }\n\n  _getAllCalendars() {\n    // Gibt nur aktivierte Kalender zurck\n    if (!this._config?.calendars) {\n      return [];\n                }\n\n    // Filtere nur aktivierte Kalender und sortiere nach Shortcut (a, b, c, d, e)\n    return this._config.calendars\n      .filter(\n        cal =>\n          cal &&\n          cal.shortcut &&\n          (cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1)\n      )\n      .sort((a, b) => a.shortcut.localeCompare(b.shortcut));\n                }\n\n  _getSelectedCalendarValue() {\n    const allCalendars = this._getAllCalendars();\n\n    if (allCalendars.length === 0) {\n      // Wenn keine Kalender aktiviert sind, gibt es keinen ausgewhlten Kalender\n      if (this._selectedCalendar !== null) {\n        this._selectedCalendar = null;\n        if (this._config) {\n          this._config.selectedCalendar = null;\n                }\n        this.requestUpdate();\n                }\n      return null;\n                }\n\n    // Wenn _selectedCalendar noch nicht gesetzt ist, setze es auf den ersten aktivierten Kalender\n    if (this._selectedCalendar === null || this._selectedCalendar === undefined) {\n      this._selectedCalendar = allCalendars[0].shortcut;\n      // Speichere es auch in der Config\n      if (this._config) {\n        this._config.selectedCalendar = this._selectedCalendar;\n                }\n      // Aktualisiere die Ansicht\n      this.requestUpdate();\n      return this._selectedCalendar;\n                }\n\n    // Prfe ob der ausgewhlte Kalender aktiviert ist\n    const exists = allCalendars.some(cal => cal.shortcut === this._selectedCalendar);\n    if (!exists) {\n      // Wenn der ausgewhlte Kalender nicht aktiviert ist, verwende den ersten aktivierten\n      this._selectedCalendar = allCalendars[0].shortcut;\n      if (this._config) {\n        this._config.selectedCalendar = this._selectedCalendar;\n                }\n      this.requestUpdate();\n      return this._selectedCalendar;\n                }\n\n    return this._selectedCalendar;\n                }\n\n  _onCalendarSelectedByIndex(shortcut) {\n    if (shortcut !== '' && shortcut !== null && shortcut !== undefined) {\n      this._selectedCalendar = shortcut;\n\n      // Aktualisiere die Config mit der neuen Auswahl\n      if (this._config) {\n        this._config = {\n          ...this._config,\n          selectedCalendar: shortcut,\n        };\n\n        // Dispatch config-changed Event, damit die Card die Config aktualisiert\n        // (nur wenn nicht initialer Load)\n        if (!this._isInitialLoad) {\n          this.dispatchEvent(\n            new CustomEvent('config-changed', {\n              detail: { config: this._config },\n              bubbles: true,\n              composed: true,\n            })\n          );\n          // Speichere die Config in die Entity (nur bei Benutzeraktionen)\n          this.saveConfigToEntity();\n                }\n                }\n\n      // Aktualisiere alle Buttons, die die neue aktive Schicht haben\n      // Dies ist notwendig, um die Hintergrundfarben und Indikatoren korrekt zu aktualisieren\n      // (z.B. wenn Tag 2 die Schicht \"a\" hat und wir zu \"a\" wechseln, sollte Tag 2 orange werden)\n      // ABER: Nur wenn es sich nicht um den initialen Load handelt UND die Daten bereits geladen sind\n      // Beim initialen Load werden die Buttons bereits korrekt durch Lit gerendert\n      if (\n        !this._isInitialLoad &&\n        this.shadowRoot &&\n        this._workingDays &&\n        Object.keys(this._workingDays).length > 0\n      ) {\n        // Verwende setTimeout, um sicherzustellen, dass _selectedCalendar bereits aktualisiert wurde\n        setTimeout(() => {\n          this._updateAllDayButtonsForCalendarChange();\n        }, 0);\n                }\n                }\n                }\n\n  // Aktualisiert alle Tag-Buttons nach Kalender-Auswahl (nur Farben/Klassen, kein komplettes Re-Rendering)\n  _updateAllDayButtonsForCalendarChange() {\n    if (!this.shadowRoot) return;\n\n    const buttons = this.shadowRoot.querySelectorAll('button.day-button');\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n\n    buttons.forEach(button => {\n      const monthKey = button.getAttribute('data-month');\n      const dayNum = parseInt(button.getAttribute('data-day'));\n      const yearKey = button.getAttribute('data-year');\n\n      if (!monthKey || !dayNum || !yearKey) return;\n\n      // Formatiere den Key mit formatTwoDigits, damit er mit den gespeicherten Daten bereinstimmt\n      const key = `${this.formatTwoDigits(parseInt(yearKey))}:${this.formatTwoDigits(parseInt(monthKey))}`;\n      const dayElements = this._getDayElements(key, dayNum);\n      const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n\n      // Finde die erste aktivierte Schicht\n      let firstActiveShift = null;\n      const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n      for (const shortcut of shiftOrder) {\n        if (dayElements.includes(shortcut)) {\n          const calendar = this._getCalendarByShortcut(shortcut);\n          if (calendar && calendar.enabled) {\n            firstActiveShift = shortcut;\n            break;\n                }\n                }\n                }\n\n      // Bestimme welche Schicht den Tag frben soll\n      let activeShiftForColor = null;\n      if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n        activeShiftForColor = selectedShortcut;\n      } else if (firstActiveShift) {\n        activeShiftForColor = firstActiveShift;\n                }\n\n      const isWorking = activeShiftForColor !== null;\n\n      // Aktualisiere CSS-Klasse\n      if (isWorking) {\n        button.classList.add('working');\n      } else {\n        button.classList.remove('working');\n                }\n\n      // Aktualisiere Hintergrundfarbe\n      if (activeShiftForColor) {\n        const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n        if (activeCalendar && activeCalendar.color) {\n          button.style.backgroundColor = activeCalendar.color;\n        } else {\n          button.style.backgroundColor = '';\n                }\n      } else {\n        button.style.backgroundColor = '';\n                }\n\n      // Aktualisiere Shift-Indikatoren (hnlich wie in _updateDayButtonDirectly)\n      // Entferne zuerst alle vorhandenen Container und Indikatoren\n      const existingContainer = button.querySelector('.shifts-container');\n      if (existingContainer) {\n        existingContainer.remove();\n                }\n\n      const shiftIndicators = dayElements\n        .filter(shortcut => shortcut !== activeShiftForColor)\n        .map(shortcut => {\n          const calendar = this._getCalendarByShortcut(shortcut);\n          if (calendar && calendar.enabled && calendar.color) {\n            const indicator = document.createElement('span');\n            indicator.className = 'shift-indicator';\n            indicator.style.backgroundColor = calendar.color;\n            indicator.title = calendar.name || `Schicht ${shortcut.toUpperCase()}`;\n            return indicator;\n                }\nreturn null;\n        })\n        .filter(indicator => indicator !== null);\n\n      // Fge Indikatoren nur hinzu, wenn welche vorhanden sind\n      if (shiftIndicators.length > 0) {\n        const container = document.createElement('div');\n        container.className = 'shifts-container';\n        // Markiere Container als manuell erstellt, damit das Template sie nicht berschreibt\n        container.setAttribute('data-manual-update', 'true');\n        shiftIndicators.forEach(ind => container.appendChild(ind));\n        button.appendChild(container);\n                }\n      // Wenn keine Indikatoren vorhanden sind, wurde der Container bereits oben entfernt\n    });\n                }\n\n  // Aktualisiert die Storage-Warnung direkt im DOM ohne Re-Rendering\n  _updateStorageWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasStorageWarning = this._storageWarning && this._storageWarning.show;\n\n    // Aktualisiere CSS-Klasse\n    if (hasStorageWarning) {\n      wrapper.classList.add('storage-warning-active');\n    } else {\n      wrapper.classList.remove('storage-warning-active');\n                }\n\n    // Finde oder erstelle Storage-Warnung\n    let storageWarningEl = wrapper.querySelector('.storage-warning[data-warning-type=\"storage\"]');\n\n    if (hasStorageWarning) {\n      if (!storageWarningEl) {\n        // Erstelle neue Warnung\n        storageWarningEl = document.createElement('div');\n        storageWarningEl.className = 'storage-warning';\n        storageWarningEl.setAttribute('data-warning-type', 'storage');\n        wrapper.insertBefore(storageWarningEl, wrapper.firstChild);\n                }\n\n      // Aktualisiere Inhalt\n      const additionalEntities = this.findAdditionalEntities(this._config.entity);\n      const nextEntitySuffix = String(additionalEntities.length + 1).padStart(3, '0');\n      storageWarningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Speicherplatz fast voll!</div>\n          <div class=\"warning-message\">\n            ${this._storageWarning.percentage}% der verfgbaren Speicherkapazitt verwendet\n            (${this._storageWarning.currentLength} / ${this._storageWarning.maxLength} Zeichen).\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie ein zustzliches Input-Text-Feld an (z.B. ${this._config.entity}_${nextEntitySuffix}).\n          </div>\n        </div>\n      `;\n    } else if (storageWarningEl) {\n      // Entferne Warnung wenn nicht mehr ntig\n      storageWarningEl.remove();\n                }\n                }\n\n  // Aktualisiert die Config-Warnung direkt im DOM ohne Re-Rendering\n  _updateConfigWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasConfigWarning =\n      this._configWarning &&\n      this._configWarning.show &&\n      (this._configWarning.type === 'size' ||\n        (this._configWarning.type === 'missing' && isEditorMode));\n\n    // Finde alle Config-Warnungen (size und missing)\n    const configWarningSize = wrapper.querySelector(\n      '.storage-warning[data-warning-type=\"config-size\"]'\n    );\n    const configWarningMissing = wrapper.querySelector(\n      '.storage-warning[data-warning-type=\"config-missing\"]'\n    );\n\n    if (hasConfigWarning && this._configWarning.type === 'size') {\n      // Size-Warnung anzeigen/aktualisieren\n      let warningEl = configWarningSize;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'config-size');\n        // Fge nach Storage-Warnung ein, falls vorhanden\n        const storageWarning = wrapper.querySelector(\n          '.storage-warning[data-warning-type=\"storage\"]'\n        );\n        if (storageWarning) {\n          storageWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Konfigurations-Entity zu klein!</div>\n          <div class=\"warning-message\">\n            Die Konfiguration passt nicht in die Entity <code>${this._configWarning.configEntityId}</code>.\n            ${this._configWarning.percentage}% der verfgbaren Speicherkapazitt bentigt\n            (${this._configWarning.currentLength} / ${this._configWarning.maxLength} Zeichen).\n          </div>\n          <div class=\"warning-action\">\n            Bitte erhhen Sie die maximale Lnge der Entity ber die UI:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Entity <code>${this._configWarning.configEntityId.replace('input_text.', '')}</code> bearbeiten</li>\n              <li>Maximale Lnge auf mindestens <code>${Math.ceil(this._configWarning.currentLength * 1.2)}</code> Zeichen erhhen</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (configWarningSize) {\n      configWarningSize.remove();\n                }\n\n    if (hasConfigWarning && this._configWarning.type === 'missing' && isEditorMode) {\n      // Missing-Warnung anzeigen/aktualisieren\n      let warningEl = configWarningMissing;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'config-missing');\n        // Fge nach anderen Warnungen ein\n        const lastWarning = wrapper.querySelector('.storage-warning:last-of-type');\n        if (lastWarning) {\n          lastWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      // Erstelle HTML-String fr missing entity warning\n      const entityNameShort = this._configWarning.configEntityId.replace('input_text.', '');\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Konfigurations-Entity fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${this._configWarning.configEntityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hilfsmittel hinzufgen  Text</li>\n              <li>Entity-ID: <code>${this._configWarning.configEntityId}</code></li>\n              <li>Maximale Lnge: <code>255</code> Zeichen (oder mehr)</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (configWarningMissing) {\n      configWarningMissing.remove();\n                }\n                }\n\n  // Aktualisiert die Status-Warnung direkt im DOM ohne Re-Rendering\n  _updateStatusWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasStatusWarning = this._statusWarning && this._statusWarning.show && isEditorMode;\n\n    const statusWarningEl = wrapper.querySelector('.storage-warning[data-warning-type=\"status\"]');\n\n    if (hasStatusWarning) {\n      let warningEl = statusWarningEl;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'status');\n        // Fge nach anderen Warnungen ein\n        const lastWarning = wrapper.querySelector('.storage-warning:last-of-type');\n        if (lastWarning) {\n          lastWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Status-Entity fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${this._statusWarning.statusEntityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hilfsmittel hinzufgen  Text</li>\n              <li>Entity-ID: <code>${this._statusWarning.statusEntityId}</code></li>\n              <li>Maximale Lnge: <code>255</code> Zeichen (oder mehr)</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (statusWarningEl) {\n      statusWarningEl.remove();\n                }\n                }\n\n  _getDayElements(monthKey, day) {\n    // Gibt die Elemente fr einen bestimmten Tag zurck\n    // Reduziere Debug-Ausgaben: Nur bei ersten 3 Tagen oder wenn keine Daten gefunden werden\n    const shouldDebug = day <= 3 || !this._workingDays[monthKey];\n    \n    if (shouldDebug) {\n      this._debug(`[Render] _getDayElements: Suche nach monthKey=\"${monthKey}\", day=${day}`);\n                }\n\n    if (!this._workingDays[monthKey] || typeof this._workingDays[monthKey] !== 'object') {\n      if (shouldDebug) {\n        this._debug(`[Render] _getDayElements: Keine Daten fr monthKey=\"${monthKey}\" gefunden oder kein Objekt`);\n        this._debug(`[Render] _getDayElements: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n                }\n      return [];\n                }\n\n    if (Array.isArray(this._workingDays[monthKey])) {\n      // Altes Format: Array von Tagen\n      if (shouldDebug) {\n        this._debug(`[Render] _getDayElements: Altes Format (Array) fr monthKey=\"${monthKey}\"`);\n                }\n      return [];\n                }\n\n    const elements = this._workingDays[monthKey][day] || [];\n    if (shouldDebug && elements.length > 0) {\n      this._debug(`[Render] _getDayElements: Gefundene Elemente fr \"${monthKey}\", Tag ${day}:`, elements);\n                }\n\n    return elements;\n                }\n\n  // berschreibe requestUpdate() um Updates zu verhindern, wenn Panel geffnet ist\n  requestUpdate(name, oldValue, options) {\n    // Verhindere alle Updates wenn das Konfigurationspanel geffnet ist\n    // (auer wenn _showConfigPanel selbst gendert wird)\n    if (this._showConfigPanel && name !== '_showConfigPanel') {\n      return;\n                }\n    return super.requestUpdate(name, oldValue, options);\n                }\n\n  // Optimierung: Verhindere unntige Re-Renderings\n  shouldUpdate(changedProperties) {\n    // WICHTIG: Verhindere alle Updates wenn das Konfigurationspanel geffnet ist\n    // (auer wenn sich _showConfigPanel selbst ndert)\n    if (this._showConfigPanel && !changedProperties.has('_showConfigPanel')) {\n      const changedProps = Array.from(changedProperties.keys()).join(', ');\n      this._debug(`[Update-Block] shouldUpdate() blockiert (Panel ist geffnet). Genderte Properties: ${changedProps}`);\n      return false;\n                }\n\n    // Prfe ob sich relevante Properties gendert haben\n    const relevantProps = [\n      'hass',\n      'config',\n      '_workingDays',\n      '_displayedMonths',\n      '_startMonthOffset',\n      '_selectedCalendar',\n      '_storageWarning',\n      '_configWarning',\n      '_statusWarning',\n      '_showConfigPanel',\n    ];\n\n    // Wenn nur _workingDays gendert wurde und direkte DOM-Updates im Gange sind,\n    // berspringe das Update, um Verdopplungen zu vermeiden\n    if (\n      changedProperties.has('_workingDays') &&\n      changedProperties.size === 1 &&\n      this._directDOMUpdateInProgress.size > 0\n    ) {\n      // berspringe Update, da direkte DOM-Manipulation verwendet wird\n      return false;\n                }\n\n    return relevantProps.some(prop => changedProperties.has(prop));\n                }\n\n  render() {\n    if (!this._config) {\n      return html`<div class=\"error\">Keine Konfiguration vorhanden</div>`;\n                }\n\n    const maxMonths = this._config.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const startMonthOffset = this._startMonthOffset || 0;\n    const now = new Date();\n    const months = [];\n\n    for (let i = 0; i < displayedMonths; i++) {\n      const date = new Date(now.getFullYear(), now.getMonth() + startMonthOffset + i, 1);\n      const year = date.getFullYear();\n      const month = date.getMonth();\n      months.push({ year, month });\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    // Speicherwarnung wird immer angezeigt (auch im normalen Modus)\n    const hasStorageWarning = this._storageWarning && this._storageWarning.show;\n    // Config-Warnung: \"missing\" nur im Editor, \"size\" immer (auch im normalen Modus)\n    const hasConfigWarning =\n      this._configWarning &&\n      this._configWarning.show &&\n      (this._configWarning.type === 'size' || // Speicherplatz-Warnung immer anzeigen\n        (this._configWarning.type === 'missing' && isEditorMode)); // Fehlende Entity nur im Editor\n    // Status-Warnung wird nur im Editor-Modus angezeigt\n    const hasStatusWarning = this._statusWarning && this._statusWarning.show && isEditorMode;\n    const navBounds = this.getNavigationBounds();\n\n    return html`\n      <div class=\"calendar-wrapper ${hasStorageWarning ? 'storage-warning-active' : ''}\">\n        <div class=\"schichtplan-wrapper\">\n        ${hasStorageWarning\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"storage\">\n                <div class=\"warning-icon\"></div>\n                <div class=\"warning-content\">\n                  <div class=\"warning-title\">Speicherplatz fast voll!</div>\n                  <div class=\"warning-message\">\n                    ${this._storageWarning.percentage}% der verfgbaren Speicherkapazitt verwendet\n                    (${this._storageWarning.currentLength} / ${this._storageWarning.maxLength                              }\n                    Zeichen).\n                  </div>\n                  <div class=\"warning-action\">\n                    Bitte legen Sie ein zustzliches Input-Text-Feld an (z.B.\n                    ${this._config.entity}_${String(\n                      this.findAdditionalEntities(this._config.entity).length + 1\n                    ).padStart(3, '0')}).\n                  </div>\n                </div>\n              </div>\n            `\n          : ''                              }\n        ${hasConfigWarning && this._configWarning.type === 'size'\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"config-size\">\n                <div class=\"warning-icon\"></div>\n                <div class=\"warning-content\">\n                  <div class=\"warning-title\">Konfigurations-Entity zu klein!</div>\n                  <div class=\"warning-message\">\n                    Die Konfiguration passt nicht in die Entity\n                    <code>${this._configWarning.configEntityId}</code>.\n                    ${this._configWarning.percentage}% der verfgbaren Speicherkapazitt bentigt\n                    (${this._configWarning.currentLength} / ${this._configWarning.maxLength                              }\n                    Zeichen).\n                  </div>\n                  <div class=\"warning-action\">\n                    Bitte erhhen Sie die maximale Lnge der Entity ber die UI:\n                    <ul>\n                      <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n                      <li>\n                        Entity\n                        <code\n                          >${this._configWarning.configEntityId.replace('input_text.', '')}</code\n                        >\n                        bearbeiten\n                      </li>\n                      <li>\n                        Maximale Lnge auf mindestens\n                        <code>${Math.ceil(this._configWarning.currentLength * 1.2)}</code> Zeichen\n                        erhhen\n                      </li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n            `\n          : ''                              }\n        ${hasConfigWarning && this._configWarning.type === 'missing'\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"config-missing\">\n                ${this._renderMissingEntityWarning(\n                  this._configWarning.configEntityId,\n                  'Konfigurations-Entity',\n                  255,\n                  true\n                )                              }\n              </div>\n            `\n          : ''                              }\n        ${hasStatusWarning\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"status\">\n                ${this._renderMissingEntityWarning(\n                  this._statusWarning.statusEntityId,\n                  'Status-Entity',\n                  255,\n                  false\n                )                              }\n              </div>\n            `\n          : ''                              }\n        ${!this._showConfigPanel\n          ? html`\n              <div class=\"schichtplan-wrapper\">\n                <div class=\"schichtplan-menu-bar\">\n                  ${renderMenuBar({\n                    left: '',\n                    center: html`\n                      <div class=\"menu-controls\">\n                        <button\n                          class=\"menu-button navigation-button\"\n                          @click=${() => this.changeStartMonth(-1)                              }\n                          ?disabled=${!navBounds.canGoBack                              }\n                          title=\"Vorheriger Monat\"\n                        >\n                          \n                        </button>\n                        <button\n                          class=\"menu-button decrease-button\"\n                          @click=${() => this.changeDisplayedMonths(-1)                              }\n                          ?disabled=${displayedMonths <= 1                              }\n                          title=\"Weniger Monate anzeigen\"\n                        >\n                          \n                        </button>\n                        <div class=\"menu-number\">${displayedMonths}</div>\n                        <button\n                          class=\"menu-button increase-button\"\n                          @click=${() => this.changeDisplayedMonths(1)                              }\n                          ?disabled=${displayedMonths >= maxMonths                              }\n                          title=\"Mehr Monate anzeigen\"\n                        >\n                          +\n                        </button>\n                        <button\n                          class=\"menu-button navigation-button\"\n                          @click=${() => this.changeStartMonth(1)                              }\n                          ?disabled=${!navBounds.canGoForward                              }\n                          title=\"Nchster Monat\"\n                        >\n                          \n                        </button>\n                      </div>\n                    `,\n                    right: html`\n                      <button\n                        class=\"menu-button config-button\"\n                        @click=${e => {\n                          e.stopPropagation();\n                          e.preventDefault();\n                          // Speichere die aktuellen calendars, holidays und statusOnlyInTimeRange beim ffnen des Panels\n                          this._configPanelCalendars = JSON.parse(JSON.stringify(this._config?.calendars || []));\n                          this._configPanelHolidays = this._config?.holidays ? { ...this._config.holidays } : null;\n                          this._configPanelStatusOnlyInTimeRange = this._config?.statusOnlyInTimeRange !== undefined ? this._config.statusOnlyInTimeRange : false;\n                          this._showConfigPanel = true;\n                          this.requestUpdate();\n                        }                              }\n                        title=\"Schichtkonfiguration\"\n                      >\n                        \n                      </button>\n                    `,\n                    fullWidth: (() => {\n                      const allCalendars = this._getAllCalendars();\n                      const selectedShortcut = this._getSelectedCalendarShortcut();\n                      return html`\n                        <div class=\"color-bar\">\n                          ${allCalendars.map(calendar => {\n                            const isSelected = calendar.shortcut === selectedShortcut;\n                            const textColor = this._getContrastColor(calendar.color || '#ff9800');\n                            return html`\n                              <button\n                                class=\"color-button ${isSelected ? 'selected' : ''}\"\n                                style=\"background-color: ${calendar.color || '#ff9800'}; color: ${textColor};\"\n                                @click=${() => this._onCalendarSelectedByIndex(calendar.shortcut)                              }\n                                title=\"${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`}\"\n                              >${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`}</button>\n                            `;\n                          })                              }\n                        </div>\n                      `;\n                    })(),\n                  })                              }\n                </div>\n                <div class=\"schichtplan-panel\">\n                  ${months.map(({ year, month }) => this.renderMonth(year, month))                              }\n                </div>\n              </div>\n            `\n          : html``                              }\n        ${this._showConfigPanel\n          ? html`\n              <div class=\"config-wrapper\">\n                <shift-config-panel\n                  .calendars=${this._configPanelCalendars || []                              }\n                  .selectedShortcut=${this._getSelectedCalendarShortcut()                              }\n                  .hass=${this._hass                              }\n                  @close=${() => {\n                    this._showConfigPanel = false;\n                    this._configPanelCalendars = null;\n                    this._configPanelHolidays = null;\n                    this._configPanelStatusOnlyInTimeRange = null;\n                    this.requestUpdate();\n                  }                              }\n                  .holidays=${this._configPanelHolidays || this._config?.holidays || {}                              }\n                  .statusOnlyInTimeRange=${this._configPanelStatusOnlyInTimeRange !== null ? this._configPanelStatusOnlyInTimeRange : (this._config?.statusOnlyInTimeRange || false)}\n                  @save=${e => this._handleConfigPanelSave(e.detail.calendars, e.detail.holidays, e.detail.statusOnlyInTimeRange)                              }\n                ></shift-config-panel>\n              </div>\n            `\n          : html``                              }\n      </div>\n    `;\n                }\n\n  _handleConfigPanelSave(calendars, holidays, statusOnlyInTimeRange) {\n    // Aktualisiere die Config mit den neuen Kalendern, Feiertagen und Optionen\n    if (this._config) {\n      this._config.calendars = calendars;\n      if (holidays) {\n        this._config.holidays = holidays;\n        // Invalidiere Holiday-Cache, damit Feiertage neu berechnet werden\n        this._holidayCache = {};\n        this._debug('[Config] _handleConfigPanelSave: Holiday-Cache invalidiert aufgrund von Feiertags-nderung');\n      }\n      if (statusOnlyInTimeRange !== undefined) {\n        this._config.statusOnlyInTimeRange = statusOnlyInTimeRange;\n        this._debug('[Config] _handleConfigPanelSave: statusOnlyInTimeRange auf', statusOnlyInTimeRange, 'gesetzt');\n      }\n      \n      // Speichere nur ber Saver (nicht ber Editor)\n      this.saveConfigToEntity();\n      \n      // Schliee das Panel\n      this._showConfigPanel = false;\n      this._configPanelHolidays = null;\n      this._configPanelStatusOnlyInTimeRange = null;\n      \n      // Aktualisiere die Ansicht\n      this.requestUpdate();\n                }\n                }\n\n  static styles = [\n    super.styles || [],\n    sharedMenuStyles,\n    css`\n      :host {\n        display: block;\n        --tgshiftschedule-default-selected-day-color: ${unsafeCSS(\n          ShiftScheduleView.DEFAULT_SELECTED_DAY_COLOR\n        )};\n                }\n\n      .calendar-wrapper {\n        display: block;\n        transition: border-color 0.3s ease;\n                }\n\n      .calendar-wrapper.storage-warning-active {\n        border: 3px solid var(--error-color, #f44336);\n        border-radius: 4px;\n        padding: 8px;\n        box-shadow: 0 0 10px rgba(244, 67, 54, 0.3);\n                }\n\n      .schichtplan-wrapper {\n        display: flex;\n        flex-direction: column;\n        gap: 0;\n        margin-bottom: 16px;\n                }\n\n      .schichtplan-menu-bar,\n      .config-menu-bar {\n        position: relative;\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        padding: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border-radius: 4px 4px 0 0;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-bottom: none;\n                }\n\n      /* Gemeinsame Menu-Styles und Farbleisten-Styles werden aus shared-menu-styles.js importiert */\n\n      .menu-number {\n        font-size: 18px;\n        font-weight: bold;\n        min-width: 40px;\n        text-align: center;\n        color: var(--primary-text-color, #212121);\n                }\n\n      .element-selector {\n        margin-left: 20px;\n        min-width: 200px;\n                }\n\n      .config-button {\n        font-size: 20px;\n        background: none !important;\n        border: none !important;\n        color: var(--primary-text-color, #212121) !important;\n        width: auto !important;\n        height: auto !important;\n        padding: 4px !important;\n                }\n\n      .config-button:hover {\n        background: none !important;\n        color: var(--primary-color, #03a9f4) !important;\n        transform: scale(1.1);\n                }\n\n      .schichtplan-panel {\n        display: flex;\n        flex-direction: column;\n        gap: 24px;\n        padding: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border-radius: 0 0 4px 4px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-top: none;\n                }\n\n      .config-wrapper {\n        margin-bottom: 16px;\n                }\n\n      .month-container {\n        display: flex;\n        flex-direction: column;\n                }\n\n      .month-header {\n        font-size: 18px;\n        font-weight: bold;\n        margin-bottom: 12px;\n        text-align: center;\n                }\n\n      .calendar-table {\n        width: 100%;\n        border-collapse: collapse;\n        table-layout: fixed;\n                }\n\n      .calendar-table th {\n        padding: 8px 4px;\n        text-align: center;\n        font-weight: bold;\n        font-size: 12px;\n        border-bottom: 2px solid var(--divider-color, #e0e0e0);\n                }\n\n      .calendar-table td {\n        padding: 4px;\n        text-align: center;\n        vertical-align: middle;\n                }\n\n      .day-button {\n        width: 100%;\n        min-width: 32px;\n        min-height: 32px;\n        padding: 2px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-radius: 4px;\n        background-color: var(--card-background-color, #ffffff);\n        color: var(--primary-text-color, #000000);\n        cursor: pointer;\n        transition: all 0.2s;\n        font-size: 12px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        gap: 2px;\n                }\n\n      .day-number {\n        font-size: 12px;\n        font-weight: bold;\n        line-height: 1;\n                }\n\n      .shifts-container {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        justify-content: center;\n        align-items: center;\n        max-width: 100%;\n                }\n\n      .shift-indicator {\n        display: inline-block;\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        border: 1px solid rgba(0, 0, 0, 0.2);\n        flex-shrink: 0;\n                }\n\n      .day-button:hover:not(.working) {\n        background-color: var(--primary-color, #03a9f4);\n        color: var(--text-primary-color, #ffffff);\n                }\n\n      .day-button.working:hover {\n        /* Behalte die Hintergrundfarbe bei, aber mache sie etwas dunkler */\n        opacity: 0.9;\n        filter: brightness(0.9);\n                }\n\n      /* Verhindere visuelle Markierung nach Klick auf mobilen Gerten */\n      .day-button:active,\n      .day-button:focus {\n        outline: none !important;\n        box-shadow: none !important;\n                }\n\n      /* Touch-spezifische Behandlung: Verhindere aktiven State nach Touch */\n      .day-button {\n        -webkit-tap-highlight-color: transparent;\n        -webkit-touch-callout: none;\n        touch-action: manipulation;\n                }\n\n      .day-button.working {\n        /* background-color wird jetzt dynamisch per style gesetzt, wenn eine Schicht ausgewhlt ist */\n        color: var(--text-primary-color, #ffffff);\n        font-weight: bold;\n                }\n\n      /* Fallback: Wenn keine Schicht ausgewhlt ist, verwende die Standardfarbe */\n      .day-button.working:not([style*='background-color']) {\n        background-color: var(--accent-color, var(--tgshiftschedule-default-selected-day-color));\n                }\n\n      /* Basis: Heute-Markierung mit Outline (wird auerhalb des Borders gerendert) */\n      .day-button.today {\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      .day-button.weekend {\n        border: 4px solid var(--secondary-color, #757575);\n                }\n\n      /* Feiertage haben Vorrang vor Wochenenden */\n      .day-button.holiday {\n        border: 4px solid var(--error-color, #f44336);\n                }\n\n      /* Wenn sowohl Wochenende als auch Feiertag, verwende Feiertagsfarbe (strkere Umrandung) */\n      .day-button.weekend.holiday {\n        border: 5px solid var(--error-color, #f44336);\n                }\n\n      /* Heute + Wochenende: Border fr Wochenende, Outline fr heute */\n      .day-button.today.weekend {\n        border: 4px solid var(--secondary-color, #757575);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      /* Heute + Feiertag: Border fr Feiertag, Outline fr heute */\n      .day-button.today.holiday {\n        border: 4px solid var(--error-color, #f44336);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      /* Heute + Wochenende + Feiertag: Border fr Feiertag (strker), Outline fr heute */\n      .day-button.today.weekend.holiday {\n        border: 5px solid var(--error-color, #f44336);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      .day-button.readonly,\n      .day-button:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n        background-color: var(--disabled-color, #f5f5f5);\n        color: var(--secondary-text-color, #888888);\n                }\n\n      .day-button.readonly:hover,\n      .day-button:disabled:hover {\n        background-color: var(--disabled-color, #f5f5f5);\n        color: var(--secondary-text-color, #888888);\n                }\n\n      .day-number {\n        font-size: 12px;\n        font-weight: bold;\n        line-height: 1;\n                }\n\n      .shifts-container {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        justify-content: center;\n        align-items: center;\n        max-width: 100%;\n                }\n\n      .shift-indicator {\n        display: inline-block;\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        border: 1px solid rgba(0, 0, 0, 0.2);\n        flex-shrink: 0;\n                }\n\n      .day-button.working .day-number {\n        color: var(--text-primary-color, #ffffff);\n                }\n\n      .week-label {\n        font-size: 11px;\n        color: var(--secondary-text-color, #888888);\n        padding-right: 8px;\n        text-align: right;\n        width: 40px;\n                }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n                }\n\n      .storage-warning {\n        display: flex;\n        align-items: flex-start;\n        gap: 12px;\n        padding: 16px;\n        margin-bottom: 16px;\n        background-color: var(--warning-color, var(--tgshiftschedule-default-selected-day-color));\n        color: var(--text-primary-color, #ffffff);\n        border-radius: 4px;\n        border-left: 4px solid var(--error-color, #f44336);\n                }\n\n      .warning-icon {\n        font-size: 24px;\n        flex-shrink: 0;\n                }\n\n      .warning-content {\n        flex: 1;\n                }\n\n      .warning-title {\n        font-weight: bold;\n        font-size: 16px;\n        margin-bottom: 8px;\n                }\n\n      .warning-message {\n        font-size: 14px;\n        margin-bottom: 8px;\n        line-height: 1.5;\n                }\n\n      .warning-action {\n        font-size: 14px;\n        font-weight: 500;\n        margin-top: 8px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.3);\n                }\n\n      .warning-action ul {\n        margin: 8px 0 0 0;\n        padding-left: 20px;\n        list-style-type: disc;\n                }\n\n      .warning-action li {\n        margin: 4px 0;\n        line-height: 1.5;\n                }\n\n      .warning-action code {\n        background-color: rgba(0, 0, 0, 0.2);\n        padding: 2px 6px;\n        border-radius: 3px;\n        font-family: 'Courier New', monospace;\n        font-size: 13px;\n                }\n    `,\n  ];\n                }\n\n// Registriere ShiftScheduleView als Custom Element\nif (!customElements.get('shiftschedule-view')) {\n  customElements.define('shiftschedule-view', ShiftScheduleView);\n                }\n","import { html, css } from 'lit';\nimport { CardBase } from './card-base.js';\nimport './views/shiftschedule-view/shiftschedule-view.js'; // Import fr Custom Element Registrierung\nimport { CardName, CardRegname } from './card-config.js';\n\nexport class CardImpl extends CardBase {\n  static className = 'CardImpl';\n  static get properties() {\n    return {\n      ...super.properties,\n      config: { type: Object },\n      hass: { type: Object },\n      lovelace: { type: Object },\n      _view: { type: Object },\n      _viewType: { type: String },\n    };\n  }\n\n  static getConfigElement() {\n    return document.createElement(`${CardRegname}-editor`);\n  }\n\n  static getStubConfig() {\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n    };\n  }\n\n  constructor() {\n    super();\n    this._debug(`CardImpl-Modul wird geladen`);\n    this.config = this.getDefaultConfig();\n    this._debug('CardImpl-Konstruktor: Initialisierung abgeschlossen');\n  }\n\n  getDefaultConfig() {\n    this._debug(`CardImpl getDefaultConfig wird aufgerufen`);\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      selectedCalendar: 'a', // Erster aktivierter Kalender\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      calendars: [\n        {\n          shortcut: 'a',\n          name: 'Kalender A',\n          color: '#ff9800',\n          enabled: true,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'b',\n          name: 'Kalender B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Kalender C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Kalender D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Kalender E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ],\n    };\n  }\n\n  setConfig(config) {\n    this._debug('setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration vorhanden');\n    }\n\n    // Merge Config: Behalte selectedCalendar aus der bergebenen Config, falls vorhanden\n    const defaultConfig = this.getDefaultConfig();\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      // Stelle sicher, dass selectedCalendar aus der bergebenen Config beibehalten wird\n      selectedCalendar:\n        config?.selectedCalendar !== undefined\n          ? config.selectedCalendar\n          : this.config?.selectedCalendar || defaultConfig.selectedCalendar,\n    };\n\n    this._debug('config nach setConfig:', this.config);\n\n    // View initialisieren oder aktualisieren\n    this._viewType = 'ShiftScheduleView';\n\n    try {\n      if (!this._view) {\n        // Erstelle ShiftScheduleView als Custom Element nur wenn noch nicht vorhanden\n        this._debug('setConfig: Erstelle neue ShiftSchedule-View');\n        this._view = document.createElement('shiftschedule-view');\n\n        // Event-Listener fr Config-nderungen von der View\n        this._view.addEventListener('config-changed', ev => {\n          this._debug('config-changed Event von ShiftSchedule-View empfangen:', ev.detail);\n          if (ev.detail && ev.detail.config) {\n            this.config = ev.detail.config;\n            // Speichere die Config (nur wenn durch Benutzeraktion gendert)\n            if (this._view._handleConfigChanged) {\n              this._view._handleConfigChanged();\n            }\n            // Dispatch das Event weiter, damit Home Assistant die Config aktualisiert\n            this.dispatchEvent(\n              new CustomEvent('config-changed', {\n                detail: { config: this.config },\n                bubbles: true,\n                composed: true,\n              })\n            );\n          }\n        });\n\n        // bergebe hass und lovelace an die View, falls sie bereits gesetzt wurden\n        if (this._hass) {\n          this._debug('setConfig: bergebe gespeicherten hass an ShiftSchedule-View');\n          this._view.hass = this._hass;\n        }\n        if (this.lovelace) {\n          this._debug('setConfig: bergebe lovelace an ShiftSchedule-View');\n          this._view.lovelace = this.lovelace;\n        }\n      } else {\n        // View existiert bereits, aktualisiere nur die Config\n        this._debug('setConfig: Aktualisiere bestehende ShiftSchedule-View');\n      }\n\n      // Aktualisiere die Config der View (wichtig: auch wenn View bereits existiert)\n      this._view.config = this.config;\n\n      this._debug('setConfig: View initialisiert/aktualisiert:', {\n        viewType: this._viewType,\n        config: this.config,\n      });\n    } catch (error) {\n      this._debug('setConfig: Fehler bei View-Initialisierung:', error);\n      throw new Error(`Fehler bei der View-Initialisierung: ${error.message}`);\n    }\n  }\n\n  set hass(hass) {\n    // this._debug('set hass wird aufgerufen');\n    this._hass = hass;\n    if (this._view) {\n      this._view.hass = hass;\n    } else {\n      this._debug('set hass: View noch nicht initialisiert, speichere hass fr spter');\n    }\n  }\n\n  set lovelace(lovelace) {\n    this._lovelace = lovelace;\n    if (this._view) {\n      this._view.lovelace = lovelace;\n    }\n  }\n\n  get lovelace() {\n    return this._lovelace;\n  }\n\n  get hass() {\n    return this._hass;\n  }\n\n  firstUpdated() {\n    this._debug('firstUpdated wird aufgerufen');\n    if (this._view) {\n      this._view.firstUpdated();\n    }\n    this._debug('firstUpdated abgeschlossen');\n  }\n\n  render() {\n    if (!this._view) {\n      return html`<div class=\"error\">Keine View verfgbar</div>`;\n    }\n\n    try {\n      return html`${this._view}`;\n    } catch (error) {\n      this._debug('render: Fehler beim Rendern der View:', error);\n      return html`<div class=\"error\">Fehler beim Rendern: ${error.message}</div>`;\n    }\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      ha-card {\n        padding: 16px;\n      }\n\n      .loading {\n        text-align: center;\n        padding: 20px;\n        color: var(--secondary-text-color);\n      }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n      }\n    `,\n  ];\n}\n","import { css } from 'lit';\nimport { SuperBase } from '../super-base.js';\n\nexport class EditorBase extends SuperBase {\n  static properties = {\n    ...super.properties,\n    _selectedTab: { type: Number },\n  };\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n      .editor-container {\n        padding: 16px;\n      }\n    `,\n  ];\n\n  constructor(defaultConfig = {}) {\n    super();\n    this._debug('[EditorBase] EditorBase-Konstruktor wird aufgerufen');\n    this.config = {\n      type: 'custom:tgeditor-card',\n      ...defaultConfig,\n    };\n    this._debug('[EditorBase] EditorBase config nach Konstruktor:', this.config);\n  }\n\n  async firstUpdated() {\n    this._debug('[EditorBase] EditorBase firstUpdated wird aufgerufen');\n    await super.firstUpdated();\n    this._debug('[EditorBase] EditorBase firstUpdated abgeschlossen');\n  }\n\n  async loadHaForm() {\n    this._debug('[EditorBase] EditorBase loadHaForm wird aufgerufen');\n    if (!customElements.get('ha-form')) {\n      this._debug('[EditorBase] EditorBase ha-form nicht gefunden, lade custom-card-helpers');\n      try {\n        const cardHelpers = await import('custom-card-helpers');\n        this._debug('[EditorBase] EditorBase custom-card-helpers geladen');\n        await cardHelpers.loadHaForm();\n        this._debug('[EditorBase] EditorBase ha-form geladen');\n      } catch (error) {\n        throw error;\n      }\n    } else {\n      this._debug('[EditorBase] EditorBase ha-form bereits geladen');\n    }\n  }\n\n  getDefaultConfig() {\n    this._debug('[EditorBase] EditorBase getDefaultConfig wird aufgerufen');\n    throw new Error('getDefaultConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  getStubConfig() {\n    this._debug('[EditorBase] EditorBase getStubConfig wird aufgerufen');\n    return this.getDefaultConfig();\n  }\n\n  setConfig(config) {\n    this._debug('[EditorBase] EditorBase setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration angegeben');\n    }\n\n    // Prfe, ob es sich um eine neue Konfiguration handelt\n    const isNewConfig = !this.config || Object.keys(this.config).length === 0;\n\n    // Wenn es eine neue Konfiguration ist, verwende sie direkt\n    if (isNewConfig) {\n      this.config = {\n        ...this.getDefaultConfig(),\n        ...config,\n      };\n    } else {\n      // Ansonsten behalte die bestehende Konfiguration bei und aktualisiere nur genderte Werte\n      this.config = {\n        ...this.config,\n        ...config,\n      };\n    }\n\n    this._debug('[EditorBase] EditorBase config nach setConfig:', this.config);\n  }\n}\n","import { html, css } from 'lit';\nimport { EditorBase } from './editor-base.js';\nimport { CardRegname } from '../card-config.js';\n\nexport class EditorImpl extends EditorBase {\n  static properties = {\n    ...super.properties,\n  };\n\n  constructor() {\n    super({\n      numberOfMonths: 14,\n      initialDisplayedMonths: 1,\n      selectedCalendar: 'a',\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n    });\n\n    this._debug(`EditorImpl-Modul wird geladen`);\n  }\n\n  async firstUpdated() {\n    this._debug(`EditorImpl firstUpdated wird aufgerufen`);\n    await super.firstUpdated();\n    this._debug(`EditorImpl firstUpdated abgeschlossen`);\n  }\n\n  render() {\n    this._debug('EditorImpl render wird aufgerufen');\n    if (!this.hass) {\n      this._debug(`EditorImpl render: Kein hass`);\n      return html`<div>Loading...</div>`;\n    }\n\n    this._debug(`EditorImpl render mit config:`, this.config);\n\n    // Stelle sicher, dass store_mode immer 'saver' ist und saver_key gesetzt ist\n    this.config.store_mode = 'saver';\n    if (!this.config.saver_key) {\n      this.config.saver_key = 'Schichtplan';\n    }\n\n    return html`\n      <div class=\"card-config\">\n        <div class=\"saver-info-message\">\n          <p>\n            <strong> Saver-Integration:</strong> Diese Karte verwendet die \n            <a href=\"https://github.com/PiotrMachowski/Home-Assistant-custom-components-Saver\" target=\"_blank\" rel=\"noopener noreferrer\">Saver-Integration</a> \n            zur Speicherung der Schichtdaten. Die Daten werden in Saver-Variablen gespeichert, ohne Lngenbegrenzung.\n          </p>\n        </div>\n        <ha-form\n          .hass=${this.hass}\n          .data=${this.config}\n          .schema=${this._getBasicSchema()}\n          .computeLabel=${this._computeLabel}\n          @value-changed=${this._valueChanged}\n        ></ha-form>\n      </div>\n    `;\n  }\n\n  _computeLabel(schema) {\n    switch (schema.name) {\n      case 'numberOfMonths':\n        return 'Maximale Anzahl Monate';\n      case 'initialDisplayedMonths':\n        return 'Standardwert sichtbare Monate';\n      case 'saver_key':\n        return 'Saver-Variablenname';\n      default:\n        return schema.name;\n    }\n  }\n\n  _valueChanged(ev) {\n    this._debug('EditorImpl _valueChanged wird aufgerufen mit:', ev.detail);\n\n    const newValue = ev.detail.value;\n    const oldStoreMode = this.config.store_mode;\n\n    // Stelle sicher, dass initialDisplayedMonths nicht grer als numberOfMonths ist\n    if (newValue.initialDisplayedMonths !== undefined && newValue.numberOfMonths !== undefined) {\n      newValue.initialDisplayedMonths = Math.min(\n        newValue.initialDisplayedMonths,\n        newValue.numberOfMonths\n      );\n    } else if (newValue.initialDisplayedMonths !== undefined && this.config.numberOfMonths) {\n      newValue.initialDisplayedMonths = Math.min(\n        newValue.initialDisplayedMonths,\n        this.config.numberOfMonths\n      );\n    } else if (newValue.numberOfMonths !== undefined && this.config.initialDisplayedMonths) {\n      // Wenn numberOfMonths gendert wird, passe initialDisplayedMonths an, falls ntig\n      if (this.config.initialDisplayedMonths > newValue.numberOfMonths) {\n        newValue.initialDisplayedMonths = newValue.numberOfMonths;\n      }\n    }\n\n    // Stelle sicher, dass store_mode immer 'saver' ist und saver_key gesetzt ist\n    newValue.store_mode = 'saver';\n    if (newValue.saver_key === undefined) {\n      newValue.saver_key = this.config.saver_key || 'Schichtplan';\n    }\n\n    this.config = {\n      ...this.config,\n      ...newValue,\n    };\n    this._debug('EditorImpl config nach _valueChanged:', this.config);\n\n    this.dispatchEvent(\n      new CustomEvent('config-changed', {\n        detail: { config: this.config },\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      .card-config {\n        padding: 10px;\n      }\n\n      .elements-section {\n        margin-top: 20px;\n        padding-top: 20px;\n        border-top: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .elements-header {\n        margin-bottom: 15px;\n      }\n\n      .elements-header ha-combo-box {\n        width: 100%;\n      }\n\n      .saver-info-message {\n        margin-bottom: 20px;\n        padding: 12px;\n        background-color: var(--info-color, #2196f3);\n        color: white;\n        border-radius: 4px;\n      }\n\n      .saver-info-message p {\n        margin: 0;\n      }\n\n      .saver-info-message a {\n        color: white;\n        text-decoration: underline;\n        font-weight: 500;\n      }\n\n      .saver-info-message a:hover {\n        text-decoration: none;\n      }\n\n      .info-message {\n        margin-top: 15px;\n        padding: 12px;\n        background-color: var(--info-color, #2196f3);\n        color: white;\n        border-radius: 4px;\n      }\n\n      .info-message p {\n        margin: 0;\n      }\n\n\n    `,\n  ];\n\n  static getConfigElement() {\n    return document.createElement(`${CardRegname}-editor`);\n  }\n\n  static getStubConfig() {\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n    };\n  }\n\n  _getBasicSchema() {\n    const schema = [\n      {\n        name: 'saver_key',\n        selector: {\n          text: {},\n        },\n      },\n      {\n        name: 'numberOfMonths',\n        selector: {\n          number: {\n            min: 1,\n            max: 14,\n            step: 1,\n            mode: 'box',\n          },\n        },\n      },\n      {\n        name: 'initialDisplayedMonths',\n        selector: {\n          number: {\n            min: 1,\n            max: 14,\n            step: 1,\n            mode: 'box',\n          },\n        },\n      },\n    ];\n\n    return schema;\n  }\n}\n","import { css } from 'lit';\nimport { EditorImpl } from './editor-impl.js';\nimport { CardRegname } from '../card-config.js';\n\nexport class Editor extends EditorImpl {\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n        padding-top: 2px;\n        padding-bottom: 2px;\n        padding-left: 16px;\n        padding-right: 16px;\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n  }\n}\n\nif (!customElements.get(`${CardRegname}-editor`)) {\n  customElements.define(`${CardRegname}-editor`, Editor);\n}\n","import { LitElement, html, css } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { CardImpl } from './card-impl.js';\nimport './editor/editor.js';\nimport { CardRegname, CardName, CardDescription } from './card-config.js';\n\nexport class Card extends CardImpl {\n  // className wird von CardImpl geerbt (ist 'CardImpl')\n  static styles = [\n    super.styles,\n    css`\n      :host {\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n  }\n}\n\n// Registriere die Karte in der UI\nif (window.customCards) {\n  window.customCards.push({\n    type: CardRegname,\n    name: CardName,\n    description: CardDescription,\n    preview: true,\n  });\n}\n\n// Registriere die Karte als Custom Element\nif (!customElements.get(CardRegname)) {\n  try {\n    customElements.define(CardRegname, Card);\n  } catch (error) {}\n}\n"],"names":["inProgress","dataWebpackPrefix","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","call","l","url","done","push","script","needAttach","scripts","document","getElementsByTagName","i","length","s","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","fn","setTimeout","bind","type","target","head","appendChild","r","Symbol","toStringTag","value","scriptUrl","importScripts","location","currentScript","tagName","toUpperCase","test","Error","replace","p","installedChunks","j","installedChunkData","promise","resolve","reject","error","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","self","ShadowRoot","ShadyCSS","nativeShadow","Document","CSSStyleSheet","WeakMap","n","constructor","t","_$cssResult$","cssText","styleSheet","replaceSync","set","toString","c","cssRules","is","getOwnPropertyDescriptor","h","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","a","trustedTypes","emptyScript","reactiveElementPolyfillSupport","toAttribute","Boolean","Array","JSON","stringify","fromAttribute","Number","parse","b","attribute","String","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","y","HTMLElement","addInitializer","_$Ei","observedAttributes","finalize","_$Eh","createProperty","state","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","requestUpdate","configurable","getPropertyOptions","Map","finalized","properties","_$Eu","elementStyles","finalizeStyles","styles","isArray","Set","flat","reverse","unshift","toLowerCase","super","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","enableUpdating","_$AL","_$E_","addController","_$EO","add","renderRoot","isConnected","hostConnected","removeController","delete","size","createRenderRoot","shadowRoot","attachShadow","shadowRootOptions","adoptedStyleSheets","map","litNonce","textContent","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","removeAttribute","_$Ej","hasAttribute","C","_$EP","has","_$Eq","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","update","_$EM","_$AE","hostUpdated","firstUpdated","updated","updateComplete","getUpdateComplete","mode","ReactiveElement","reactiveElementVersions","createPolicy","createHTML","Math","random","toFixed","slice","createComment","v","_","RegExp","$","_$litType$","strings","values","x","T","for","E","A","createTreeWalker","P","V","lastIndex","exec","startsWith","N","parts","el","currentNode","content","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","endsWith","split","index","ctor","H","I","L","k","append","indexOf","innerHTML","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","M","_$AV","_$AN","_$AD","_$AM","_$AU","creationScope","importNode","R","nextSibling","z","_$AI","_$Cv","_$AH","_$AA","_$AB","options","startNode","endNode","_$AR","iterator","O","insertBefore","createTextNode","_$AC","_$AP","remove","setConnected","element","fill","arguments","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","host","litHtmlPolyfillSupport","litHtmlVersions","renderOptions","_$Do","renderBefore","render","_$litPart$","_$litElement$","litElementHydrateSupport","LitElement","litElementPolyfillSupport","litElementVersions","Version","CardRegname","CardName","DebugMode","TgCardHelper","cardName","debugMode","className","version","getCardInfoString","_debug","args","methodName","contextObject","debugList","item","trim","includes","callerLine","stack","patterns","pattern","methodMatch","match","path","debugArgs","console","log","_defineProperty","SuperBase","dM","useDummyData","showVersion","tgCardHelper","registerMeForChangeNotifys","eventTypes","that","dispatchEvent","CustomEvent","bubbles","composed","detail","component","callback","_handleOnChangeNotifys","eventType","immediately","eventdata","fkt","charAt","hass","config","css","CardBase","_selectedTab","informAtChangesClients","_registeredEventTypes","_onRegisterMeForChanges","setConfig","isNewConfig","getDefaultConfig","numberOfMonths","initialDisplayedMonths","selectedCalendar","store_mode","saver_key","calendars","shortcut","color","enabled","statusRelevant","holidays","neujahr","heilige_drei_koenige","tag_der_arbeit","friedensfest","mariae_himmelfahrt","tag_der_deutschen_einheit","reformationstag","allerheiligen","weihnachten_1","weihnachten_2","karfreitag","ostermontag","christi_himmelfahrt","pfingstmontag","fronleichnam","busstag","html","registerInformAtChangesClients","componentExists","hasCallback","me","newEventType","sort","filter","existingMeInformer","find","informer","existingEventTypes","newEventTypes","newType","requestedEventTypes","combinedEventTypes","totalObservers","_notifyClientsAtChanges","originalEventType","extractedEventType","clients","client","Element","contains","details","_CardBase","_superPropGet","ViewBase","epgData","_loading","_error","_loadData","_dataProvider","entity","_fetchViewData","dataProvider","_renderLoading","_renderError","_renderContent","_ViewBase","IStorageAdapter","isApplicable","storeMode","debug","_hass","_config","saveData","serializedData","loadData","saveConfig","activeShifts","loadConfig","isAvailable","getWarnings","checkStorageUsage","dataLength","SaverStorage","_saverKey","saverEntity","states","_readSaverVariable","attributes","variables","oldValue","callService","warn","_createFullJsonConfig","statusOnlyInTimeRange","configObject","setup","timer_entity","lastchange","floor","Date","now","configKey","configJson","EntityStorage","_knownEntityIds","findAdditionalEntities","baseEntityId","additionalEntities","entityParts","domain","baseName","additionalEntityId","padStart","getEntityMaxLength","entityId","maxLength","max","parseInt","getAllEntityMaxLengths","maxLengths","mainEntityId","mainMaxLength","additionalMaxLength","_getAllEntityIds","allEntityIds","currentAdditionalEntities","knownAdditionalCount","newEntities","join","totalMaxLength","entity_id","entityValues","currentEntityIndex","remainingData","currentEntityId","charsToTake","min","valueToWrite","substring","newEntityId","entries","dataStrings","entityData","dataString","_createCompressedConfig","previousLength","getConfigEntityId","getStatusEntityId","configEntityId","configJsonLength","configEntity","totalCurrentLength","percentage","show","currentLength","round","warnings","status","statusEntityId","StorageFactory","createStorage","isStorageAvailable","HolidayMixin","_getEasterDate","year","month","_isHoliday","day","cacheKey","_holidayCache","result","_cachedHolidayEntities","holidayEntities","dateStr","dateStrShort","possibleAttrs","attr","attrValue","holidaysConfig","isHolidayEnabled","easter","fixedHolidays","holiday","easterTime","getTime","oneDay","dayOfWeekNov23","getDay","movableHolidays","date","getFullYear","getMonth","getDate","_isWeekend","dayOfWeek","DataManagementMixin","serializeWorkingDays","_workingDays","yearA","monthA","yearB","monthB","days","dayEntries","isNaN","formattedDays","dayNum","elements","dayStr","formatTwoDigits","parseWorkingDays","_parseWorkingDaysIntoObject","targetObject","part","trimmedPart","colons","daysStr","monthNum","_parseDaysWithElements","first","second","yearNum","entry","trimmed","CalendarMixin","_getAllCalendars","cal","localeCompare","_getCalendarByShortcut","_getDefaultColorForShortcut","CalendarsClass","CALENDARS","defaultCalendar","defaultColor","_getSelectedCalendarShortcut","_selectedCalendar","allCalendars","ConfigManagementMixin","shifts","RenderingMixin","_getDayElements","monthKey","shouldDebug","_renderMissingEntityWarning","entityName","isConfig","entityNameShort","litHtml","DateUtils","num","getDaysInMonth","getFirstDayOfMonth","getMonthName","getFirstDayOfWeekMondayBased","ColorUtils","_getContrastColor","hexColor","hex","substr","hexToRgb","cleanHex","rgbToHex","toHex","sharedMenuStyles","renderMenuBar","left","center","right","fullWidth","ShiftConfigPanel","selectedShortcut","_validationErrors","_currentView","_updateValidationErrors","changedProperties","oldCalendars","newCalendars","_validateCalendar","calendar","errors","timeRanges","timeRangeIds","range","rangeData","times","idNum","_hasValidationErrors","_triggerColorPicker","colorInput","querySelector","click","editingCalendar","selectedIndex","findIndex","_handleClose","_handleSave","isSelected","hasErrors","_addShift","_renderShiftsView","_renderHolidaysView","_renderOtherView","_updateCalendar","_updateCalendarId","checked","_addTimeRange","rangeIndex","_updateTimeRangeId","_updateTimeRange","_removeTimeRange","_deleteShift","_moveShift","label","_updateHoliday","_hasLocalCopy","direction","moved","splice","_toggleEnabled","existingShortcuts","availableShortcut","defaultColors","newShift","updates","_normalizeTimeRange","_normalizeTimeRanges","timeIndex","newTimeRanges","newId","normalizedId","existingIds","calErrors","selectedHasErrors","erfolgreich","fehlerfrei","gesamtFehler","fehlerDetails","aktuelleSchicht","aktuelleSchichtFehler","oldShortcut","newShortcut","normalizedNewShortcut","newVal","oldVal","customElements","define","ShiftScheduleView","lovelace","_storageWarning","_configWarning","_statusWarning","_displayedMonths","_startMonthOffset","_showConfigPanel","_cleanupDone","_isWriting","_writeLockTimer","_isInitialLoad","_directDOMUpdateInProgress","_editorModeCache","_editorModeCacheTime","_saveDebounceTimer","_storage","_configPanelCalendars","_configPanelHolidays","_configPanelStatusOnlyInTimeRange","assign","_isInEditorMode","URLSearchParams","search","editMode","depth","maxDepth","classList","parentElement","root","getRootNode","href","pathname","_initializeStorage","previousEntityState","newEntityState","hasAnyEntityChanged","prevState","newState","hasSaverConfigChanged","hasSaverDataChanged","previousSaverEntity","dataKey","previousConfigValue","previousDataValue","newDataValue","wasHassSet","loadWorkingDays","then","storageConfig","isPanelOpen","parsedConfig","isPanelOpenAfterParse","isPanelOpenBeforeUpdate","finalPanelCheck","idx","normalizedRange","timeRanges_count","catch","finalPanelCheckSaver","checkConfigEntity","checkStatusEntity","calendars_count","hasHass","maxMonths","_updateWarnings","isStillInitialLoad","saveConfigToEntity","_handleConfigChanged","variableValue","preview","availableKeys","_isSaverAvailable","_loadDataFromSaver","saverKey","_loadConfigFromSaver","_updateConfigWarningDirectly","_updateStatusWarningDirectly","dataSource","fallbackStorage","workingDaysCount","monthData","daysCount","currentMonth","currentYearFull","previousMonth","previousYear","monthsToKeep","hasChanges","keyParts","keyYear","keyMonth","shouldKeep","cleanedValue","serializedDataLength","_updateStorageWarningDirectly","statusEntity","hasConfig","hasEntity","storageType","storageAdapter","allShifts","_convertCalendarsToShifts","fallbackError","isEnabled","shiftData","range1","start1","end1","range2","start2","end2","_saveConfigToEntityFallback","distributeDataToEntities","truncatedValue","allAdditionalEntities","toggleDay","currentYear","isPreviousMonth","selectedCalendarShortcut","elementIndex","buttonKey","finalElements","_updateDayButtonDirectly","_scheduleDebouncedSave","debounceTime","_getSaveDebounceTime","_saveToHA","storageUsage","_saveDataToSaver","existingValue","saveDebounceTime","dayElements","button","hasSelectedShift","firstActiveShift","shiftOrder","activeShiftForColor","activeCalendar","style","backgroundColor","existingContainer","shiftIndicators","indicator","title","container","ind","getWeekNumber","UTC","getUTCDay","setUTCDate","getUTCDate","yearStart","getUTCFullYear","ceil","renderDay","currentDay","yearKey","workingDays","today","isToday","buttonStyle","isWorking","isWeekend","isHoliday","blur","wrapper","focus","existingButton","renderMonth","daysInMonth","firstDayMonday","rows","firstDate","weekNumber","firstRowCells","weekNum","rowCells","changeDisplayedMonths","delta","newValue","changeStartMonth","displayedMonths","currentOffset","maxOffset","newOffset","getNavigationBounds","canGoBack","canGoForward","_getSelectedCalendarValue","_onCalendarSelectedByIndex","_updateAllDayButtonsForCalendarChange","buttons","querySelectorAll","hasStorageWarning","storageWarningEl","nextEntitySuffix","isEditorMode","hasConfigWarning","configWarningSize","configWarningMissing","warningEl","storageWarning","insertAdjacentElement","lastWarning","hasStatusWarning","statusWarningEl","changedProps","from","startMonthOffset","months","navBounds","stopPropagation","preventDefault","textColor","_handleConfigPanelSave","_ShiftScheduleView","unsafeCSS","DEFAULT_SELECTED_DAY_COLOR","CardImpl","_view","_viewType","getConfigElement","getStubConfig","defaultConfig","ev","viewType","_lovelace","_CardImpl","EditorBase","loadHaForm","cardHelpers","_EditorBase","EditorImpl","_getBasicSchema","_computeLabel","_valueChanged","schema","selector","text","number","step","_EditorImpl","Editor","_Editor","Card","_Card","customCards","description"],"sourceRoot":""}