{"version":3,"file":"tgshiftschedule-card.js","mappings":"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","sources":["webpack://tgshiftschedule-card/webpack/runtime/load script","webpack://tgshiftschedule-card/webpack/bootstrap","webpack://tgshiftschedule-card/webpack/runtime/define property getters","webpack://tgshiftschedule-card/webpack/runtime/ensure chunk","webpack://tgshiftschedule-card/webpack/runtime/get javascript chunk filename","webpack://tgshiftschedule-card/webpack/runtime/global","webpack://tgshiftschedule-card/webpack/runtime/hasOwnProperty shorthand","webpack://tgshiftschedule-card/webpack/runtime/make namespace object","webpack://tgshiftschedule-card/webpack/runtime/publicPath","webpack://tgshiftschedule-card/webpack/runtime/jsonp chunk loading","webpack://tgshiftschedule-card/./node_modules/@lit/reactive-element/css-tag.js","webpack://tgshiftschedule-card/./node_modules/@lit/reactive-element/reactive-element.js","webpack://tgshiftschedule-card/./node_modules/lit-html/lit-html.js","webpack://tgshiftschedule-card/./node_modules/lit-element/lit-element.js","webpack://tgshiftschedule-card/./src/card-config.js","webpack://tgshiftschedule-card/./src/tools/tg-card-helper.js","webpack://tgshiftschedule-card/./src/super-base.js","webpack://tgshiftschedule-card/./src/card-base.js","webpack://tgshiftschedule-card/./src/views/view-base.js","webpack://tgshiftschedule-card/./src/storage/storage-interface.js","webpack://tgshiftschedule-card/./src/storage/saver-storage.js","webpack://tgshiftschedule-card/./src/storage/entity-storage.js","webpack://tgshiftschedule-card/./src/storage/storage-factory.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/holiday-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/data-management-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/calendar-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/config-management-mixin.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/mixins/rendering-mixin.js","webpack://tgshiftschedule-card/./src/utils/date-utils.js","webpack://tgshiftschedule-card/./src/utils/color-utils.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shared-menu-styles.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/menu-bar-template.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shift-config-panel.js","webpack://tgshiftschedule-card/./src/views/shiftschedule-view/shiftschedule-view.js","webpack://tgshiftschedule-card/./src/card-impl.js","webpack://tgshiftschedule-card/./src/editor/editor-base.js","webpack://tgshiftschedule-card/./src/editor/editor-impl.js","webpack://tgshiftschedule-card/./src/editor/editor.js","webpack://tgshiftschedule-card/./src/card.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"tgshiftschedule-card:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".tgshiftschedule-card.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunktgshiftschedule_card\"] = self[\"webpackChunktgshiftschedule_card\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.0\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.0\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.0\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","const Version = '2026.01-0037';\nconst CardRegname = 'tgshiftschedule-card';\nconst CardName = 'TG Schichtplan Card';\nconst CardDescription = 'Eine Schichtplan-Karte fr Arbeitszeiten';\nconst CardFilename = 'tgshiftschedule-card.js';\nconst DebugMode = 'true'; // Aktiviere Debug fr alle Komponenten\nconst UseDummyData = 'false';\nconst showVersion = false;\nconst SaveDebounceTime = 300; // Debounce-Zeit in Millisekunden fr das Speichern von nderungen (0 = sofort, ohne Debouncing)\n\n// Schichtplan-Konfiguration\nconst DefaultConfig = {\n  entity: '', // input_text Entity fr Speicherung (muss konfiguriert werden)\n};\n\nexport {\n  CardRegname,\n  CardName,\n  CardDescription,\n  CardFilename,\n  Version,\n  DebugMode,\n  UseDummyData,\n  showVersion,\n  SaveDebounceTime,\n  DefaultConfig,\n};\n","import { CardName, DebugMode, Version } from '../card-config.js';\n\nexport class TgCardHelper {\n  static cardName = CardName;\n  static debugMode = DebugMode;\n  static className = 'TgCardHelper';\n  static version = Version;\n\n  constructor(cardName, debugMode, className, version) {\n    this.cardName = cardName || this.constructor.cardName || null;\n    this.debugMode = debugMode || this.constructor.debugMode || 'true';\n    this.className = className || this.constructor.className || null;\n    this.version = version || this.constructor.version || null;\n    this.getCardInfoString = [\n      `%c${this.cardName}%c${this.version}%c`,\n      'background: #9c27b0; color: white; padding: 2px 6px; border-top-left-radius: 12px; border-bottom-left-radius: 12px; font-weight: bold;',\n      'background: #00bcd4; color: white; padding: 2px 6px; border-top-right-radius: 12px; border-bottom-right-radius: 12px; font-weight: bold;',\n      '',\n    ];\n\n    // this._debug('tgCardHelper initialisiert');\n  }\n  _debug(...args) {\n    // Prfe ob Debug aktiviert ist (kann String 'true' oder Boolean true sein)\n    if (!this.debugMode || this.debugMode === 'false' || this.debugMode === false) return;\n\n    // Versuche verschiedene Methoden, um den echten Klassennamen zu bekommen\n    let classNameDefault = 'unknownClass';\n    let methodNameDefault = 'unknownMethod';\n    let cardNameDefault = 'unknownCard';\n    let className = null;\n    let methodName = null;\n    let cardName = null;\n    let contextObject = null;\n\n    // Prfe ob das erste Argument ein Kontext-Objekt ist (this aus SuperBase)\n    // Kontext-Objekt erkennt man daran, dass es eine constructor-Eigenschaft hat UND\n    // spezifische Eigenschaften unserer Klassen hat (cardName ist einzigartig fr unsere Klassen)\n    if (\n      Array.isArray(args[0]) &&\n      args[0].length === 1 &&\n      args[0][0] &&\n      typeof args[0][0] === 'object' &&\n      args[0][0].constructor &&\n      (args[0][0].cardName || args[0][0].constructor.className)\n    ) {\n      contextObject = args[0][0];\n      args = args.slice(1);\n    } else {\n      contextObject = this;\n    }\n\n    // Extrahiere Informationen aus dem Kontext-Objekt (immer vorhanden)\n    // Methode 1: Statischer Klassennamen (falls definiert)\n    if (contextObject.constructor.className) {\n      className = contextObject.constructor.className;\n    }\n    // Methode 2: Tag-Name des Custom Elements\n    else if (contextObject.tagName) {\n      className = contextObject.tagName.toLowerCase().replace(/[^a-z0-9]/g, '');\n    }\n    // Methode 3: Constructor name (kann minifiziert sein)\n    else if (contextObject.constructor.name && contextObject.constructor.name.length > 2) {\n      className = contextObject.constructor.name;\n    }\n    // Methode 4: Fallback auf cardName\n    else if (contextObject.cardName) {\n      className = contextObject.cardName;\n    }\n    // Methode 5: Fallback auf Default\n    else {\n      className = classNameDefault;\n    }\n\n    cardName = contextObject.cardName || this.cardName || cardNameDefault;\n\n    // Prfe sofort, ob wir Debug-Meldungen fr diese Klasse ausgeben sollen\n    const debugList = this.debugMode.split(',').map(item => item.trim().toLowerCase());\n    const shouldDebug =\n      debugList[0].toLowerCase() === 'true'\n        ? !debugList.slice(1).includes(className.toLowerCase())\n        : debugList.includes(className.toLowerCase());\n\n    // Wenn wir keine Debug-Meldungen ausgeben sollen, beende hier\n    if (!shouldDebug) return;\n\n    // Ermittle den Methodennamen nur wenn wir Debug-Meldungen ausgeben\n    if (!methodName) {\n      try {\n        const stack = new Error().stack.split('\\n');\n        const callerLine = stack[2]; // Index 2 fr die aufrufende Methode\n\n        // Verschiedene Regex-Patterns fr verschiedene Browser-Formate\n        const patterns = [\n          /at\\s+\\w+\\.(\\w+)/, // Chrome/Node.js: \"at ClassName.methodName\"\n          /(\\w+)@/, // Firefox: \"methodName@\"\n          /(\\w+)\\s+\\(/, // Alternative: \"methodName(\"\n          /at\\s+(\\w+)/, // Fallback: \"at methodName\"\n        ];\n\n        for (const pattern of patterns) {\n          const methodMatch = callerLine.match(pattern);\n          if (methodMatch) {\n            methodName = methodMatch[1];\n            break;\n          }\n        }\n      } catch (error) {\n        // Fallback falls Stack Trace nicht verfgbar\n        methodName = null;\n      }\n    }\n    methodName = methodName || methodNameDefault;\n\n    // Erstelle Debug-Ausgabe\n    let path = `[${cardName}]:[${className}]:[${methodName}]`;\n    while (path.length < 50) {\n      path = path + ' ';\n    }\n\n    // Erstelle die vollstndige Debug-Ausgabe mit Formatierung\n    const debugArgs = [path, ...args];\n\n    // Verwende console.log mit dem formatierten Pfad\n    console.log(...this.getCardInfoString, ...debugArgs);\n  }\n}\n","import { LitElement, css } from 'lit';\nimport { CardName, Version, DebugMode, showVersion, UseDummyData } from './card-config.js';\nimport { TgCardHelper } from './tools/tg-card-helper.js';\n\nexport class SuperBase extends LitElement {\n  static cardName = CardName;\n  static version = Version;\n  static debugMode = DebugMode;\n  static useDummyData = UseDummyData;\n  static showVersion = showVersion;\n  static className = 'SuperBase';\n\n  static properties = {\n    hass: { type: Object },\n    config: { type: Object },\n  };\n\n  static styles = [\n    css`\n      :host {\n        display: block;\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n    this.dM = `${this.constructor.className}: `; // debugMsgPrefix - Prefix fr Debug-Nachrichten\n\n    this.cardName = this.constructor.cardName;\n    this.version = this.constructor.version;\n    this.debugMode = this.constructor.debugMode;\n    this.useDummyData = this.constructor.useDummyData;\n    this.showVersion = this.constructor.showVersion;\n    this.tgCardHelper = new TgCardHelper(this.constructor.cardName, this.constructor.debugMode);\n    this.getCardInfoString = this.tgCardHelper.getCardInfoString;\n    this._debug('SuperBase-Konstruktor wird aufgerufen');\n  }\n\n  registerMeForChangeNotifys(eventTypes = '', that = this) {\n    const dM = `${this.dM || '?: '}registerMeForChangeNotifys() `;\n    this._debug(`${dM} Aufruf`, { eventTypes, that });\n    this.dispatchEvent(\n      new CustomEvent('registerMeForChanges', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          component: that,\n          callback: this._handleOnChangeNotifys.bind(this),\n          eventType: eventTypes,\n          immediately: true,\n        },\n      })\n    );\n  }\n\n  _handleOnChangeNotifys(eventdata) {\n    const dM = `${this.dM || '?: '}_handleOnChangeNotifys() `;\n    this._debug(`${dM}aufgerufen`, { eventdata });\n    for (const eventType of Object.keys(eventdata)) {\n      const fkt = '_handleOnChangeNotify_' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n      if (typeof this[fkt] === 'function') {\n        this._debug(`${dM} ${fkt} aufgerufen`, { eventdata: eventdata[eventType] });\n        this[fkt](eventdata[eventType]);\n      } else {\n        this._debug(`${dM} ${fkt} nicht gefunden`, { eventdata: eventdata[eventType] });\n      }\n    }\n  }\n\n  _debug(...args) {\n    // Delegiere komplett an den TgCardHelper mit Kontext-Informationen\n    this.tgCardHelper._debug([this], ...args);\n  }\n}\n","import { css } from 'lit';\nimport { SuperBase } from './super-base.js';\n\nexport class CardBase extends SuperBase {\n  static className = 'CardBase';\n\n  static properties = {\n    ...super.properties,\n    _selectedTab: { type: Number },\n  };\n\n  constructor() {\n    super();\n    this.dM = `${this.constructor.className}: `; // debugMsgPrefix - Prefix fr Debug-Nachrichten\n\n    this._selectedTab = 0;\n    this._debug(`CardBase-Modul wird geladen`);\n\n    // Array fr nderungs-Observer\n    this.informAtChangesClients = [];\n\n    // Eigene Verwaltung der registrierten EventTypes\n    this._registeredEventTypes = new Set();\n\n    // Registriere Event-Listener fr automatische Registrierung\n    this.addEventListener('registerMeForChanges', this._onRegisterMeForChanges.bind(this));\n  }\n\n  async firstUpdated() {\n    this._debug('CardBase firstUpdated: Start');\n    await super.firstUpdated();\n    this._debug('CardBase firstUpdated: Ende');\n  }\n\n  setConfig(config) {\n    this._debug('setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration angegeben');\n    }\n\n    // Prfe, ob es sich um eine neue Konfiguration handelt\n    const isNewConfig = !this.config || Object.keys(this.config).length === 0;\n\n    // Wenn es eine neue Konfiguration ist, verwende sie direkt\n    if (isNewConfig) {\n      this.config = {\n        ...this.getDefaultConfig(),\n        ...config,\n      };\n    } else {\n      // Ansonsten behalte die bestehende Konfiguration bei und aktualisiere nur genderte Werte\n      this.config = {\n        ...this.config,\n        ...config,\n      };\n    }\n\n    this._debug('config nach setConfig:', this.config);\n  }\n\n  getDefaultConfig() {\n    this._debug('getDefaultConfig wird aufgerufen');\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      selectedCalendar: 'a', // Erster aktivierter Kalender\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      calendars: [\n        {\n          shortcut: 'a',\n          name: 'Kalender A',\n          color: '#ff9800',\n          enabled: true,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'b',\n          name: 'Kalender B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Kalender C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Kalender D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Kalender E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ],\n      holidays: {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      },\n    };\n  }\n\n  render(content = '') {\n    this._debug('render wird aufgerufen');\n    return html`\n      <ha-card>\n        <div class=\"card-content\">${content}</div>\n        ${this.showVersion ? html` <div class=\"version\">Version: ${this.version}</div> ` : ''}\n      </ha-card>\n    `;\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      ha-card {\n        padding: 16px;\n      }\n\n      .loading {\n        text-align: center;\n        padding: 20px;\n        color: var(--secondary-text-color);\n      }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n      }\n    `,\n  ];\n\n  _onRegisterMeForChanges(event) {\n    this._debug('Registrierungsanfrage empfangen', {\n      component: event.target,\n      detail: event.detail,\n    });\n\n    const { component, callback, eventType = '', immediately = false } = event.detail;\n\n    if (component && typeof callback === 'function') {\n      this.registerInformAtChangesClients(component, eventType, immediately, callback);\n      this._debug('Komponente erfolgreich registriert', {\n        component: component.tagName || component.constructor.name,\n        eventType: eventType,\n      });\n    } else {\n      this._debug('Registrierung fehlgeschlagen', {\n        componentExists: !!component,\n        hasCallback: typeof callback === 'function',\n      });\n    }\n  }\n\n  /**\n   * Registriert einen Observer fr View-nderungen\n   * @param {Object} me - Das Objekt, das ber nderungen informiert werden soll\n   * @param {string|Array} eventType - Event-Typ als String oder Array von Strings\n   * @param {Function} callback - Callback-Funktion, die bei nderungen aufgerufen wird\n   */\n  registerInformAtChangesClients(me, eventType = '', immediately = false, callback = null) {\n    const dM = `${this.dM || '?: '}registerInformAtChangesClients() `;\n    this._debug(`${dM}Anfrage`, {\n      me,\n      newEventType: eventType,\n    });\n\n    // Normalisiere die neuen EventTypes\n    const eventTypes = Array.isArray(eventType)\n      ? eventType.map(e => e.toLowerCase()).sort()\n      : typeof eventType === 'string'\n        ? eventType\n            .split(',')\n            .map(e => e.trim().toLowerCase())\n            .filter(e => e.length > 0)\n            .sort()\n        : [];\n\n    // Prfe ob bereits ein Observer fr denselben me existiert\n    const existingMeInformer = this.informAtChangesClients.find(informer => informer.me === me);\n    let existingEventTypes = [];\n    if (existingMeInformer) {\n      // Normalisiere die bestehenden eventTypes\n      existingEventTypes = Array.isArray(existingMeInformer.eventType)\n        ? existingMeInformer.eventType.map(e => e.toLowerCase()).sort()\n        : typeof existingMeInformer.eventType === 'string'\n          ? existingMeInformer.eventType\n              .split(',')\n              .map(e => e.trim().toLowerCase())\n              .filter(e => e.length > 0)\n              .sort()\n          : [];\n    }\n    // Finde nur die wirklich neuen EventTypes\n    const newEventTypes = eventTypes.filter(newType => !existingEventTypes.includes(newType));\n    if (existingMeInformer && newEventTypes.length === 0) {\n      this._debug(`${dM}Client war bereits mit allen Typen registriert`, {\n        me,\n        requestedEventTypes: eventTypes,\n        existingEventTypes,\n      });\n      return false;\n    }\n\n    if (existingMeInformer) {\n      // Fge nur die neuen EventTypes hinzu\n      const combinedEventTypes = [...existingEventTypes, ...newEventTypes].sort();\n      existingMeInformer.eventType = combinedEventTypes;\n      this._debug(`${dM}Neue EventTypes hinzugefgt`, {\n        me,\n        newEventTypes,\n        existingEventTypes,\n        combinedEventTypes,\n      });\n    } else {\n      // Fge neuen Client hinzu\n      this.informAtChangesClients.push({\n        me,\n        eventType: newEventTypes,\n        callback,\n      });\n      this._debug(`${dM}Neuer Informer registriert`, {\n        me,\n        newEventTypes,\n        totalObservers: this.informAtChangesClients.length,\n      });\n    }\n    newEventTypes.forEach(eventType => {\n      // Prfe ob bereits ein Listener fr diesen EventType existiert\n      if (!this._registeredEventTypes.has(eventType)) {\n        this._debug(`${dM}Fge Listener fr EventType hinzu`, { eventType });\n        this.addEventListener(eventType + '-event', this._notifyClientsAtChanges.bind(this));\n        this._registeredEventTypes.add(eventType);\n      } else {\n        this._debug(`${dM}Listener fr EventType bereits vorhanden`, { eventType });\n      }\n      const fkt = '_onRegisterMeFor_' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n      this._debug(`${dM}Registriere Komponente fr EnvSniffer-nderungen`, { fkt });\n      if (typeof this[fkt] === 'function') {\n        this[fkt](immediately, me);\n      }\n    });\n\n    return true;\n  }\n\n  _notifyClientsAtChanges(event) {\n    this._debug('_notifyClientsAtChanges() Anfrage', {\n      event,\n    });\n    // Sichere Extraktion des EventTypes (entferne '-event' Suffix)\n    const eventType = event.type.replace('-event', '');\n    const fkt = '_on' + eventType.charAt(0).toUpperCase() + eventType.slice(1);\n    // const data = {[eventType]: (typeof this[fkt] === 'function') ? this[fkt](event.detail) : event.detail};\n\n    this._debug('_notifyClientsAtChanges() EventType extrahiert', {\n      originalEventType: event.type,\n      extractedEventType: eventType,\n      clients: this.informAtChangesClients,\n      fkt: fkt,\n    });\n\n    this.informAtChangesClients.forEach(client => {\n      // Prfe ob client.me auf ein existierendes DOM-Element verweist\n      if (\n        eventType &&\n        client.eventType.includes(eventType) &&\n        client.me &&\n        (client.me instanceof Element || client.me.nodeType)\n      ) {\n        // Zustzliche Prfung: Ist das Element noch im DOM?\n        if (document.contains(client.me) || client.me.isConnected) {\n          // Client benachrichtigen\n          const details =\n            typeof this[fkt] === 'function' ? this[fkt](client.me, event) : event.detail || {};\n          const data = { [eventType]: details };\n          if (details && client.callback && typeof client.callback === 'function') {\n            try {\n              this._debug('_notifyClientsAtChanges() Client benachrichtigen', {\n                client: client.me.constructor.name,\n                eventType: eventType,\n                data: data,\n              });\n              client.callback(data);\n            } catch (error) {\n              // Fehler beim Benachrichtigen des Clients\n            }\n          }\n        }\n      }\n    });\n  }\n}\n","import { SuperBase } from '../super-base.js';\nimport { css } from 'lit';\n\nexport class ViewBase extends SuperBase {\n  static className = 'ViewBase';\n\n  static properties = {\n    config: { type: Object },\n    epgData: { type: Array },\n    _loading: { type: Boolean },\n    _error: { type: Object },\n  };\n\n  constructor() {\n    super();\n    this._debug('ViewBase-Konstruktor: Start');\n    this.config = {};\n    this.epgData = [];\n    this._loading = false;\n    this._error = null;\n    this._debug('ViewBase-Konstruktor: Initialisierung abgeschlossen');\n  }\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n    `,\n  ];\n\n  async firstUpdated() {\n    this._debug('ViewBase firstUpdated: Start');\n    await super.firstUpdated();\n    this._debug('ViewBase firstUpdated: Ende');\n  }\n\n  async _loadData() {\n    this._debug('ViewBase _loadData wird aufgerufen');\n    if (!this._dataProvider || !this.config.entity) {\n      this._debug('ViewBase _loadData: bersprungen - dataProvider oder entity fehlt', {\n        dataProvider: !!this._dataProvider,\n        entity: this.config.entity,\n        config: this.config,\n      });\n      return;\n    }\n\n    this._loading = true;\n    this._error = null;\n\n    try {\n      this._debug('Starte _fetchViewData mit Konfiguration:', this.config);\n      const data = await this._fetchViewData(this.config);\n      this.epgData = data;\n      this._debug('_fetchViewData erfolgreich:', data);\n    } catch (error) {\n      this._error = error;\n      this._debug('Fehler in _fetchViewData:', error);\n    } finally {\n      this._loading = false;\n    }\n  }\n\n  async _fetchViewData(config) {\n    throw new Error('_fetchViewData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  // Basis-Rendering-Methode, die von den abgeleiteten Klassen berschrieben werden kann\n  render() {\n    if (this._loading) {\n      return this._renderLoading();\n    }\n    if (this._error) {\n      return this._renderError();\n    }\n    return this._renderContent();\n  }\n\n  _renderLoading() {\n    return html`<div class=\"loading\">Lade Daten...</div>`;\n  }\n\n  _renderError() {\n    return html`<div class=\"error\">${this._error}</div>`;\n  }\n\n  _renderContent() {\n    return html`<div>Keine Daten verfgbar</div>`;\n  }\n}\n","/**\n * Storage-Interface fr verschiedene Speicher-Mechanismen\n * \n * Dieses Interface ermglicht es, verschiedene Storage-Implementierungen\n * (z.B. Saver, Entity) zu kapseln und spter leicht zu entfernen oder zu wechseln.\n */\n\n/**\n * @interface IStorageAdapter\n * \n * Basis-Interface fr alle Storage-Adapter\n */\nexport class IStorageAdapter {\n  /**\n   * Prft, ob dieser Storage-Adapter fr den gegebenen store_mode verwendet werden soll\n   * @param {string} storeMode - Der store_mode aus der Config ('saver' oder 'text_entity')\n   * @returns {boolean} - true wenn dieser Adapter verwendet werden soll\n   */\n  static isApplicable(storeMode) {\n    throw new Error('isApplicable muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Initialisiert den Storage-Adapter\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @param {Function} debug - Debug-Funktion\n   */\n  constructor(hass, config, debug) {\n    this._hass = hass;\n    this._config = config;\n    this._debug = debug;\n  }\n\n  /**\n   * Speichert die serialisierten Daten\n   * @param {string} serializedData - Serialisierte Daten als String\n   * @returns {Promise<void>}\n   */\n  async saveData(serializedData) {\n    throw new Error('saveData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Ldt die Daten\n   * @returns {Promise<string|null>} - Die geladenen Daten oder null wenn keine vorhanden\n   */\n  async loadData() {\n    throw new Error('loadData muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Speichert die Konfiguration\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {Promise<void>}\n   */\n  async saveConfig(activeShifts) {\n    throw new Error('saveConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Ldt die Konfiguration\n   * @returns {Promise<string|null>} - Die geladene Konfiguration oder null wenn keine vorhanden\n   */\n  async loadConfig() {\n    throw new Error('loadConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Prft, ob die Storage-Komponente verfgbar/konfiguriert ist\n   * @returns {boolean}\n   */\n  isAvailable() {\n    throw new Error('isAvailable muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Gibt Warnungen zurck (z.B. bei fehlenden Entities oder Speicherproblemen)\n   * @returns {Object|null} - Warnungsobjekt oder null\n   */\n  getWarnings() {\n    throw new Error('getWarnings muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  /**\n   * Prft die Speichernutzung (nur fr Entity-Storage relevant)\n   * @param {number} dataLength - Lnge der zu speichernden Daten\n   * @returns {Object|null} - Nutzungsobjekt oder null\n   */\n  checkStorageUsage(dataLength) {\n    // Optional - Standard-Implementierung gibt null zurck\n    return null;\n  }\n}\n\n","/**\n * Saver-Storage-Implementierung\n * \n * Speichert Daten in Saver-Variablen (HACS Integration)\n * Kann spter leicht entfernt werden, wenn nur Entity-Storage verwendet werden soll.\n */\n\nimport { IStorageAdapter } from './storage-interface.js';\n\nexport class SaverStorage extends IStorageAdapter {\n  static isApplicable(storeMode) {\n    return storeMode === 'saver';\n  }\n\n  constructor(hass, config, debug) {\n    super(hass, config, debug);\n    this._saverKey = config?.saver_key || 'Schichtplan';\n  }\n\n  isAvailable() {\n    if (!this._hass || !this._config || !this._config.saver_key) {\n      return false;\n    }\n    // Prfe ob Saver-Entity existiert\n    const saverEntity = this._hass.states?.['saver.saver'];\n    return !!saverEntity;\n  }\n\n  /**\n   * Liest eine Saver-Variable\n   * @private\n   */\n  _readSaverVariable(key) {\n    if (!this._hass || !this._hass.states) {\n      return null;\n    }\n\n    const saverEntity = this._hass.states['saver.saver'];\n    if (!saverEntity || !saverEntity.attributes || !saverEntity.attributes.variables) {\n      return null;\n    }\n\n    const value = saverEntity.attributes.variables[key];\n    if (value === undefined || value === null) {\n      return null;\n    }\n\n    return String(value).trim();\n  }\n\n  async saveData(serializedData) {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] saveData: Nicht verfgbar');\n      return;\n    }\n\n    this._debug(\n      `[SaverStorage] saveData: Start, saver_key: \"${this._saverKey}\", Datenlnge: ${serializedData.length} Zeichen`\n    );\n\n    try {\n      // Prfe ob sich der Wert gendert hat\n      const oldValue = this._readSaverVariable(this._saverKey);\n      \n      this._debug(\n        `[SaverStorage] saveData: Saver-Variable \"${this._saverKey}\" existiert: ${oldValue !== null}, alte Lnge: ${oldValue?.length || 0} Zeichen`\n      );\n\n      // Nur schreiben wenn Variable nicht existiert oder Wert sich gendert hat\n      if (oldValue === null || oldValue !== serializedData) {\n        this._debug(\n          `[SaverStorage] saveData: Schreibe in Saver (Variable existiert nicht oder Wert hat sich gendert)`\n        );\n        await this._hass.callService('saver', 'set_variable', {\n          name: this._saverKey,\n          value: serializedData || '',\n        });\n        this._debug(`[Sync] [SaverStorage] saveData: Erfolgreich in Saver geschrieben - andere Karten sollten nderung erkennen`);\n      } else {\n        this._debug(\n          `[SaverStorage] saveData: Kein Schreiben ntig, Wert hat sich nicht gendert`\n        );\n      }\n    } catch (error) {\n      this._debug(\n        `[SaverStorage] saveData: Fehler beim Schreiben in Saver: ${error.message}`,\n        error\n      );\n      console.warn('[TG Schichtplan] Fehler beim Schreiben in Saver:', error);\n      throw error; // Wirf Fehler weiter, damit Fallback-Mechanismus greifen kann\n    }\n  }\n\n  async loadData() {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] loadData: Nicht verfgbar');\n      return null;\n    }\n\n    this._debug(\n      `[SaverStorage] loadData: Versuche Daten von Saver-Variable \"${this._saverKey}\" zu laden`\n    );\n    \n    const data = this._readSaverVariable(this._saverKey);\n\n    if (data && data.trim() !== '') {\n      this._debug(\n        `[SaverStorage] loadData: Daten erfolgreich geladen, Lnge: ${data.length} Zeichen`\n      );\n      return data;\n    }\n\n    this._debug('[SaverStorage] loadData: Keine Daten gefunden');\n    return null;\n  }\n\n  /**\n   * Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n   * Verwendet direkt das Format vom Config-Panel (calendars-Array)\n   * @private\n   */\n  _createFullJsonConfig(calendars) {\n    const configObject = {\n      calendars: calendars,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp - wird bei jedem Speichern aktualisiert\n    };\n    this._debug(`[SaverStorage] _createFullJsonConfig: lastchange auf ${configObject.lastchange} gesetzt (aktueller Unix-Timestamp)`);\n    return JSON.stringify(configObject);\n  }\n\n  async saveConfig(calendars) {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] saveConfig: Nicht verfgbar');\n      return;\n    }\n\n    const configKey = `${this._saverKey}_config`;\n    this._debug(`[SaverStorage] saveConfig: Saver-Key: \"${this._saverKey}\", Config-Key: \"${configKey}\"`);\n    \n    const configJson = this._createFullJsonConfig(calendars);\n    this._debug(\n      `[SaverStorage] saveConfig: JSON-Config erstellt, Lnge: ${configJson.length} Zeichen, Kalender: ${calendars?.length || 0}`\n    );\n\n    try {\n      await this._hass.callService('saver', 'set_variable', {\n        name: configKey,\n        value: String(configJson),\n      });\n      \n      this._debug(`[SaverStorage] saveConfig: Variable \"${configKey}\" wurde im Saver gespeichert`);\n    } catch (error) {\n      this._debug(\n        `[SaverStorage] saveConfig: Fehler beim Schreiben: ${error.message}`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  async loadConfig() {\n    if (!this.isAvailable()) {\n      this._debug('[SaverStorage] loadConfig: Nicht verfgbar');\n      return null;\n    }\n\n    const configKey = `${this._saverKey}_config`;\n    this._debug(\n      `[SaverStorage] loadConfig: Versuche Config von Saver-Variable \"${configKey}\" zu laden`\n    );\n    \n    const config = this._readSaverVariable(configKey);\n\n    if (config && config.trim() !== '') {\n      this._debug(\n        `[SaverStorage] loadConfig: Config erfolgreich geladen, Lnge: ${config.length} Zeichen`\n      );\n      return config;\n    }\n\n    this._debug('[SaverStorage] loadConfig: Keine Config gefunden');\n    return null;\n  }\n\n  getWarnings() {\n    // Saver hat keine Warnungen (keine Entity-Prfung ntig)\n    return null;\n  }\n}\n\n","/**\n * Entity-Storage-Implementierung\n * \n * Speichert Daten in input_text Entities (mit Multi-Entity-Support)\n * Kann spter leicht entfernt werden, wenn nur Saver-Storage verwendet werden soll.\n */\n\nimport { IStorageAdapter } from './storage-interface.js';\n\nexport class EntityStorage extends IStorageAdapter {\n  static isApplicable(storeMode) {\n    return storeMode === 'text_entity' || !storeMode || storeMode === '';\n  }\n\n  constructor(hass, config, debug) {\n    super(hass, config, debug);\n    this._knownEntityIds = null; // Cache fr bekannte Entities\n  }\n\n  isAvailable() {\n    return !!(this._hass && this._config && this._config.entity);\n  }\n\n  /**\n   * Findet zustzliche Entities (z.B. input_text.arbeitszeiten_001, _002, etc.)\n   * @private\n   */\n  findAdditionalEntities(baseEntityId) {\n    const additionalEntities = [];\n\n    if (!this._hass || !this._hass.states) {\n      return additionalEntities;\n    }\n\n    const entityParts = baseEntityId.split('.');\n    if (entityParts.length !== 2) {\n      return additionalEntities;\n    }\n\n    const [domain, baseName] = entityParts;\n\n    // Suche nach Entities mit _001, _002, etc. (bis _999)\n    for (let i = 1; i <= 999; i++) {\n      const suffix = String(i).padStart(3, '0');\n      const additionalEntityId = `${domain}.${baseName}_${suffix}`;\n\n      if (this._hass.states[additionalEntityId]) {\n        additionalEntities.push(additionalEntityId);\n      } else {\n        // Wenn eine Entity nicht existiert, breche ab (Entities sind sequenziell)\n        break;\n      }\n    }\n\n    return additionalEntities;\n  }\n\n  /**\n   * Ermittelt die maximale Lnge einer Entity\n   * @private\n   */\n  getEntityMaxLength(entityId) {\n    if (!this._hass || !this._hass.states || !entityId) {\n      return null;\n    }\n\n    const entity = this._hass.states[entityId];\n    if (!entity || !entity.attributes) {\n      return null;\n    }\n\n    const maxLength = entity.attributes.max;\n    if (maxLength !== undefined && maxLength !== null) {\n      return parseInt(maxLength);\n    }\n\n    return null;\n  }\n\n  /**\n   * Ermittelt die maximale Lnge aller Entities\n   * @private\n   */\n  getAllEntityMaxLengths() {\n    const maxLengths = {};\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      return maxLengths;\n    }\n\n    const mainEntityId = this._config.entity;\n    const mainMaxLength = this.getEntityMaxLength(mainEntityId);\n    if (mainMaxLength !== null) {\n      maxLengths[mainEntityId] = mainMaxLength;\n    }\n\n    const additionalEntities = this.findAdditionalEntities(mainEntityId);\n    for (const additionalEntityId of additionalEntities) {\n      const additionalMaxLength = this.getEntityMaxLength(additionalEntityId);\n      if (additionalMaxLength !== null) {\n        maxLengths[additionalEntityId] = additionalMaxLength;\n      }\n    }\n\n    return maxLengths;\n  }\n\n  /**\n   * Sammelt alle Entity-IDs (Haupt-Entity + zustzliche)\n   * @private\n   */\n  _getAllEntityIds() {\n    if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n      return [...this._knownEntityIds];\n    }\n\n    const allEntityIds = [this._config.entity];\n    const additionalEntities = this.findAdditionalEntities(this._config.entity);\n    allEntityIds.push(...additionalEntities);\n    this._knownEntityIds = [...allEntityIds];\n    return allEntityIds;\n  }\n\n  async saveData(serializedData) {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] saveData: Nicht verfgbar');\n      return;\n    }\n\n    this._debug(\n      `[EntityStorage] saveData: Start, Datenlnge: ${serializedData ? serializedData.length : 0} Zeichen`\n    );\n\n    try {\n      // Verwende die gecachte Liste der Entities, falls verfgbar\n      let allEntityIds = this._getAllEntityIds();\n\n      // Prfe ob neue Entities hinzugekommen sind\n      const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n      const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0;\n\n      if (currentAdditionalEntities.length > knownAdditionalCount) {\n        const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n        allEntityIds.push(...newEntities);\n        this._knownEntityIds = [...allEntityIds];\n      }\n\n      this._debug(\n        `[EntityStorage] saveData: Verwende ${allEntityIds.length} Entities: ${allEntityIds.join(', ')}`\n      );\n\n      // Ermittle die maximale Lnge fr jede Entity\n      const maxLengths = {};\n      let totalMaxLength = 0;\n      for (const entityId of allEntityIds) {\n        const maxLength = this.getEntityMaxLength(entityId);\n        if (maxLength !== null) {\n          maxLengths[entityId] = maxLength;\n          totalMaxLength += maxLength;\n        } else {\n          maxLengths[entityId] = 255; // Standard\n          totalMaxLength += 255;\n        }\n      }\n\n      const dataLength = serializedData ? serializedData.length : 0;\n      this._debug(\n        `[EntityStorage] saveData: Datenlnge: ${dataLength} Zeichen, verfgbarer Speicher: ${totalMaxLength} Zeichen`\n      );\n\n      // Wenn keine Daten vorhanden sind, setze alle Entities auf leer\n      if (!serializedData || serializedData.trim() === '') {\n        this._debug('[EntityStorage] saveData: Keine Daten vorhanden, setze alle Entities auf leer');\n        for (const entityId of allEntityIds) {\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: '',\n            });\n          } catch (error) {\n            this._debug(\n              `[EntityStorage] saveData: Fehler beim Leeren von \"${entityId}\": ${error.message}`\n            );\n          }\n        }\n        return;\n      }\n\n      // Verteile die Daten zeichenweise auf die Entities\n      const entityValues = {};\n      let currentEntityIndex = 0;\n      let remainingData = serializedData;\n\n      while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n        const currentEntityId = allEntityIds[currentEntityIndex];\n        const maxLength = maxLengths[currentEntityId];\n\n        const charsToTake = Math.min(remainingData.length, maxLength);\n        const valueToWrite = remainingData.substring(0, charsToTake);\n\n        entityValues[currentEntityId] = valueToWrite;\n        remainingData = remainingData.substring(charsToTake);\n\n        if (remainingData.length > 0) {\n          currentEntityIndex++;\n        }\n      }\n\n      // Wenn am Ende noch Text ber ist, prfe ob neue Entities hinzugekommen sind\n      if (remainingData.length > 0) {\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0;\n\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n\n          for (const newEntityId of newEntities) {\n            const maxLength = this.getEntityMaxLength(newEntityId);\n            if (maxLength !== null) {\n              maxLengths[newEntityId] = maxLength;\n            } else {\n              maxLengths[newEntityId] = 255;\n            }\n          }\n\n          // Versuche erneut zu verteilen\n          while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n            const currentEntityId = allEntityIds[currentEntityIndex];\n            const maxLength = maxLengths[currentEntityId];\n\n            const charsToTake = Math.min(remainingData.length, maxLength);\n            const valueToWrite = remainingData.substring(0, charsToTake);\n\n            entityValues[currentEntityId] = valueToWrite;\n            remainingData = remainingData.substring(charsToTake);\n\n            if (remainingData.length > 0) {\n              currentEntityIndex++;\n            }\n          }\n        }\n      }\n\n      // Schreibe alle Entity-Werte\n      for (const [entityId, value] of Object.entries(entityValues)) {\n        try {\n          await this._hass.callService('input_text', 'set_value', {\n            entity_id: entityId,\n            value: value,\n          });\n          this._debug(\n            `[EntityStorage] saveData: Entity \"${entityId}\" geschrieben, Lnge: ${value.length} Zeichen`\n          );\n        } catch (error) {\n          this._debug(\n            `[EntityStorage] saveData: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n          );\n        }\n      }\n\n      this._debug('[EntityStorage] saveData: Erfolgreich abgeschlossen');\n    } catch (error) {\n      this._debug(`[EntityStorage] saveData: Fehler: ${error.message}`, error);\n      throw error;\n    }\n  }\n\n  async loadData() {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] loadData: Nicht verfgbar');\n      return null;\n    }\n\n    this._debug(\n      `[EntityStorage] loadData: Start, entity: \"${this._config.entity}\"`\n    );\n\n    // Ermittle die maximale Lnge fr alle Entities\n    const maxLengths = this.getAllEntityMaxLengths();\n\n    // Sammle alle Daten-Strings aus der Haupt-Entity und zustzlichen Entities\n    const dataStrings = [];\n    const baseEntityId = this._config.entity;\n    const additionalEntities = this.findAdditionalEntities(baseEntityId);\n\n    this._debug(\n      `[EntityStorage] loadData: Gefundene Entities: Haupt: \"${baseEntityId}\", Zustzliche: ${additionalEntities.length}`\n    );\n\n    // Speichere die Liste der bekannten Entities\n    this._knownEntityIds = [baseEntityId, ...additionalEntities];\n\n    // Lade Daten aus allen Entities\n    for (const entityId of this._knownEntityIds) {\n      const entity = this._hass.states[entityId];\n      if (entity && entity.state && entity.state.trim() !== '') {\n        const entityData = entity.state;\n        dataStrings.push(entityData);\n        this._debug(\n          `[EntityStorage] loadData: Entity \"${entityId}\" hat Daten, Lnge: ${entityData.length} Zeichen`\n        );\n      } else {\n        this._debug(\n          `[EntityStorage] loadData: Entity \"${entityId}\" ist leer oder nicht vorhanden`\n        );\n      }\n    }\n\n    // Fge alle Strings zusammen (mit \";\" als Trennzeichen)\n    if (dataStrings.length > 0) {\n      const dataString = dataStrings.join(';');\n      this._debug(\n        `[EntityStorage] loadData: Daten kombiniert, Gesamtlnge: ${dataString.length} Zeichen`\n      );\n      return dataString;\n    } else {\n      this._debug('[EntityStorage] loadData: Keine Daten in Entities gefunden');\n      return null;\n    }\n  }\n\n  /**\n   * Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n   * @private\n   */\n  _createCompressedConfig(activeShifts) {\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n    }\n\n    // Entferne \"null\" aus dem String\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      configJson = configJson.replace(/,null,/g, ',,');\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    configJson = configJson.replace(/\",\"/g, ',');\n    configJson = configJson.replace(/\\[\"/g, '[');\n    configJson = configJson.replace(/\"\\]/g, ']');\n    configJson = configJson.replace(/,\"/g, ',');\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n  }\n\n  /**\n   * Ermittelt die Config-Entity-ID\n   * @private\n   */\n  getConfigEntityId() {\n    if (!this._config || !this._config.entity) {\n      return null;\n    }\n    return this._config.entity + '_config';\n  }\n\n  /**\n   * Ermittelt die Status-Entity-ID\n   * @private\n   */\n  getStatusEntityId() {\n    if (!this._config || !this._config.entity) {\n      return null;\n    }\n    return this._config.entity + '_status';\n  }\n\n  async saveConfig(activeShifts) {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] saveConfig: Nicht verfgbar');\n      return;\n    }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._debug('[EntityStorage] saveConfig: Keine configEntityId');\n      return;\n    }\n\n    this._debug(`[EntityStorage] saveConfig: Start, configEntityId: \"${configEntityId}\"`);\n\n    // Prfe ob die Entity existiert\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      this._debug(`[EntityStorage] saveConfig: Entity \"${configEntityId}\" existiert nicht`);\n      return;\n    }\n\n    // Komprimiertes Format fr text_input Entities\n    const configJson = this._createCompressedConfig(activeShifts);\n    const configJsonLength = configJson.length;\n\n    this._debug(\n      `[EntityStorage] saveConfig: Config erstellt (komprimiert), Lnge: ${configJsonLength} Zeichen`\n    );\n\n    // Prfe ob der JSON-Text in das Entity passt\n    const maxLength = this.getEntityMaxLength(configEntityId);\n    if (maxLength !== null && configJsonLength > maxLength) {\n      this._debug(\n        `[EntityStorage] saveConfig: Config ist zu lang (${configJsonLength} > ${maxLength} Zeichen)`\n      );\n      // Warnung wird von getWarnings() zurckgegeben\n    }\n\n    try {\n      await this._hass.callService('input_text', 'set_value', {\n        entity_id: configEntityId,\n        value: configJson,\n      });\n      this._debug(`[EntityStorage] saveConfig: Config erfolgreich gespeichert`);\n    } catch (error) {\n      this._debug(`[EntityStorage] saveConfig: Fehler beim Speichern: ${error.message}`, error);\n      throw error;\n    }\n  }\n\n  async loadConfig() {\n    if (!this.isAvailable()) {\n      this._debug('[EntityStorage] loadConfig: Nicht verfgbar');\n      return null;\n    }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      return null;\n    }\n\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity || !configEntity.state || configEntity.state.trim() === '') {\n      return null;\n    }\n\n    return configEntity.state;\n  }\n\n  checkStorageUsage(dataLength = null) {\n    if (!this.isAvailable()) {\n      return null;\n    }\n\n    const allEntityIds = this._getAllEntityIds();\n    const maxLengths = this.getAllEntityMaxLengths();\n\n    if (Object.keys(maxLengths).length === 0) {\n      return null;\n    }\n\n    // Berechne Gesamtlnge und maximale Gesamtlnge\n    let totalCurrentLength = 0;\n    let totalMaxLength = 0;\n\n    if (dataLength !== null && dataLength !== undefined) {\n      totalCurrentLength = dataLength;\n    } else {\n      // Lese Lngen aus den aktuellen States\n      for (const entityId of allEntityIds) {\n        const entity = this._hass.states[entityId];\n        if (entity && entity.state) {\n          totalCurrentLength += entity.state.length;\n        }\n      }\n    }\n\n    // Berechne maximale Gesamtlnge\n    for (const entityId of allEntityIds) {\n      const maxLength = maxLengths[entityId];\n      if (maxLength !== undefined && maxLength !== null) {\n        totalMaxLength += maxLength;\n      }\n    }\n\n    if (totalMaxLength === 0) {\n      return null;\n    }\n\n    const percentage = (totalCurrentLength / totalMaxLength) * 100;\n\n    // Prfe ob 90% berschritten werden\n    if (percentage >= 90) {\n      return {\n        show: true,\n        currentLength: totalCurrentLength,\n        maxLength: totalMaxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n    }\n\n    return null;\n  }\n\n  getWarnings() {\n    if (!this.isAvailable()) {\n      return null;\n    }\n\n    const warnings = {\n      config: null,\n      status: null,\n    };\n\n    // Prfe Config-Entity\n    const configEntityId = this.getConfigEntityId();\n    if (configEntityId) {\n      if (!this._hass || !this._hass.states[configEntityId]) {\n        warnings.config = {\n          show: true,\n          type: 'missing',\n          configEntityId: configEntityId,\n        };\n      }\n    }\n\n    // Prfe Status-Entity\n    const statusEntityId = this.getStatusEntityId();\n    if (statusEntityId) {\n      if (!this._hass || !this._hass.states[statusEntityId]) {\n        warnings.status = {\n          show: true,\n          type: 'missing',\n          statusEntityId: statusEntityId,\n        };\n      }\n    }\n\n    return warnings.config || warnings.status ? warnings : null;\n  }\n}\n\n","/**\n * Storage-Factory\n * \n * Erstellt den passenden Storage-Adapter basierend auf dem store_mode\n */\n\nimport { SaverStorage } from './saver-storage.js';\nimport { EntityStorage } from './entity-storage.js';\n\nexport class StorageFactory {\n  /**\n   * Erstellt den passenden Storage-Adapter\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @param {Function} debug - Debug-Funktion\n   * @returns {IStorageAdapter} - Der passende Storage-Adapter\n   */\n  static createStorage(hass, config, debug) {\n    const storeMode = config?.store_mode || 'text_entity';\n\n    // Prfe welche Storage-Implementierung verwendet werden soll\n    if (SaverStorage.isApplicable(storeMode)) {\n      debug('[StorageFactory] Erstelle SaverStorage');\n      return new SaverStorage(hass, config, debug);\n    } else if (EntityStorage.isApplicable(storeMode)) {\n      debug('[StorageFactory] Erstelle EntityStorage');\n      return new EntityStorage(hass, config, debug);\n    } else {\n      // Fallback zu EntityStorage\n      debug('[StorageFactory] Unbekannter store_mode, verwende EntityStorage als Fallback');\n      return new EntityStorage(hass, config, debug);\n    }\n  }\n\n  /**\n   * Prft, ob ein bestimmter Storage-Typ verfgbar ist\n   * @param {string} storeMode - Der store_mode\n   * @param {Object} hass - Home Assistant Objekt\n   * @param {Object} config - Konfiguration\n   * @returns {boolean}\n   */\n  static isStorageAvailable(storeMode, hass, config) {\n    const storage = this.createStorage(hass, config, () => {});\n    return storage.isAvailable();\n  }\n}\n\n","/**\n * HolidayMixin - Feiertags-Berechnung fr deutsche Feiertage\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._holidayCache` - Cache-Objekt: `{}`\n * - `this._cachedHolidayEntities` - Array oder null\n * - `this._hass` - Home Assistant Objekt (optional, fr Holiday-Entities)\n * - `this.config` - Konfigurationsobjekt mit `holidays` Property (optional)\n * \n * @example\n * import { HolidayMixin } from './mixins/holiday-mixin';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     this._holidayCache = {};\n *     this._cachedHolidayEntities = null;\n *     Object.assign(this, HolidayMixin);\n *   }\n * }\n */\nexport const HolidayMixin = {\n  /**\n   * Berechnet das Osterdatum fr ein gegebenes Jahr (nach Gau-Algorithmus)\n   * @param {number} year - Jahr (z.B. 2025)\n   * @returns {Date} Osterdatum\n   */\n  _getEasterDate(year) {\n    const a = year % 19;\n    const b = Math.floor(year / 100);\n    const c = year % 100;\n    const d = Math.floor(b / 4);\n    const e = b % 4;\n    const f = Math.floor((b + 8) / 25);\n    const g = Math.floor((b - f + 1) / 3);\n    const h = (19 * a + b - d - g + 15) % 30;\n    const i = Math.floor(c / 4);\n    const k = c % 4;\n    const l = (32 + 2 * e + 2 * i - h - k) % 7;\n    const m = Math.floor((a + 11 * h + 22 * l) / 451);\n    const month = Math.floor((h + l - 7 * m + 114) / 31);\n    const day = ((h + l - 7 * m + 114) % 31) + 1;\n    return new Date(year, month - 1, day);\n  },\n\n  /**\n   * Prft ob ein Datum ein Feiertag ist (mit Cache)\n   * Versucht zuerst Home Assistant Holiday-Sensoren zu verwenden, falls vorhanden\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @param {number} day - Tag (1-31)\n   * @returns {boolean} true wenn Feiertag\n   */\n  _isHoliday(year, month, day) {\n    // Cache-Key: \"2025-12\" fr Monat/Jahr\n    const cacheKey = `${year}-${String(month + 1).padStart(2, '0')}`;\n\n    // Prfe Cache\n    if (this._holidayCache && this._holidayCache[cacheKey] && this._holidayCache[cacheKey][day] !== undefined) {\n      return this._holidayCache[cacheKey][day];\n    }\n\n    // Initialisiere Cache fr diesen Monat\n    if (!this._holidayCache) {\n      this._holidayCache = {};\n    }\n    if (!this._holidayCache[cacheKey]) {\n      this._holidayCache[cacheKey] = {};\n    }\n\n    let result = false;\n\n    // Prfe ob Home Assistant Holiday-Sensoren verfgbar sind\n    if (this._hass && this._hass.states) {\n      // Suche nach Holiday-Sensoren (z.B. sensor.germany_holidays, sensor.holidays, etc.)\n      // OPTIMIERUNG: Cache Holiday-Entities, nicht bei jedem Aufruf suchen\n      if (!this._cachedHolidayEntities) {\n        this._cachedHolidayEntities = Object.keys(this._hass.states).filter(entityId => {\n          return (\n            entityId.startsWith('sensor.') &&\n            (entityId.includes('holiday') || entityId.includes('feiertag')) &&\n            this._hass.states[entityId].state === 'on'\n          );\n        });\n      }\n\n      const holidayEntities = this._cachedHolidayEntities;\n\n      if (holidayEntities.length > 0) {\n        // Prfe ob das Datum in den Holiday-Attributen enthalten ist\n        for (const entityId of holidayEntities) {\n          const entity = this._hass.states[entityId];\n          if (entity && entity.attributes) {\n            // Prfe verschiedene mgliche Attribute-Formate\n            const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n            const dateStrShort = `${String(day).padStart(2, '0')}.${String(month + 1).padStart(2, '0')}.${year}`;\n\n            // Prfe verschiedene Attribute-Namen\n            const possibleAttrs = [\n              'dates',\n              'holidays',\n              'feiertage',\n              'date',\n              'next_date',\n              'upcoming',\n            ];\n            for (const attr of possibleAttrs) {\n              if (entity.attributes[attr]) {\n                const attrValue = entity.attributes[attr];\n                if (Array.isArray(attrValue)) {\n                  if (\n                    attrValue.some(\n                      d =>\n                        d === dateStr ||\n                        d === dateStrShort ||\n                        d.includes(dateStr) ||\n                        d.includes(dateStrShort)\n                    )\n                  ) {\n                    result = true;\n                    break;\n                  }\n                } else if (typeof attrValue === 'string') {\n                  if (attrValue.includes(dateStr) || attrValue.includes(dateStrShort)) {\n                    result = true;\n                    break;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Hole Feiertags-Konfiguration aus der Config (Standard: alle aktiviert)\n    const holidaysConfig = this.config?.holidays || {};\n    const isHolidayEnabled = key => holidaysConfig[key] !== false; // Default: true wenn nicht gesetzt\n\n    // Fallback: Berechne deutsche Feiertage selbst\n    const easter = this._getEasterDate(year);\n\n    // Feste Feiertage mit Konfigurationsprfung\n    const fixedHolidays = [\n      { month: 0, day: 1, key: 'neujahr' }, // Neujahr\n      { month: 0, day: 6, key: 'heilige_drei_koenige' }, // Heilige Drei Knige\n      { month: 4, day: 1, key: 'tag_der_arbeit' }, // Tag der Arbeit\n      { month: 7, day: 8, key: 'friedensfest' }, // Friedensfest (nur in Augsburg)\n      { month: 7, day: 15, key: 'mariae_himmelfahrt' }, // Mari Himmelfahrt\n      { month: 9, day: 3, key: 'tag_der_deutschen_einheit' }, // Tag der Deutschen Einheit\n      { month: 9, day: 31, key: 'reformationstag' }, // Reformationstag\n      { month: 10, day: 1, key: 'allerheiligen' }, // Allerheiligen\n      { month: 11, day: 25, key: 'weihnachten_1' }, // 1. Weihnachtsfeiertag\n      { month: 11, day: 26, key: 'weihnachten_2' }, // 2. Weihnachtsfeiertag\n    ];\n\n    if (!result) {\n      // Prfe feste Feiertage\n      for (const holiday of fixedHolidays) {\n        if (month === holiday.month && day === holiday.day && isHolidayEnabled(holiday.key)) {\n          result = true;\n          break;\n        }\n      }\n    }\n\n    if (!result) {\n      // Bewegliche Feiertage (abhngig von Ostern)\n      const easterTime = easter.getTime();\n      const oneDay = 24 * 60 * 60 * 1000;\n\n      // Bu- und Bettag: Mittwoch vor dem 23. November (oder am 23. November, falls es ein Mittwoch ist)\n      const nov23 = new Date(year, 10, 23); // 23. November (month ist 0-basiert)\n      const dayOfWeekNov23 = nov23.getDay(); // 0 = Sonntag, 1 = Montag, ..., 3 = Mittwoch, ..., 6 = Samstag\n      // Berechne wie viele Tage zurck zum Mittwoch\n      const daysToSubtract = dayOfWeekNov23 <= 3 ? 3 - dayOfWeekNov23 : dayOfWeekNov23 + 7 - 3;\n      const busstag = new Date(year, 10, 23 - daysToSubtract);\n\n      const movableHolidays = [\n        { date: new Date(easterTime - 2 * oneDay), key: 'karfreitag' }, // Karfreitag\n        { date: new Date(easterTime + 1 * oneDay), key: 'ostermontag' }, // Ostermontag\n        { date: new Date(easterTime + 39 * oneDay), key: 'christi_himmelfahrt' }, // Christi Himmelfahrt\n        { date: new Date(easterTime + 50 * oneDay), key: 'pfingstmontag' }, // Pfingstmontag\n        { date: new Date(easterTime + 60 * oneDay), key: 'fronleichnam' }, // Fronleichnam (nur in bestimmten Bundeslndern)\n        { date: busstag, key: 'busstag' }, // Bu- und Bettag (nur in Sachsen)\n      ];\n\n      // Prfe bewegliche Feiertage\n      for (const holiday of movableHolidays) {\n        if (\n          holiday.date.getFullYear() === year &&\n          holiday.date.getMonth() === month &&\n          holiday.date.getDate() === day &&\n          isHolidayEnabled(holiday.key)\n        ) {\n          result = true;\n          break;\n        }\n      }\n    }\n\n    // Cache speichern\n    this._holidayCache[cacheKey][day] = result;\n\n    return result;\n  },\n\n  /**\n   * Prft ob ein Datum ein Wochenende ist\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @param {number} day - Tag (1-31)\n   * @returns {boolean} true wenn Wochenende (Samstag oder Sonntag)\n   */\n  _isWeekend(year, month, day) {\n    const date = new Date(year, month, day);\n    const dayOfWeek = date.getDay();\n    return dayOfWeek === 0 || dayOfWeek === 6; // Sonntag = 0, Samstag = 6\n  },\n};\n\n","/**\n * DataManagementMixin - Serialisierung und Parsing von WorkingDays\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._workingDays` - Objekt mit WorkingDays-Daten: `{\"year:month\": {day: [elements]}}`\n * - `this.formatTwoDigits()` - Methode aus DateUtils (wird per Object.assign hinzugefgt)\n * \n * @example\n * import { DataManagementMixin } from './mixins/data-management-mixin';\n * import { DateUtils } from '../../utils/date-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     this._workingDays = {};\n *     Object.assign(this, DateUtils, DataManagementMixin);\n *   }\n * }\n */\nexport const DataManagementMixin = {\n  /**\n   * Serialisiert WorkingDays zu String-Format\n   * Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>;<jahr>:<monat>:<tag><elementen>\n   * Beispiel: \"25:11:01a,02ab,03b;25:12:01a,09a\"\n   * @returns {string} Serialisierte Daten\n   */\n  serializeWorkingDays() {\n    const parts = [];\n    // Sortiere nach Jahr:Monat\n    const keys = Object.keys(this._workingDays).sort((a, b) => {\n      const [yearA, monthA] = a.split(':').map(x => parseInt(x));\n      const [yearB, monthB] = b.split(':').map(x => parseInt(x));\n      if (yearA !== yearB) return yearA - yearB;\n      return monthA - monthB;\n    });\n\n    for (const key of keys) {\n      const days = this._workingDays[key];\n      if (!days || typeof days !== 'object' || Array.isArray(days)) continue;\n\n      // Struktur: {day: [elements]}\n      const dayEntries = Object.keys(days)\n        .map(d => parseInt(d))\n        .filter(d => !isNaN(d))\n        .sort((a, b) => a - b);\n\n      if (dayEntries.length > 0) {\n        // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n        // Beispiel: \"25:11:01a,02ab,03b\"\n        const formattedDays = dayEntries\n          .map(dayNum => {\n            const elements = days[dayNum];\n            const dayStr = this.formatTwoDigits(dayNum);\n            if (Array.isArray(elements) && elements.length > 0) {\n              // Sortiere die Kalender-Shortcuts alphabetisch (a, b, c, d, e) fr konsistente Reihenfolge\n              const sortedElements = [...elements].sort();\n              // Tag mit Elementen: \"01a\", \"02ab\", etc.\n              return dayStr + sortedElements.join('');\n            } else {\n              // Tag ohne Elemente\n              return dayStr;\n            }\n          })\n          .join(',');\n        parts.push(`${key}:${formattedDays}`);\n      }\n    }\n    return parts.join(';');\n  },\n\n  /**\n   * Parst Daten-String zu WorkingDays-Objekt\n   * @param {string} dataString - Serialisierte Daten\n   */\n  parseWorkingDays(dataString) {\n    this._workingDays = {};\n    this._parseWorkingDaysIntoObject(dataString, this._workingDays);\n  },\n\n  /**\n   * Parst Daten-String in ein Ziel-Objekt\n   * @private\n   * @param {string} dataString - Serialisierte Daten\n   * @param {Object} targetObject - Ziel-Objekt fr die geparsten Daten\n   */\n  _parseWorkingDaysIntoObject(dataString, targetObject) {\n    if (!dataString || dataString.trim() === '') return;\n\n    const parts = dataString.split(';').filter(p => p.trim() !== '');\n    for (const part of parts) {\n      const trimmedPart = part.trim();\n      if (!trimmedPart) continue;\n\n      // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen> oder altes Format\n      // Beispiel: \"25:11:01a,02ah,03b\" oder \"25:11:01,02,03\" (altes Format ohne Elemente)\n      const colons = trimmedPart.split(':');\n\n      if (colons.length === 2) {\n        // Altes Format ohne Jahr (Kompatibilitt): <monat>:<tag>,<tag>\n        const month = colons[0].trim();\n        const daysStr = colons[1].trim();\n        if (month && daysStr) {\n          const monthNum = parseInt(month);\n          if (!isNaN(monthNum) && monthNum >= 1 && monthNum <= 12) {\n            // Verwende aktuelles Jahr\n            const now = new Date();\n            const year = now.getFullYear() % 100;\n            const key = `${this.formatTwoDigits(year)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        }\n      } else if (colons.length >= 3) {\n        // Prfe ob erstes Element ein Jahr ist (kleiner als 13) oder ein Monat\n        const first = parseInt(colons[0].trim());\n        const second = parseInt(colons[1].trim());\n\n        if (first <= 12 && second > 12) {\n          // Altes Format: <monat>:<jahr>:<tag>,<tag> - konvertiere zu neuem Format\n          const monthNum = first;\n          const yearNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        } else if (first > 12 && second <= 12) {\n          // Neues Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n          const yearNum = first;\n          const monthNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Parst Tage mit Elementen: \"01a,02ah,03b\" -> {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]}\n   * Oder altes Format ohne Elemente: \"01,02,03\" -> {1: [], 2: [], 3: []}\n   * @private\n   * @param {string} daysStr - String mit Tagen und Elementen\n   * @returns {Object} Objekt mit Tagen als Keys und Elementen als Arrays\n   */\n  _parseDaysWithElements(daysStr) {\n    const result = {};\n    const dayEntries = daysStr.split(',').filter(d => d.trim() !== '');\n\n    for (const entry of dayEntries) {\n      const trimmed = entry.trim();\n      if (!trimmed) continue;\n\n      // Extrahiere Tag und Elemente: \"01a\" -> day=1, elements=[\"a\"]\n      // Oder: \"02ah\" -> day=2, elements=[\"a\", \"h\"]\n      // Oder altes Format: \"01\" -> day=1, elements=[]\n      const match = trimmed.match(/^(\\d+)([a-z]*)$/i);\n      if (match) {\n        const dayNum = parseInt(match[1]);\n        const elementsStr = match[2] || '';\n        // WICHTIG: Filtere nur leere Strings heraus, nicht einzelne Buchstaben\n        // split('') teilt jeden Buchstaben in ein separates Array-Element\n        const elements = elementsStr.split('').filter(e => e && e.trim() !== '');\n\n        if (!isNaN(dayNum) && dayNum >= 1 && dayNum <= 31) {\n          // Wenn der Tag bereits existiert, fge Elemente hinzu (keine Duplikate)\n          if (result[dayNum]) {\n            // Vereinige Arrays und entferne Duplikate\n            result[dayNum] = [...new Set([...result[dayNum], ...elements])];\n          } else {\n            result[dayNum] = elements;\n          }\n        }\n      } else {\n        // Debug-Log wenn kein Match gefunden wurde (nur wenn _debug vorhanden)\n        if (trimmed.includes('03') && this._debug) {\n          this._debug(`[Parsing] Kein Match fr \"${trimmed}\"`);\n        }\n      }\n    }\n\n    return result;\n  },\n};\n\n","/**\n * CalendarMixin - Kalender-Management und -Berechnungen\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this.config` - Konfigurationsobjekt mit `calendars` Array\n * - `this._selectedCalendar` - String mit dem Shortcut des ausgewhlten Kalenders\n * \n * **Statische Konstante (muss in Hauptklasse definiert werden):**\n * - `ShiftScheduleView.CALENDARS` - Array mit Standard-Kalender-Definitionen\n * \n * @example\n * import { CalendarMixin } from './mixins/calendar-mixin';\n * class MyView extends LitElement {\n *   static CALENDARS = [\n *     { shortcut: 'a', name: 'Schicht A', defaultColor: '#ff9800' },\n *     // ...\n *   ];\n *   \n *   constructor() {\n *     super();\n *     this._selectedCalendar = null;\n *     Object.assign(this, CalendarMixin);\n *   }\n * }\n */\nexport const CalendarMixin = {\n  /**\n   * Gibt alle aktivierten Kalender zurck\n   * @returns {Array} Array von Kalender-Objekten, sortiert nach Shortcut\n   */\n  _getAllCalendars() {\n    // Gibt nur aktivierte Kalender zurck\n    if (!this._config?.calendars) {\n      return [];\n    }\n\n    // Filtere nur aktivierte Kalender und sortiere nach Shortcut (a, b, c, d, e)\n    return this._config.calendars\n      .filter(\n        cal =>\n          cal &&\n          cal.shortcut &&\n          (cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1)\n      )\n      .sort((a, b) => a.shortcut.localeCompare(b.shortcut));\n  },\n\n  /**\n   * Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n   * @param {string} shortcut - Shortcut des Kalenders (z.B. 'a', 'b', 'c')\n   * @returns {Object|null} Kalender-Objekt oder null wenn nicht gefunden\n   */\n  _getCalendarByShortcut(shortcut) {\n    // Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n    if (!this._config?.calendars) {\n      return null;\n    }\n\n    return this._config.calendars.find(cal => cal.shortcut === shortcut) || null;\n  },\n\n  /**\n   * Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n   * @param {string} shortcut - Shortcut des Kalenders (z.B. 'a', 'b', 'c')\n   * @returns {string} Hex-Farbe (z.B. '#ff9800')\n   */\n  _getDefaultColorForShortcut(shortcut) {\n    // Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n    // Prfe ob die Hauptklasse eine CALENDARS-Konstante hat\n    const CalendarsClass = this.constructor;\n    if (CalendarsClass && CalendarsClass.CALENDARS) {\n      const defaultCalendar = CalendarsClass.CALENDARS.find(cal => cal.shortcut === shortcut);\n      return defaultCalendar ? defaultCalendar.defaultColor : '#ff9800';\n    }\n    // Fallback, falls CALENDARS nicht definiert ist\n    return '#ff9800';\n  },\n\n  /**\n   * Gibt den Shortcut des ausgewhlten Kalenders zurck\n   * @returns {string|null} Shortcut des ausgewhlten Kalenders oder null\n   */\n  _getSelectedCalendarShortcut() {\n    // Gibt den Shortcut des ausgewhlten Kalenders zurck\n\n    // Prfe zuerst _selectedCalendar\n    if (\n      this._selectedCalendar !== null &&\n      this._selectedCalendar !== undefined &&\n      this._selectedCalendar !== ''\n    ) {\n      return this._selectedCalendar;\n    }\n\n    // Falls _selectedCalendar nicht gesetzt ist, prfe die Config\n    if (this._config?.selectedCalendar) {\n      this._selectedCalendar = this._config.selectedCalendar;\n      return this._selectedCalendar;\n    }\n\n    // Fallback: Verwende den ersten aktivierten Kalender\n    const allCalendars = this._getAllCalendars();\n    if (allCalendars.length > 0) {\n      return allCalendars[0].shortcut;\n    }\n    // Wenn kein Kalender aktiviert ist, gibt es keinen Fallback\n    return null;\n  },\n};\n\n","/**\n * ConfigManagementMixin - Config-Format-Konvertierung\n * \n * Wiederverwendbar in anderen Projekten!\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._config` - Konfigurationsobjekt\n * \n * @example\n * import { ConfigManagementMixin } from './mixins/config-management-mixin';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, ConfigManagementMixin);\n *   }\n * }\n */\nexport const ConfigManagementMixin = {\n  /**\n   * Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n   * Entfernt Anfhrungszeichen und null-Werte fr kompakte Speicherung\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {string} Komprimierte Config als String\n   */\n  _createCompressedConfig(activeShifts) {\n    // Speichere als JSON (direktes Array, kein Objekt-Wrapper)\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer (erstes [ und letztes ])\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n    }\n\n    // Entferne \"null\" aus dem String (behalte Kommas)\n    // Wiederhole die Ersetzung, bis keine null mehr vorhanden sind (fr mehrere null hintereinander)\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      // Ersetze ,null, durch ,, (mehrfach, bis keine null mehr vorhanden sind)\n      configJson = configJson.replace(/,null,/g, ',,');\n      // Ersetze ,null] durch ,] (falls am Ende eines Arrays)\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      // Ersetze [null, durch [, (falls am Anfang eines Arrays)\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      // Ersetze ,null, am Ende des Strings (falls letztes Element null ist)\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    // Ersetze \",\" durch , (Anfhrungszeichen um Kommas)\n    configJson = configJson.replace(/\",\"/g, ',');\n    // Ersetze [\" durch [ (Anfhrungszeichen am Anfang eines Arrays)\n    configJson = configJson.replace(/\\[\"/g, '[');\n    // Ersetze \"] durch ] (Anfhrungszeichen am Ende eines Arrays)\n    configJson = configJson.replace(/\"\\]/g, ']');\n    // Ersetze ,\" durch , (Anfhrungszeichen nach Komma)\n    configJson = configJson.replace(/,\"/g, ',');\n    // Ersetze \", durch , (Anfhrungszeichen vor Komma)\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n  },\n\n  /**\n   * Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n   * @param {Array} activeShifts - Array der aktiven Schichten\n   * @returns {string} Vollstndiges JSON als String\n   */\n  _createFullJsonConfig(activeShifts) {\n    // Vollstndiges JSON-Format: Objekt mit shifts, setup und lastchange\n    // Format: {shifts:[], setup:{}, lastchange:123456789}\n    const configObject = {\n      shifts: activeShifts,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp (Sekunden seit 1970-01-01)\n    };\n    return JSON.stringify(configObject);\n  },\n};\n\n","/**\n * RenderingMixin - DOM-Manipulation und Rendering-Helper\n * \n * **Abhngigkeiten (mssen in der Hauptklasse initialisiert werden):**\n * - `this._workingDays` - WorkingDays-Daten\n * - `this._storageWarning` - Storage-Warnung\n * - `this._configWarning` - Config-Warnung\n * - `this._statusWarning` - Status-Warnung\n * - `this._config` - Konfiguration\n * - `this._isInEditorMode()` - Methode aus Hauptklasse\n * - `this._getSelectedCalendarShortcut()` - Methode aus CalendarMixin\n * - `this._getCalendarByShortcut()` - Methode aus CalendarMixin\n * - `this._isHoliday()` - Methode aus HolidayMixin\n * - `this._isWeekend()` - Methode aus HolidayMixin\n * - `this._getContrastColor()` - Methode aus ColorUtils\n * - `this.formatTwoDigits()` - Methode aus DateUtils\n * - `this.getDaysInMonth()` - Methode aus DateUtils\n * - `this.getFirstDayOfMonth()` - Methode aus DateUtils\n * - `this.getMonthName()` - Methode aus DateUtils\n * \n * @example\n * import { RenderingMixin } from './mixins/rendering-mixin';\n * import { HolidayMixin } from './mixins/holiday-mixin';\n * import { CalendarMixin } from './mixins/calendar-mixin';\n * import { DateUtils } from '../../utils/date-utils';\n * import { ColorUtils } from '../../utils/color-utils';\n * \n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, HolidayMixin, CalendarMixin, DateUtils, ColorUtils, RenderingMixin);\n *   }\n * }\n */\nexport const RenderingMixin = {\n  /**\n   * Gibt die Elemente fr einen bestimmten Tag zurck\n   * @param {string} monthKey - Monats-Key (z.B. \"25:11\")\n   * @param {number} day - Tag (1-31)\n   * @returns {Array} Array von Elementen (z.B. [\"a\", \"b\"])\n   */\n  _getDayElements(monthKey, day) {\n    // Gibt die Elemente fr einen bestimmten Tag zurck\n    // Reduziere Debug-Ausgaben: Nur bei ersten 3 Tagen oder wenn keine Daten gefunden werden\n    const shouldDebug = day <= 3 || !this._workingDays[monthKey];\n    \n    if (shouldDebug && this._debug) {\n      this._debug(`[Render] _getDayElements: Suche nach monthKey=\"${monthKey}\", day=${day}`);\n    }\n    \n    if (!this._workingDays[monthKey] || typeof this._workingDays[monthKey] !== 'object') {\n      if (shouldDebug && this._debug) {\n        this._debug(`[Render] _getDayElements: Keine Daten fr monthKey=\"${monthKey}\" gefunden oder kein Objekt`);\n        this._debug(`[Render] _getDayElements: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n      }\n      return [];\n    }\n\n    if (Array.isArray(this._workingDays[monthKey])) {\n      // Altes Format: Array von Tagen\n      if (shouldDebug && this._debug) {\n        this._debug(`[Render] _getDayElements: Altes Format (Array) fr monthKey=\"${monthKey}\"`);\n      }\n      return [];\n    }\n\n    const elements = this._workingDays[monthKey][day] || [];\n    if (shouldDebug && elements.length > 0 && this._debug) {\n      this._debug(`[Render] _getDayElements: Gefundene Elemente fr \"${monthKey}\", Tag ${day}:`, elements);\n    }\n\n    return elements;\n  },\n\n  /**\n   * Rendert eine Warnung fr eine fehlende Entity\n   * @param {string} entityId - Entity-ID (z.B. \"input_text.config\")\n   * @param {string} entityName - Name der Entity (z.B. \"Konfigurations-Entity\")\n   * @param {number} maxLength - Maximale Lnge (Standard: 255)\n   * @param {boolean} isConfig - Ob es eine Config-Entity ist\n   * @returns {TemplateResult} HTML-Template\n   */\n  _renderMissingEntityWarning(entityId, entityName, maxLength = 255, isConfig = false) {\n    const entityNameShort = entityId.replace('input_text.', '');\n    // html muss aus lit importiert werden - wird in Hauptklasse verwendet\n    const { html } = this.constructor.litHtml || {};\n    if (!html) {\n      // Fallback wenn html nicht verfgbar ist\n      return null;\n    }\n    \n    return html`\n      <div class=\"storage-warning\">\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">${entityName} fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${entityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hinzufgen  Text</li>\n              <li>Name: <code>${entityNameShort}</code></li>\n              <li>Maximale Lnge: <code>${maxLength}</code> Zeichen</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  },\n};\n\n","/**\n * DateUtils - Wiederverwendbare Datum-Utilities\n * \n * Diese Utilities knnen in anderen Projekten verwendet werden.\n * \n * @example\n * import { DateUtils } from './utils/date-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, DateUtils);\n *   }\n * }\n */\nexport const DateUtils = {\n  /**\n   * Formatiert eine Zahl auf zwei Ziffern (z.B. 1 -> \"01\", 25 -> \"25\")\n   * @param {number} num - Die zu formatierende Zahl\n   * @returns {string} Formatierte Zahl als String mit fhrender Null\n   */\n  formatTwoDigits(num) {\n    return String(num).padStart(2, '0');\n  },\n\n  /**\n   * Gibt die Anzahl der Tage in einem Monat zurck\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Anzahl der Tage im Monat\n   */\n  getDaysInMonth(year, month) {\n    return new Date(year, month + 1, 0).getDate();\n  },\n\n  /**\n   * Gibt den Wochentag des ersten Tages eines Monats zurck\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Wochentag (0 = Sonntag, 1 = Montag, ..., 6 = Samstag)\n   */\n  getFirstDayOfMonth(year, month) {\n    return new Date(year, month, 1).getDay();\n  },\n\n  /**\n   * Gibt den deutschen Monatsnamen zurck\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {string} Monatsname auf Deutsch\n   */\n  getMonthName(month) {\n    const months = [\n      'Januar',\n      'Februar',\n      'Mrz',\n      'April',\n      'Mai',\n      'Juni',\n      'Juli',\n      'August',\n      'September',\n      'Oktober',\n      'November',\n      'Dezember',\n    ];\n    return months[month] || '';\n  },\n\n  /**\n   * Gibt den ersten Wochentag eines Monats zurck (Montag = 0)\n   * @param {number} year - Jahr (z.B. 2025)\n   * @param {number} month - Monat (0-11, 0 = Januar)\n   * @returns {number} Wochentag mit Montag = 0 (0 = Montag, 1 = Dienstag, ..., 6 = Sonntag)\n   */\n  getFirstDayOfWeekMondayBased(year, month) {\n    const firstDay = this.getFirstDayOfMonth(year, month);\n    // Konvertiere von Sonntag=0 zu Montag=0\n    return (firstDay + 6) % 7;\n  },\n};\n\n","/**\n * ColorUtils - Wiederverwendbare Farb-Utilities\n * \n * Diese Utilities knnen in anderen Projekten verwendet werden.\n * \n * @example\n * import { ColorUtils } from './utils/color-utils';\n * class MyView extends LitElement {\n *   constructor() {\n *     super();\n *     Object.assign(this, ColorUtils);\n *   }\n * }\n */\nexport const ColorUtils = {\n  /**\n   * Berechnet die Kontrastfarbe (schwarz oder wei) fr eine gegebene Hintergrundfarbe\n   * Verwendet WCAG-Luminanz-Berechnung\n   * @param {string} hexColor - Hex-Farbe (z.B. \"#ff9800\" oder \"ff9800\")\n   * @returns {string} \"#000000\" fr helle Hintergrnde, \"#ffffff\" fr dunkle Hintergrnde\n   */\n  _getContrastColor(hexColor) {\n    if (!hexColor) return '#000000';\n\n    // Entferne # falls vorhanden\n    const hex = hexColor.replace('#', '');\n\n    // Konvertiere zu RGB\n    const r = parseInt(hex.substr(0, 2), 16);\n    const g = parseInt(hex.substr(2, 2), 16);\n    const b = parseInt(hex.substr(4, 2), 16);\n\n    // Berechne relative Luminanz (nach WCAG)\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n\n    // Wenn Luminanz > 0.5, verwende schwarz, sonst wei\n    return luminance > 0.5 ? '#000000' : '#ffffff';\n  },\n\n  /**\n   * Konvertiert eine Hex-Farbe zu RGB\n   * @param {string} hex - Hex-Farbe (z.B. \"#ff9800\" oder \"ff9800\")\n   * @returns {Object} {r, g, b} oder null bei Fehler\n   */\n  hexToRgb(hex) {\n    if (!hex) return null;\n\n    const cleanHex = hex.replace('#', '');\n    if (cleanHex.length !== 6) return null;\n\n    return {\n      r: parseInt(cleanHex.substr(0, 2), 16),\n      g: parseInt(cleanHex.substr(2, 2), 16),\n      b: parseInt(cleanHex.substr(4, 2), 16),\n    };\n  },\n\n  /**\n   * Konvertiert RGB zu Hex-Farbe\n   * @param {number} r - Rot (0-255)\n   * @param {number} g - Grn (0-255)\n   * @param {number} b - Blau (0-255)\n   * @returns {string} Hex-Farbe (z.B. \"#ff9800\")\n   */\n  rgbToHex(r, g, b) {\n    const toHex = (n) => {\n      const hex = Math.round(n).toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    };\n    return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n  },\n};\n\n","import { css } from 'lit';\n\n/**\n * Gemeinsame CSS-Styles fr Menu-Bars\n * Diese Styles werden von shiftschedule-view.js und shift-config-panel.js verwendet\n */\nexport const sharedMenuStyles = css`\n  /* Gemeinsame Vorlage fr Menu-Bar: a (links), b (zentriert), c (rechts), d (zentriert) */\n  .menu-bar-row {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n\n  .menu-bar-left {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    flex-shrink: 0;\n  }\n\n  .menu-bar-center {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex: 1;\n    min-width: 0;\n  }\n\n  .menu-bar-right {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    flex-shrink: 0;\n  }\n\n  .menu-bar-full-width {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n  }\n\n  .menu-button {\n    width: 32px;\n    height: 32px;\n    border-radius: 4px;\n    border: 1px solid var(--divider-color, #e0e0e0);\n    background-color: var(--primary-color, #03a9f4);\n    color: var(--text-primary-color, #ffffff);\n    font-size: 20px;\n    font-weight: bold;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition:\n      background-color 0.2s ease,\n      opacity 0.2s ease;\n  }\n\n  .menu-button:hover:not(:disabled) {\n    background-color: var(--primary-color-dark, #0288d1);\n  }\n\n  .menu-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .cancel-button {\n    background: none;\n    border: none;\n    color: var(--secondary-text-color, #757575);\n  }\n\n  .cancel-button:hover {\n    color: var(--error-color, #f44336);\n  }\n\n  .confirm-button {\n    background: none;\n    border: none;\n    color: var(--success-color, #4caf50);\n  }\n\n  .confirm-button:hover:not(:disabled) {\n    color: var(--success-color-dark, #45a049);\n    transform: scale(1.1);\n  }\n\n  .confirm-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .menu-controls {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 12px;\n  }\n\n  .menu-button.navigation-button {\n    background-color: var(--secondary-color, #757575);\n  }\n\n  .menu-button.navigation-button:hover:not(:disabled) {\n    background-color: var(--secondary-color-dark, #616161);\n  }\n\n  /* Gemeinsame Styles fr Farbleisten */\n  .shifts-color-bar,\n  .color-bar {\n    display: flex;\n    gap: 4px;\n    align-items: stretch;\n    width: 100%;\n  }\n\n  .shift-color-button,\n  .color-button {\n    flex: 1;\n    min-width: 0;\n    height: 30px;\n    border-radius: 4px;\n    border: 2px solid transparent;\n    cursor: pointer;\n    transition: all 0.2s;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 12px;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    padding: 0 4px;\n  }\n\n  .shift-color-button:hover,\n  .color-button:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n  }\n\n  .shift-color-button.selected,\n  .color-button.selected {\n    border: 3px solid var(--primary-color, #03a9f4);\n    box-shadow: \n      0 0 0 2px var(--card-background-color, #ffffff),\n      0 0 0 4px var(--primary-color, #03a9f4),\n      0 2px 8px rgba(0, 0, 0, 0.3);\n    transform: translateY(-1px);\n  }\n\n  .shift-color-button.disabled,\n  .color-button.disabled {\n    opacity: 0.3;\n  }\n\n  .shift-color-button.disabled::after,\n  .color-button.disabled::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: repeating-linear-gradient(\n      45deg,\n      transparent,\n      transparent 10px,\n      rgba(0, 0, 0, 0.1) 10px,\n      rgba(0, 0, 0, 0.1) 20px\n    );\n    pointer-events: none;\n  }\n`;\n\n","import { html } from 'lit';\n\n/**\n * Template-Funktion fr die gemeinsame Menu-Bar-Struktur\n * \n * @param {Object} options - Konfigurationsobjekt\n * @param {import('lit').TemplateResult|string} options.left - Inhalt fr menu-bar-left\n * @param {import('lit').TemplateResult|string} options.center - Inhalt fr menu-bar-center\n * @param {import('lit').TemplateResult|string} options.right - Inhalt fr menu-bar-right\n * @param {import('lit').TemplateResult|string} options.fullWidth - Inhalt fr menu-bar-full-width\n * @returns {import('lit').TemplateResult}\n */\nexport function renderMenuBar({ left = '', center = '', right = '', fullWidth = '' }) {\n  return html`\n    <div class=\"menu-bar-row\">\n      <div class=\"menu-bar-left\">${left}</div>\n      <div class=\"menu-bar-center\">${center}</div>\n      <div class=\"menu-bar-right\">${right}</div>\n    </div>\n    ${fullWidth ? html`<div class=\"menu-bar-full-width\">${fullWidth}</div>` : ''}\n  `;\n}\n","/**\n * ShiftConfigPanel - Konfigurationspanel fr Schichten\n * \n * Verwaltet die Konfiguration aller Schichten (aktiv/inaktiv, Reihenfolge, etc.)\n */\n\nimport { html, css, LitElement } from 'lit';\nimport { sharedMenuStyles } from './shared-menu-styles.js';\nimport { renderMenuBar } from './menu-bar-template.js';\nimport { Version } from '../../card-config.js';\n\nexport class ShiftConfigPanel extends LitElement {\n  static properties = {\n    calendars: {\n      type: Array,\n      hasChanged(newVal, oldVal) {\n        // Verhindere Updates wenn Panel bereits initialisiert wurde\n        // Nur beim ersten Setzen (oldVal ist undefined) erlauben wir Updates\n        if (oldVal === undefined) {\n          return true; // Erste Initialisierung erlauben\n        }\n        // Nach der Initialisierung: Ignoriere externe Updates\n        // Das Panel verwaltet seine eigenen calendars intern\n        return false;\n      }\n    },\n    selectedShortcut: { type: String },\n    hass: { type: Object },\n    _validationErrors: { type: Object, state: true },\n  };\n\n  static styles = [\n    sharedMenuStyles,\n    css`\n    :host {\n      display: block;\n      width: 100%;\n    }\n\n    /* Gemeinsame Menu-Styles werden aus shared-menu-styles.js importiert */\n\n    .config-menu-bar {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      padding: 12px;\n      background-color: var(--card-background-color, #ffffff);\n      border-radius: 4px 4px 0 0;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-bottom: none;\n    }\n\n    .config-panel {\n      background-color: var(--card-background-color, #ffffff);\n      border-radius: 0 0 4px 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-top: none;\n      display: flex;\n      flex-direction: column;\n      padding: 12px;\n      position: relative;\n      min-height: 200px;\n    }\n\n\n    /* Gemeinsame Menu-Styles und Farbleisten-Styles werden aus shared-menu-styles.js importiert */\n\n    .control-button {\n      width: 40px;\n      height: 40px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: background-color 0.2s;\n      font-size: 18px;\n    }\n\n    .control-button:hover:not(:disabled) {\n      background-color: var(--divider-color, #e0e0e0);\n    }\n\n    .control-button:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    .control-button.delete {\n      color: var(--error-color, #f44336);\n    }\n\n    .control-button.delete:hover:not(:disabled) {\n      background-color: var(--error-color, #f44336);\n      color: white;\n    }\n\n    .add-shift-color-button {\n      flex: 0 0 30px !important;\n      background-color: var(--divider-color, #e0e0e0) !important;\n      color: var(--primary-text-color, #212121);\n      font-size: 24px;\n      font-weight: bold;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border: 2px dashed var(--divider-color, #e0e0e0) !important;\n      min-width: 30px;\n      max-width: 30px;\n    }\n\n    .add-shift-color-button:hover:not(:disabled) {\n      background-color: var(--primary-color, #03a9f4) !important;\n      color: white;\n      border-color: var(--primary-color, #03a9f4) !important;\n    }\n\n    .add-shift-color-button:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n\n    .shift-item.disabled {\n      opacity: 0.5;\n    }\n\n    .shifts-list {\n      margin-bottom: 24px;\n    }\n\n    .shift-editor {\n      border-top: 1px solid var(--divider-color, #e0e0e0);\n      padding-top: 16px;\n      margin-top: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 20px;\n    }\n\n    .editor-row {\n      display: flex;\n      align-items: flex-start;\n      gap: 16px;\n      flex-wrap: wrap;\n    }\n\n    .editor-field {\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      min-width: 150px;\n    }\n\n    .editor-field.id-field {\n      flex: 0 0 auto;\n      min-width: 80px;\n      max-width: 100px;\n    }\n\n    .editor-field label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n      color: var(--primary-text-color, #212121);\n    }\n\n    ha-textfield[error] {\n      --mdc-text-field-outline-color: var(--error-color, #f44336);\n      --mdc-text-field-focus-outline-color: var(--error-color, #f44336);\n    }\n\n    .editor-section {\n      margin-bottom: 0;\n      flex: 1;\n      min-width: 100%;\n    }\n\n    .editor-section.full-width {\n      width: 100%;\n    }\n\n    .editor-section label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n      color: var(--primary-text-color, #212121);\n    }\n\n    .color-input-group {\n      display: flex;\n      gap: 12px;\n      align-items: center;\n      position: relative;\n    }\n\n    .color-picker-input {\n      position: absolute;\n      opacity: 0;\n      width: 0;\n      height: 0;\n      pointer-events: none;\n    }\n\n    .color-preview-large {\n      width: 60px;\n      height: 60px;\n      border-radius: 4px;\n      border: 2px solid var(--divider-color, #e0e0e0);\n      flex-shrink: 0;\n    }\n\n    .color-picker-input {\n      position: absolute;\n      opacity: 0;\n      width: 0;\n      height: 0;\n      pointer-events: none;\n    }\n\n    .action-buttons {\n      display: flex;\n      gap: 8px;\n      align-items: center;\n    }\n\n    .version-info {\n      position: absolute;\n      bottom: 8px;\n      right: 12px;\n      font-size: 11px;\n      color: var(--secondary-text-color, #757575);\n    }\n\n    .switch-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 12px;\n      flex: 1;\n      min-width: 200px;\n    }\n\n    .switch-label {\n      flex: 1;\n      font-size: 14px;\n      color: var(--primary-text-color, #000000);\n      cursor: pointer;\n    }\n\n    .switch-item ha-switch {\n      flex-shrink: 0;\n    }\n\n    .time-ranges-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n    }\n\n    .time-range-add-button {\n      width: 28px;\n      height: 28px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      color: var(--primary-color, #03a9f4);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 18px;\n      font-weight: bold;\n      transition: background-color 0.2s;\n    }\n\n    .time-range-add-button:hover:not(:disabled) {\n      background-color: var(--primary-color, #03a9f4);\n      color: white;\n    }\n\n    .time-range-add-button:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    .time-ranges-table {\n      display: flex;\n      flex-direction: column;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      border-radius: 4px;\n      overflow: hidden;\n    }\n\n    .time-ranges-header-row {\n      display: grid;\n      grid-template-columns: 60px 1fr 1fr 40px;\n      background-color: var(--divider-color, #f5f5f5);\n      border-bottom: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-header-cell {\n      padding: 8px 12px;\n      font-weight: bold;\n      font-size: 14px;\n      color: var(--primary-text-color, #212121);\n      border-right: 1px solid var(--divider-color, #e0e0e0);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .time-range-header-cell:last-child {\n      border-right: none;\n    }\n\n    .time-range-row {\n      display: grid;\n      grid-template-columns: 60px 1fr 1fr 40px;\n      border-bottom: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-row:last-child {\n      border-bottom: none;\n    }\n\n    .time-range-cell {\n      padding: 8px 6px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border-right: 1px solid var(--divider-color, #e0e0e0);\n    }\n\n    .time-range-cell:last-child {\n      border-right: none;\n    }\n\n    .time-range-cell.id-cell {\n      padding: 8px;\n    }\n\n    .time-range-cell.action-cell {\n      padding: 4px;\n      justify-content: center;\n    }\n\n    .time-range-cell ha-textfield {\n      width: 100%;\n      max-width: 120px;\n      margin: 0 auto;\n    }\n\n    .time-range-delete-button {\n      width: 28px;\n      height: 28px;\n      border-radius: 4px;\n      border: 1px solid var(--divider-color, #e0e0e0);\n      background-color: var(--card-background-color, #ffffff);\n      color: var(--error-color, #f44336);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 20px;\n      font-weight: bold;\n      transition: background-color 0.2s;\n      flex-shrink: 0;\n    }\n\n    .time-range-delete-button:hover:not(:disabled) {\n      background-color: var(--error-color, #f44336);\n      color: white;\n    }\n\n    .time-range-delete-button:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    ha-textfield[error] {\n      --mdc-text-field-outline-color: var(--error-color, #f44336);\n      --mdc-text-field-focus-outline-color: var(--error-color, #f44336);\n    }\n    `,\n  ];\n\n  constructor() {\n    super();\n    this.calendars = [];\n    this.selectedShortcut = null;\n    this._validationErrors = {};\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._updateValidationErrors();\n  }\n\n  updated(changedProperties) {\n    super.updated(changedProperties);\n\n    // Ignoriere calendars-Updates von auen, wenn Panel bereits initialisiert wurde\n    // (nur beim ersten Setzen akzeptieren wir externe calendars)\n    if (changedProperties.has('calendars')) {\n      const oldCalendars = changedProperties.get('calendars');\n      console.log('[ConfigPanel] updated() aufgerufen mit calendars-nderung', {\n        oldCalendars: oldCalendars?.length,\n        newCalendars: this.calendars?.length,\n        hasChanged: this.constructor.properties.calendars.hasChanged\n      });\n\n      // Wenn calendars bereits gesetzt waren und sich jetzt ndern, knnte es ein externes Update sein\n      // Prfe ob die Daten wirklich unterschiedlich sind\n      if (oldCalendars && oldCalendars.length > 0 && this.calendars && this.calendars.length > 0) {\n        const oldStr = JSON.stringify(oldCalendars);\n        const newStr = JSON.stringify(this.calendars);\n        // Wenn die Daten gleich sind, ignoriere das Update (nur Referenz-nderung)\n        if (oldStr === newStr) {\n          console.log('[ConfigPanel] calendars: Update ignoriert (Daten identisch)');\n          return; // Ignoriere Update, da Daten identisch sind\n        }\n      }\n      this._updateValidationErrors();\n    }\n\n    if (changedProperties.has('selectedShortcut')) {\n      this._updateValidationErrors();\n    }\n  }\n\n  _validateCalendar(calendar) {\n    const errors = {};\n    \n    // Validiere Schicht-ID\n    if (!calendar.shortcut || !/^[a-z]$/.test(calendar.shortcut)) {\n      errors.shortcut = true;\n    }\n    \n    // Validiere Zeitrume\n    if (calendar.timeRanges && Array.isArray(calendar.timeRanges)) {\n      const timeRangeIds = [];\n      \n      calendar.timeRanges.forEach((range, index) => {\n        const rangeData = typeof range === 'object' && range.times ? range : { id: null, times: range || [null, null] };\n        \n        // Validiere Zeitraum-ID\n        if (!rangeData.id || !/^[1-9]$/.test(rangeData.id)) {\n          errors[`timeRange_${index}_id`] = true;\n        } else {\n          // Prfe auf doppelte IDs\n          const idNum = parseInt(rangeData.id);\n          if (timeRangeIds.includes(idNum)) {\n            errors[`timeRange_${index}_id`] = true;\n          } else {\n            timeRangeIds.push(idNum);\n          }\n        }\n        \n        // Validiere Zeit-Format (optional, aber wenn vorhanden, muss es gltig sein)\n        if (rangeData.times && rangeData.times[0] && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(rangeData.times[0])) {\n          errors[`timeRange_${index}_start`] = true;\n        }\n        if (rangeData.times && rangeData.times[1] && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(rangeData.times[1])) {\n          errors[`timeRange_${index}_end`] = true;\n        }\n      });\n    }\n    \n    return errors;\n  }\n\n  _hasValidationErrors() {\n    if (!this.selectedShortcut) {\n      return false;\n    }\n    const calendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    if (!calendar) {\n      return false;\n    }\n    const errors = this._validateCalendar(calendar);\n    return Object.keys(errors).length > 0;\n  }\n\n  _triggerColorPicker(shortcut) {\n    // Finde das versteckte Color-Input-Element und triggere den Click\n    const colorInput = this.shadowRoot.querySelector(`input[type=\"color\"]`);\n    if (colorInput) {\n      colorInput.click();\n    }\n  }\n\n  render() {\n    const editingCalendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    const selectedIndex = this.calendars.findIndex(cal => cal.shortcut === this.selectedShortcut);\n    \n    return html`\n      <div class=\"config-menu-bar\">\n        ${renderMenuBar({\n          left: html`\n            <button class=\"cancel-button menu-button\" @click=${this._handleClose} title=\"Abbrechen\"></button>\n          `,\n          center: '',\n          right: html`\n            <button \n              class=\"confirm-button menu-button\" \n              @click=${this._handleSave} \n              title=\"Speichern\"\n              ?disabled=${this._hasValidationErrors()}\n            ></button>\n          `,\n          fullWidth: html`\n            <div class=\"color-bar\">\n              ${this.calendars.map((calendar, index) => {\n                const isSelected = calendar.shortcut === this.selectedShortcut;\n                const hasErrors = this._hasValidationErrors() && isSelected;\n                return html`\n                  <button\n                    class=\"color-button ${isSelected ? 'selected' : ''} ${calendar.enabled ? '' : 'disabled'}\"\n                    style=\"background-color: ${calendar.color || '#ff9800'};\"\n                    @click=${() => {\n                      if (!this._hasValidationErrors()) {\n                        this.selectedShortcut = calendar.shortcut;\n                        this._updateValidationErrors();\n                      }\n                    }}\n                    ?disabled=${hasErrors}\n                    title=\"${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`} ${calendar.enabled ? '' : '(deaktiviert)'}${hasErrors ? ' (Fehlerhafte Eingabe)' : ''}\"\n                  ></button>\n                `;\n              })}\n              <button\n                class=\"color-button add-shift-color-button\"\n                @click=${this._addShift}\n                title=\"Neue Schicht hinzufgen\"\n                ?disabled=${this._hasValidationErrors()}\n              >\n                +\n              </button>\n            </div>\n          `,\n        })}\n      </div>\n      <div class=\"config-panel\">\n        ${editingCalendar\n          ? html`\n              <div class=\"shift-editor\">\n                <!-- Zeile 1: Name, Farbe, ID -->\n                <div class=\"editor-row\">\n                  <div class=\"editor-field\">\n                    <label>Name</label>\n                    <ha-textfield\n                      .value=${editingCalendar.name || ''}\n                      @input=${e => this._updateCalendar(editingCalendar.shortcut, { name: e.target.value })}\n                      placeholder=\"Schichtname\"\n                    ></ha-textfield>\n                  </div>\n                  \n                  <div class=\"editor-field\">\n                    <label>Farbe</label>\n                    <div class=\"color-input-group\">\n                      <input\n                        type=\"color\"\n                        .value=${editingCalendar.color || '#ff9800'}\n                        @input=${e => this._updateCalendar(editingCalendar.shortcut, { color: e.target.value })}\n                        class=\"color-picker-input\"\n                        title=\"Farbauswahl ffnen\"\n                      />\n                      <div\n                        class=\"color-preview-large\"\n                        style=\"background-color: ${editingCalendar.color || '#ff9800'}; cursor: pointer;\"\n                        @click=${() => this._triggerColorPicker(editingCalendar.shortcut)}\n                        title=\"Farbauswahl ffnen\"\n                      ></div>\n                    </div>\n                  </div>\n                  \n                  <div class=\"editor-field id-field\">\n                    <label>ID</label>\n                    <ha-textfield\n                      .value=${editingCalendar.shortcut || ''}\n                      @input=${e => {\n                        this._updateCalendarId(editingCalendar.shortcut, e.target.value);\n                        this._updateValidationErrors();\n                      }}\n                      placeholder=\"a\"\n                      maxlength=\"1\"\n                      pattern=\"[a-z]\"\n                      .error=${this._validationErrors[`${editingCalendar.shortcut}_shortcut`] || false}\n                    ></ha-textfield>\n                  </div>\n                </div>\n                \n                <!-- Zeile 2: Aktiviert, Relevant -->\n                <div class=\"editor-row\">\n                  <div class=\"switch-item\">\n                    <label class=\"switch-label\">Aktiviert</label>\n                    <ha-switch\n                      .checked=${editingCalendar.enabled !== false}\n                      @change=${e => this._updateCalendar(editingCalendar.shortcut, { enabled: e.target.checked })}\n                    ></ha-switch>\n                  </div>\n                  <div class=\"switch-item\">\n                    <label class=\"switch-label\">Status relevant</label>\n                    <ha-switch\n                      .checked=${editingCalendar.statusRelevant !== false}\n                      @change=${e => this._updateCalendar(editingCalendar.shortcut, { statusRelevant: e.target.checked })}\n                    ></ha-switch>\n                  </div>\n                </div>\n                \n                <!-- Zeile 3: Zeitrume -->\n                <div class=\"editor-row\">\n                  <div class=\"editor-section full-width\">\n                    <div class=\"time-ranges-header\">\n                      <label>Zeitrume</label>\n                      <button\n                        class=\"time-range-add-button\"\n                        @click=${() => this._addTimeRange(editingCalendar.shortcut)}\n                        title=\"Zeitbereich hinzufgen\"\n                        ?disabled=${(editingCalendar.timeRanges && editingCalendar.timeRanges.length >= 9) || false}\n                      >\n                        +\n                      </button>\n                    </div>\n                    ${editingCalendar.timeRanges && editingCalendar.timeRanges.length > 0\n                      ? html`\n                        <div class=\"time-ranges-table\">\n                          <div class=\"time-ranges-header-row\">\n                            <div class=\"time-range-header-cell id-header\">ID</div>\n                            <div class=\"time-range-header-cell\">Start</div>\n                            <div class=\"time-range-header-cell\">ENDE</div>\n                            <div class=\"time-range-header-cell action-header\"></div>\n                          </div>\n                          ${editingCalendar.timeRanges.map((range, rangeIndex) => {\n                        const rangeData = typeof range === 'object' && range.times ? range : { id: null, times: range || [null, null] };\n                        return html`\n                        <div class=\"time-range-row\">\n                          <div class=\"time-range-cell id-cell\">\n                            <ha-textfield\n                              .value=${rangeData.id || ''}\n                              @input=${e => {\n                                this._updateTimeRangeId(editingCalendar.shortcut, rangeIndex, e.target.value);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"1\"\n                              maxlength=\"1\"\n                              pattern=\"[1-9]\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_id`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell\">\n                            <ha-textfield\n                              type=\"time\"\n                              .value=${rangeData.times[0] || ''}\n                              @input=${e => {\n                                this._updateTimeRange(editingCalendar.shortcut, rangeIndex, 0, e.target.value || null);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"HH:MM\"\n                              pattern=\"[0-9]{2}:[0-9]{2}\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_start`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell\">\n                            <ha-textfield\n                              type=\"time\"\n                              .value=${rangeData.times[1] || ''}\n                              @input=${e => {\n                                this._updateTimeRange(editingCalendar.shortcut, rangeIndex, 1, e.target.value || null);\n                                this._updateValidationErrors();\n                              }}\n                              placeholder=\"HH:MM\"\n                              pattern=\"[0-9]{2}:[0-9]{2}\"\n                              .error=${this._validationErrors[`${editingCalendar.shortcut}_timeRange_${rangeIndex}_end`] || false}\n                            ></ha-textfield>\n                          </div>\n                          <div class=\"time-range-cell action-cell\">\n                            <button\n                              class=\"time-range-delete-button\"\n                              @click=${() => this._removeTimeRange(editingCalendar.shortcut, rangeIndex)}\n                              title=\"Zeitbereich entfernen\"\n                            >\n                              \n                            </button>\n                          </div>\n                        </div>\n                        `;\n                          })}\n                        </div>\n                      `\n                      : ''}\n                  </div>\n                </div>\n                \n                <!-- Zeile 4: Papierkorb und Pfeile -->\n                <div class=\"editor-row\">\n                  <div class=\"action-buttons\">\n                    <button\n                      class=\"control-button delete\"\n                      @click=${() => this._deleteShift(editingCalendar.shortcut)}\n                      title=\"Lschen\"\n                    >\n                      \n                    </button>\n                    <button\n                      class=\"control-button\"\n                      @click=${() => this._moveShift(selectedIndex, -1)}\n                      ?disabled=${selectedIndex <= 0}\n                      title=\"Nach oben\"\n                    >\n                      \n                    </button>\n                    <button\n                      class=\"control-button\"\n                      @click=${() => this._moveShift(selectedIndex, 1)}\n                      ?disabled=${selectedIndex >= this.calendars.length - 1}\n                      title=\"Nach unten\"\n                    >\n                      \n                    </button>\n                  </div>\n                </div>\n              </div>\n              `\n            : ''}\n        <span class=\"version-info\">v${Version}</span>\n      </div>\n    `;\n  }\n\n\n  _handleClose() {\n    this._hasLocalCopy = false;\n    this.dispatchEvent(new CustomEvent('close'));\n  }\n\n  _handleSave() {\n    this.dispatchEvent(\n      new CustomEvent('save', {\n        detail: { calendars: this.calendars },\n      })\n    );\n  }\n\n  _moveShift(index, direction) {\n    if (index + direction < 0 || index + direction >= this.calendars.length) {\n      return;\n    }\n\n    const newCalendars = [...this.calendars];\n    const [moved] = newCalendars.splice(index, 1);\n    newCalendars.splice(index + direction, 0, moved);\n    this.calendars = newCalendars;\n    this._updateValidationErrors();\n  }\n\n  _deleteShift(shortcut) {\n    if (this.calendars.length <= 1) {\n      return; // Mindestens eine Schicht muss vorhanden sein\n    }\n\n    this.calendars = this.calendars.filter(cal => cal.shortcut !== shortcut);\n    if (this.selectedShortcut === shortcut) {\n      this.selectedShortcut = this.calendars.length > 0 ? this.calendars[0].shortcut : null;\n    }\n    this._updateValidationErrors();\n  }\n\n  _toggleEnabled(shortcut, enabled) {\n    this.calendars = this.calendars.map(cal =>\n      cal.shortcut === shortcut ? { ...cal, enabled } : cal\n    );\n    this._updateValidationErrors();\n  }\n\n  _addShift() {\n    // Finde den nchsten verfgbaren Shortcut\n    const existingShortcuts = this.calendars.map(cal => cal.shortcut);\n    const allShortcuts = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'];\n    const availableShortcut = allShortcuts.find(s => !existingShortcuts.includes(s));\n\n    if (!availableShortcut) {\n      return; // Maximale Anzahl von Schichten erreicht\n    }\n\n    const defaultColors = [\n      '#ff9800',\n      '#ff0000',\n      '#00ff00',\n      '#0000ff',\n      '#ffff00',\n      '#ff00ff',\n      '#00ffff',\n      '#ffa500',\n      '#800080',\n      '#008000',\n    ];\n\n    const newShift = {\n      shortcut: availableShortcut,\n      name: `Schicht ${availableShortcut.toUpperCase()}`,\n      color: defaultColors[this.calendars.length % defaultColors.length],\n      enabled: true,\n      statusRelevant: true,\n      timeRanges: [],\n    };\n\n    this.calendars = [...this.calendars, newShift];\n    this.selectedShortcut = newShift.shortcut;\n    this._updateValidationErrors();\n  }\n\n  _updateCalendar(shortcut, updates) {\n    this.calendars = this.calendars.map(cal =>\n      cal.shortcut === shortcut ? { ...cal, ...updates } : cal\n    );\n    this._updateValidationErrors();\n  }\n\n  _normalizeTimeRange(range) {\n    // Konvertiere altes Format [start, end] zu neuem Format { id, times: [start, end] }\n    if (Array.isArray(range)) {\n      return { id: null, times: range };\n    }\n    if (typeof range === 'object' && range.times) {\n      return range;\n    }\n    return { id: null, times: [null, null] };\n  }\n\n  _normalizeTimeRanges(timeRanges) {\n    if (!timeRanges || !Array.isArray(timeRanges)) {\n      return [];\n    }\n    return timeRanges.map((range) => {\n      const normalized = this._normalizeTimeRange(range);\n      // Keine Default-ID setzen - ID muss explizit gesetzt werden\n      return normalized;\n    });\n  }\n\n  _updateTimeRange(shortcut, rangeIndex, timeIndex, value) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        if (!newTimeRanges[rangeIndex]) {\n          newTimeRanges[rangeIndex] = { id: null, times: [null, null] };\n        }\n        newTimeRanges[rangeIndex] = {\n          ...newTimeRanges[rangeIndex],\n          times: [...newTimeRanges[rangeIndex].times],\n        };\n        newTimeRanges[rangeIndex].times[timeIndex] = value;\n        return { ...cal, timeRanges: newTimeRanges };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _updateTimeRangeId(shortcut, rangeIndex, newId) {\n    // Validiere die neue ID (nur Ziffern 1-9)\n    const normalizedId = newId.trim() || null;\n\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        if (newTimeRanges[rangeIndex]) {\n          newTimeRanges[rangeIndex] = {\n            ...newTimeRanges[rangeIndex],\n            id: normalizedId,\n          };\n        }\n        return { ...cal, timeRanges: newTimeRanges };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _addTimeRange(shortcut) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        \n        // Prfe ob bereits 9 Zeitrume vorhanden sind\n        if (timeRanges.length >= 9) {\n          return cal; // Keine weiteren Zeitrume mglich\n        }\n        \n        // Finde die erste verfgbare ID im Bereich 1-9\n        const existingIds = timeRanges.map(r => r.id).map(id => parseInt(id) || 0).filter(id => id >= 1 && id <= 9);\n        let newId = null;\n        // Prfe alle IDs von 1 bis 9 und finde die erste, die nicht verwendet wird\n        for (let i = 1; i <= 9; i++) {\n          if (!existingIds.includes(i)) {\n            newId = String(i);\n            break;\n          }\n        }\n        return { ...cal, timeRanges: [...timeRanges, { id: newId, times: [null, null] }] };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _removeTimeRange(shortcut, rangeIndex) {\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        const timeRanges = this._normalizeTimeRanges(cal.timeRanges);\n        const newTimeRanges = [...timeRanges];\n        newTimeRanges.splice(rangeIndex, 1);\n        // Erlaube leeres Array (keine Zeitrume)\n        return { ...cal, timeRanges: newTimeRanges.length > 0 ? newTimeRanges : [] };\n      }\n      return cal;\n    });\n    this._updateValidationErrors();\n  }\n\n  _updateValidationErrors() {\n    const errors = {};\n    this.calendars.forEach(cal => {\n      const calErrors = this._validateCalendar(cal);\n      Object.keys(calErrors).forEach(key => {\n        errors[`${cal.shortcut}_${key}`] = true;\n      });\n    });\n    this._validationErrors = errors;\n    \n    // Debug: Zeige Validierungsergebnis\n    const hasErrors = Object.keys(errors).length > 0;\n    const selectedCalendar = this.calendars.find(cal => cal.shortcut === this.selectedShortcut);\n    const selectedHasErrors = selectedCalendar ? Object.keys(errors).some(key => key.startsWith(`${this.selectedShortcut}_`)) : false;\n    \n    console.log('[ShiftConfigPanel] Validierung:', {\n      erfolgreich: !hasErrors,\n      fehlerfrei: !selectedHasErrors,\n      gesamtFehler: Object.keys(errors).length,\n      fehlerDetails: errors,\n      aktuelleSchicht: this.selectedShortcut,\n      aktuelleSchichtFehler: selectedHasErrors\n    });\n    \n    this.requestUpdate();\n  }\n\n  _updateCalendarId(oldShortcut, newShortcut) {\n    // Validiere die neue ID (nur ein Zeichen, a-z)\n    const normalizedNewShortcut = newShortcut.toLowerCase().trim();\n    if (!normalizedNewShortcut || normalizedNewShortcut.length === 0) {\n      this._updateValidationErrors();\n      return; // Leere ID nicht erlauben\n    }\n    \n    // Prfe ob es ein einzelner Kleinbuchstabe ist\n    if (normalizedNewShortcut.length !== 1 || !/^[a-z]$/.test(normalizedNewShortcut)) {\n      this._updateValidationErrors();\n      return;\n    }\n    \n    // Prfe ob die neue ID bereits verwendet wird\n    const existingCalendar = this.calendars.find(cal => cal.shortcut === normalizedNewShortcut && cal.shortcut !== oldShortcut);\n    if (existingCalendar) {\n      this._updateValidationErrors();\n      return;\n    }\n\n    // Aktualisiere die ID\n    this.calendars = this.calendars.map(cal => {\n      if (cal.shortcut === oldShortcut) {\n        return { ...cal, shortcut: normalizedNewShortcut };\n      }\n      return cal;\n    });\n\n    // Aktualisiere selectedShortcut falls ntig\n    if (this.selectedShortcut === oldShortcut) {\n      this.selectedShortcut = normalizedNewShortcut;\n    }\n\n    this._updateValidationErrors();\n  }\n}\n\ncustomElements.define('shift-config-panel', ShiftConfigPanel);\n\n","import { html, css, unsafeCSS } from 'lit';\nimport { ViewBase } from '../view-base.js';\nimport { SaveDebounceTime } from '../../card-config.js';\nimport { StorageFactory } from '../../storage/storage-factory.js';\n// Mixins fr wiederverwendbare Funktionalitt\nimport { HolidayMixin } from './mixins/holiday-mixin.js';\nimport { DataManagementMixin } from './mixins/data-management-mixin.js';\nimport { CalendarMixin } from './mixins/calendar-mixin.js';\nimport { ConfigManagementMixin } from './mixins/config-management-mixin.js';\nimport { RenderingMixin } from './mixins/rendering-mixin.js';\n// Utilities\nimport { DateUtils } from '../../utils/date-utils.js';\nimport { ColorUtils } from '../../utils/color-utils.js';\n// Gemeinsame Menu-Styles\nimport { sharedMenuStyles } from './shared-menu-styles.js';\n// Menu-Bar Template\nimport { renderMenuBar } from './menu-bar-template.js';\n// Konfigurationspanel\nimport './shift-config-panel.js';\n\nexport class ShiftScheduleView extends ViewBase {\n  static className = 'ShiftScheduleView';\n\n  // Zentrale Definition der Standardfarbe fr ausgewhlte Tage im Single-Modus\n  static DEFAULT_SELECTED_DAY_COLOR = '#ff9800'; // Orange\n\n  // Fixe Schicht-Definition: 5 gleichberechtigte Schichten (a, b, c, d, e)\n  static CALENDARS = [\n    { shortcut: 'a', name: 'Schicht A', defaultColor: '#ff9800' },\n    { shortcut: 'b', name: 'Schicht B', defaultColor: '#ff0000' },\n    { shortcut: 'c', name: 'Schicht C', defaultColor: '#00ff00' },\n    { shortcut: 'd', name: 'Schicht D', defaultColor: '#0000ff' },\n    { shortcut: 'e', name: 'Schicht E', defaultColor: '#ffff00' },\n  ];\n\n  static get properties() {\n    return {\n      ...super.properties,\n      hass: { type: Object },\n      config: { type: Object },\n      lovelace: { type: Object },\n      _workingDays: { type: Object },\n      _storageWarning: { type: Object },\n      _configWarning: { type: Object },\n      _statusWarning: { type: Object },\n      _displayedMonths: { type: Number },\n      _startMonthOffset: { type: Number },\n      _selectedCalendar: { type: String },\n      _showConfigPanel: { type: Boolean },\n    };\n                }\n\n  constructor() {\n    super();\n    this._workingDays = {}; // {\"year:month\": {day: [elements]}} - z.B. {\"25:11\": {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]}                              }\n    this._storageWarning = null; // { show: boolean, currentLength: number, maxLength: number, percentage: number                               }\n    this._configWarning = null; // { show: boolean, configEntityId: string                               }\n    this._statusWarning = null; // { show: boolean, statusEntityId: string                               }\n    this._knownEntityIds = null; // Cache fr bekannte Entities [mainEntity, ...additionalEntities] - WIRD VON ENTITY-STORAGE VERWENDET\n    this._cleanupDone = false; // Flag, ob die Bereinigung bereits beim initialen Laden ausgefhrt wurde\n    this._displayedMonths = 2; // Anzahl der angezeigten Monate (wird aus config.numberOfMonths initialisiert)\n    this._startMonthOffset = 0; // Offset fr den Startmonat (0 = aktueller Monat, -1 = Vormonat, +1 = nchster Monat)\n    this._isWriting = false; // Flag, ob gerade geschrieben wird\n    this._writeLockTimer = null; // Timer fr das 5-Sekunden-Lock nach dem Schreiben\n    this._selectedCalendar = null; // Shortcut des ausgewhlten Kalenders (wird beim Setzen der Config initialisiert)\n    this._isInitialLoad = true; // Flag, ob gerade der initiale Load luft (verhindert Config-Schreiben beim Laden)\n    this._directDOMUpdateInProgress = new Set(); // Set von Button-Keys, die gerade per direkter DOM-Manipulation aktualisiert werden\n    // Performance-Caches\n    this._holidayCache = {}; // Cache fr Feiertage: {\"2025-12\": {1: true, 25: true, ...}                              }\n    this._cachedHolidayEntities = null; // Cache fr Holiday-Entities (wird bei hass-Update invalidiert)\n    this._editorModeCache = null; // Cache fr Editor-Mode-Erkennung\n    this._editorModeCacheTime = 0; // Zeitstempel fr Cache-Invalidierung\n    // Debouncing fr Speicher-Operationen\n    this._saveDebounceTimer = null; // Timer fr Debouncing beim Speichern\n    // Storage-Adapter (wird bei setConfig oder set hass initialisiert)\n    this._storage = null;\n    // Konfigurationspanel\n    this._showConfigPanel = false;\n    this._configPanelCalendars = null; // Gespeicherte calendars beim ffnen des Panels\n    \n    // Mixins hinzufgen (fr wiederverwendbare Funktionalitt)\n    Object.assign(this, DateUtils);\n    Object.assign(this, ColorUtils);\n    Object.assign(this, HolidayMixin);\n    Object.assign(this, DataManagementMixin);\n    Object.assign(this, CalendarMixin);\n    Object.assign(this, ConfigManagementMixin);\n    Object.assign(this, RenderingMixin);\n                }\n\n  // formatTwoDigits() ist jetzt in DateUtils\n\n  // Prft, ob die Karte im Editor-Modus angezeigt wird (mit Cache)\n  _isInEditorMode() {\n    // Cache: Prfe ob Cache noch gltig ist (5 Sekunden)\n    const now = Date.now();\n    if (this._editorModeCache !== null && now - this._editorModeCacheTime < 5000) {\n      return this._editorModeCache;\n                }\n\n    let result = false;\n\n    // Methode 1: Prfe URL-Parameter ?edit=1\n    if (typeof window !== 'undefined' && window.location) {\n      const urlParams = new URLSearchParams(window.location.search);\n      if (urlParams.get('edit') === '1') {\n        result = true;\n                }\n                }\n\n    if (!result) {\n      // Methode 2: Prfe lovelace.editMode\n      if (this.lovelace?.editMode === true) {\n        result = true;\n                }\n                }\n\n    if (!result) {\n      // Methode 3: Prfe, ob hui-dialog-edit-card im DOM existiert\n      if (typeof document !== 'undefined') {\n        const editDialog = document.querySelector('hui-dialog-edit-card');\n        if (editDialog) {\n          result = true;\n                }\n                }\n                }\n\n    if (!result) {\n      // Methode 4: Prfe, ob die Karte in einem Editor-Container ist\n      let element = this;\n      let depth = 0;\n      const maxDepth = 20; // Erhht fr bessere Erkennung\n\n      while (element && depth < maxDepth) {\n        // Prfe auf hui-dialog-edit-card im Parent-Baum\n        if (element.tagName?.toLowerCase() === 'hui-dialog-edit-card') {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische Klassen oder Attribute\n        if (\n          element.classList?.contains('card-editor') ||\n          element.classList?.contains('hui-card-editor') ||\n          element.classList?.contains('edit-mode') ||\n          element.classList?.contains('hui-card-config-editor') ||\n          element.getAttribute?.('data-card-editor') === 'true' ||\n          element.tagName?.toLowerCase().includes('editor') ||\n          element.tagName?.toLowerCase() === 'hui-card-element-editor'\n        ) {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische IDs\n        if (element.id && (element.id.includes('editor') || element.id.includes('config'))) {\n          result = true;\n          break;\n                }\n\n        // Prfe auf Editor-spezifische Attribute\n        if (\n          element.hasAttribute &&\n          (element.hasAttribute('data-card-editor') || element.hasAttribute('data-editor'))\n        ) {\n          result = true;\n          break;\n                }\n\n        element = element.parentElement || element.parentNode;\n        depth++;\n                }\n                }\n\n    if (!result) {\n      // Methode 5: Prfe, ob die Karte in einem Shadow DOM mit Editor-Klassen ist\n      const root = this.getRootNode();\n      if (root && root !== document) {\n        const host = root.host;\n        if (host) {\n          if (\n            host.tagName?.toLowerCase() === 'hui-dialog-edit-card' ||\n            host.classList?.contains('card-editor') ||\n            host.classList?.contains('hui-card-editor') ||\n            host.classList?.contains('edit-mode') ||\n            host.classList?.contains('hui-card-config-editor') ||\n            host.tagName?.toLowerCase() === 'hui-card-element-editor'\n          ) {\n            result = true;\n                }\n                }\n                }\n                }\n\n    if (!result) {\n      // Methode 6: Prfe URL-Pfad (falls im Editor-Modus)\n      if (typeof window !== 'undefined' && window.location) {\n        const url = window.location.href || window.location.pathname;\n        if (url && (url.includes('/config/lovelace/dashboards') || url.includes('/editor'))) {\n          result = true;\n                }\n                }\n                }\n\n    // Cache speichern\n    this._editorModeCache = result;\n    this._editorModeCacheTime = now;\n\n    return result;\n                }\n\n  // Berechnet die Kontrastfarbe (schwarz oder wei) fr eine gegebene Hintergrundfarbe\n  // _getContrastColor() ist jetzt in ColorUtils\n  // _getEasterDate(), _isHoliday(), _isWeekend() sind jetzt in HolidayMixin\n\n  /**\n   * Initialisiert den Storage-Adapter basierend auf der Konfiguration\n   * @private\n   */\n  _initializeStorage() {\n    if (!this._hass || !this._config) {\n      this._debug('[Storage] _initializeStorage: hass oder config fehlt');\n      this._storage = null;\n      return;\n                }\n\n    try {\n      this._storage = StorageFactory.createStorage(this._hass, this._config, this._debug.bind(this));\n      this._debug(`[Storage] _initializeStorage: Storage-Adapter erstellt, store_mode: \"${this._config.store_mode}\"`);\n    } catch (error) {\n      this._debug(`[Storage] _initializeStorage: Fehler beim Erstellen des Storage-Adapters: ${error.message}`, error);\n      this._storage = null;\n                }\n                }\n\n  get hass() {\n    return this._hass;\n                }\n\n  set hass(hass) {\n    // WICHTIG: Verhindere alle hass-Updates wenn das Konfigurationspanel geffnet ist\n    if (this._showConfigPanel) {\n      // Aktualisiere hass trotzdem (fr spter), aber fhre keine Operationen aus\n      this._debug('[Update-Block] set hass() blockiert (Panel ist geffnet)');\n      this._hass = hass;\n      return; // Kein requestUpdate(), kein Laden von Daten, nichts\n                }\n\n    // Ignoriere Updates whrend des Schreibens und 5 Sekunden danach\n    if (this._isWriting) {\n      this._hass = hass; // Aktualisiere hass trotzdem, aber lade keine Daten\n      this.requestUpdate();\n      return;\n                }\n\n    const previousEntityState = this._hass?.states?.[this._config?.entity]?.state;\n    const newEntityState = hass?.states?.[this._config?.entity]?.state;\n\n    // Prfe auch zustzliche Entities auf nderungen\n    let hasAnyEntityChanged = previousEntityState !== newEntityState;\n    if (!hasAnyEntityChanged && this._config && this._knownEntityIds && hass?.states) {\n      // Prfe alle bekannten zustzlichen Entities\n      for (let i = 1; i < this._knownEntityIds.length; i++) {\n        const entityId = this._knownEntityIds[i];\n        const prevState = this._hass?.states?.[entityId]?.state;\n        const newState = hass?.states?.[entityId]?.state;\n        if (prevState !== newState) {\n          hasAnyEntityChanged = true;\n          break;\n                }\n                }\n                }\n\n    // Prfe ob sich die saver_config oder die saver-Daten gendert haben (nur bei store_mode === 'saver')\n    let hasSaverConfigChanged = false;\n    let hasSaverDataChanged = false;\n    if (this._config && this._config.store_mode === 'saver' && this._hass && hass && hass?.states) {\n      try {\n        const saverEntity = hass.states['saver.saver'];\n        const previousSaverEntity = this._hass?.states?.['saver.saver'];\n        if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n          const configKey = `${this._config.saver_key || 'Schichtplan'}_config`;\n          const dataKey = this._config.saver_key || 'Schichtplan';\n\n          // Prfe Config-Variable\n          const previousConfigValue = previousSaverEntity?.attributes?.variables?.[configKey];\n          const newConfigValue = saverEntity.attributes.variables[configKey];\n          if (previousConfigValue !== newConfigValue) {\n            hasSaverConfigChanged = true;\n            this._debug('[Config] set hass: saver_config hat sich gendert, lade Konfiguration neu');\n          }\n\n          // Prfe Daten-Variable\n          const previousDataValue = previousSaverEntity?.attributes?.variables?.[dataKey];\n          const newDataValue = saverEntity.attributes.variables[dataKey];\n          if (previousDataValue !== newDataValue) {\n            hasSaverDataChanged = true;\n            this._debug(`[Sync] set hass: Saver-Daten-Variable \"${dataKey}\" hat sich gendert (alte Lnge: ${previousDataValue?.length || 0}, neue Lnge: ${newDataValue?.length || 0}), lade Daten neu`);\n          }\n        }\n      } catch (error) {\n        this._debug('[Config] set hass: Fehler beim Prfen der saver-Variablen:', error);\n      }\n    }\n\n    const wasHassSet = !!this._hass;\n    this._hass = hass;\n\n    // Cache-Invalidierung: Holiday-Entities Cache zurcksetzen bei hass-Update\n    this._cachedHolidayEntities = null;\n    \n    // Initialisiere Storage-Adapter neu, falls Config bereits vorhanden\n    if (this._config) {\n      this._initializeStorage();\n                }\n\n    // Wenn hass zum ersten Mal gesetzt wird und die Konfiguration bereits vorhanden ist,\n    // markiere initialen Load als abgeschlossen\n    if (!wasHassSet && hass && this._config && this._isInitialLoad) {\n      this._debug('[Config] set hass: hass zum ersten Mal gesetzt - markiere initialen Load als abgeschlossen');\n      this._isInitialLoad = false;\n                }\n\n    if (this._config) {\n      // Lade Daten beim ersten Setzen von hass, wenn sich ein State gendert hat, oder wenn sich Saver-Daten gendert haben\n      if ((!wasHassSet || hasAnyEntityChanged || hasSaverDataChanged) && hass?.states) {\n        if (hasSaverDataChanged) {\n          this._debug('[Sync] set hass: Lade Daten neu aufgrund von Saver-Daten-nderung (Synchronisation mit anderer Karte)');\n        }\n        try {\n          this.loadWorkingDays();\n        } catch (error) {\n          this._debug('[Config] set hass: Fehler beim Laden der Arbeitszeiten:', error);\n        }\n      }\n\n      // Beim ersten Setzen von hass: Lade die Konfiguration aus dem Storage, falls noch nicht geladen\n      // ABER: Nicht wenn das Konfigurationspanel offen ist, um ungespeicherte nderungen nicht zu berschreiben\n      if (!wasHassSet && this._storage && !this._showConfigPanel) {\n        this._debug('[Config] set hass: hass zum ersten Mal gesetzt - lade Konfiguration aus Storage');\n        // Verwende Promise ohne await, da set hass() nicht async ist\n        this._storage.loadConfig().then(storageConfig => {\n          // WICHTIG: Prfe nochmal, ob das Panel geffnet wurde, whrend das Promise lief\n          // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n          const isPanelOpen = this._showConfigPanel;\n          this._debug('[Config] set hass: Promise-Callback aufgerufen. _showConfigPanel=' + isPanelOpen + ', storageConfig vorhanden=' + !!storageConfig);\n          if (isPanelOpen) {\n            this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (beim ersten hass-Set). _showConfigPanel=' + isPanelOpen);\n            return;\n                }\n\n          if (storageConfig) {\n            try {\n              const parsedConfig = JSON.parse(storageConfig);\n              \n              // WICHTIG: Prfe NOCHMAL nach dem Parsen, ob das Panel geffnet wurde\n              const isPanelOpenAfterParse = this._showConfigPanel;\n              if (isPanelOpenAfterParse) {\n                this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (nach Parsen). _showConfigPanel=' + isPanelOpenAfterParse);\n                return;\n                }\n\n              // Neues Format: Objekt mit \"calendars\" Property\n              if (parsedConfig && typeof parsedConfig === 'object' && Array.isArray(parsedConfig.calendars)) {\n                this._debug('[Config] set hass: Konfiguration aus Storage geladen (neues Format mit calendars) beim ersten hass-Set');\n                \n                // WICHTIG: Prfe NOCHMAL vor dem Aktualisieren von this._config.calendars\n                const isPanelOpenBeforeUpdate = this._showConfigPanel;\n                if (isPanelOpenBeforeUpdate) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (vor calendars-Update). _showConfigPanel=' + isPanelOpenBeforeUpdate);\n                  return;\n                }\n\n                // WICHTIG: Finale Prfung direkt vor dem Aktualisieren von this._config.calendars\n                // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n                const finalPanelCheck = this._showConfigPanel;\n                if (finalPanelCheck) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (finale Prfung vor calendars-Update). _showConfigPanel=' + finalPanelCheck);\n                  return;\n                }\n\n                // Ersetze this._config.calendars vollstndig mit den geladenen Kalendern\n                this._config.calendars = parsedConfig.calendars.map(cal => {\n                  // Stelle sicher, dass timeRanges im korrekten Format sind\n                  let timeRanges = [];\n                  if (cal.timeRanges && Array.isArray(cal.timeRanges)) {\n                    timeRanges = cal.timeRanges.map((range, idx) => {\n                      // Prfe zuerst, ob es ein Array ist (altes Format)\n                      if (Array.isArray(range)) {\n                        // Altes Format: [start, end] - konvertiere zu neuem Format\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Altes Format [start, end] erkannt`);\n                        return {\n                          id: null,\n                          times: [...range],\n                        };\n                      } else if (typeof range === 'object' && range !== null && range.times && Array.isArray(range.times)) {\n                        // Neues Format: { id, times: [start, end]                               }\n                        const normalizedRange = {\n                          id: range.id || null,\n                          times: [...range.times],\n                        };\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Neues Format erkannt, id=\"${normalizedRange.id}\", times=[${normalizedRange.times.join(',')}]`);\n                        return normalizedRange;\n                      } else {\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Unbekanntes Format, verwende Default`);\n                        return { id: null, times: [null, null] };\n                }\n          });\n                }\n\n                  return {\n                    shortcut: cal.shortcut,\n                    name: cal.name || `Schicht ${cal.shortcut?.toUpperCase() || ''}`,\n                    color: cal.color || this._getDefaultColorForShortcut(cal.shortcut),\n                    enabled: cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1,\n                    statusRelevant: cal.statusRelevant === true || cal.statusRelevant === 'true' || cal.statusRelevant === 1,\n                    timeRanges: timeRanges,\n                  };\n                });\n                \n                this._debug(`[Config] set hass: ${this._config.calendars.length} Kalender geladen beim ersten hass-Set`);\n                this._config.calendars.forEach(cal => {\n                  this._debug(`[Config] set hass: Kalender \"${cal.shortcut}\":`, {\n                    name: cal.name,\n                    enabled: cal.enabled,\n                    statusRelevant: cal.statusRelevant,\n                    timeRanges_count: cal.timeRanges?.length || 0,\n                  });\n                });\n                \n                this._debug('[Config] set hass: Konfiguration aus Saver geladen und this._config aktualisiert');\n                // Prfe nochmal, ob das Panel geffnet wurde, bevor wir updaten\n                if (!this._showConfigPanel) {\n                  this.requestUpdate();\n                } else {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe requestUpdate()');\n                }\n    } else {\n                this._debug('[Config] set hass: Konfiguration konnte nicht geparst werden - erwartetes Format: { calendars: [...] }');\n                }\n  } catch (error) {\n              this._debug('[Config] set hass: Fehler beim Parsen der Konfiguration aus dem Storage:', error);\n                }\n                }\n        }).catch(error => {\n          this._debug('[Config] set hass: Fehler beim Laden der Konfiguration aus dem Storage:', error);\n        });\n                }\n\n      // Wenn sich die saver_config gendert hat, lade die Konfiguration neu\n      // ABER: Nicht wenn das Konfigurationspanel offen ist, um ungespeicherte nderungen nicht zu berschreiben\n      if (hasSaverConfigChanged && this._storage && !this._showConfigPanel) {\n        this._debug('[Config] set hass: Lade Konfiguration aus Storage neu');\n        // Lade die Konfiguration aus dem Storage und aktualisiere this._config\n        this._storage.loadConfig().then(storageConfig => {\n          // WICHTIG: Prfe nochmal, ob das Panel geffnet wurde, whrend das Promise lief\n          if (this._showConfigPanel) {\n            this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (bei saver_config-nderung)');\n            return;\n                }\n\n          if (storageConfig) {\n            try {\n              const parsedConfig = JSON.parse(storageConfig);\n              \n              // WICHTIG: Prfe NOCHMAL nach dem Parsen, ob das Panel geffnet wurde\n              if (this._showConfigPanel) {\n                this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (nach Parsen bei saver_config)');\n                return;\n                }\n\n              // Neues Format: Objekt mit \"calendars\" Property\n              if (parsedConfig && typeof parsedConfig === 'object' && Array.isArray(parsedConfig.calendars)) {\n                this._debug('[Config] set hass: Konfiguration aus Saver neu geladen (neues Format mit calendars)');\n                \n                // WICHTIG: Prfe NOCHMAL vor dem Aktualisieren von this._config.calendars\n                if (this._showConfigPanel) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (vor calendars-Update bei saver_config)');\n                  return;\n                }\n\n                // WICHTIG: Finale Prfung direkt vor dem Aktualisieren von this._config.calendars\n                // Verwende eine lokale Variable, um sicherzustellen, dass wir den aktuellen Wert prfen\n                const finalPanelCheckSaver = this._showConfigPanel;\n                if (finalPanelCheckSaver) {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe Config-Update (finale Prfung vor calendars-Update bei saver_config). _showConfigPanel=' + finalPanelCheckSaver);\n                  return;\n                }\n\n                // Ersetze this._config.calendars vollstndig mit den geladenen Kalendern\n                this._config.calendars = parsedConfig.calendars.map(cal => {\n                  // Stelle sicher, dass timeRanges im korrekten Format sind\n                  let timeRanges = [];\n                  if (cal.timeRanges && Array.isArray(cal.timeRanges)) {\n                    timeRanges = cal.timeRanges.map((range, idx) => {\n                      // Prfe zuerst, ob es ein Array ist (altes Format)\n                      if (Array.isArray(range)) {\n                        // Altes Format: [start, end] - konvertiere zu neuem Format\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Altes Format [start, end] erkannt`);\n                        return {\n                          id: null,\n                          times: [...range],\n                        };\n                      } else if (typeof range === 'object' && range !== null && range.times && Array.isArray(range.times)) {\n                        // Neues Format: { id, times: [start, end]                               }\n                        const normalizedRange = {\n                          id: range.id || null,\n                          times: [...range.times],\n                        };\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Neues Format erkannt, id=\"${normalizedRange.id}\", times=[${normalizedRange.times.join(',')}]`);\n                        return normalizedRange;\n                      } else {\n                        this._debug(`[Config] set hass: Zeitraum ${idx} fr \"${cal.shortcut}\": Unbekanntes Format, verwende Default`);\n                        return { id: null, times: [null, null] };\n                }\n          });\n                }\n\n                  return {\n                    shortcut: cal.shortcut,\n                    name: cal.name || `Schicht ${cal.shortcut?.toUpperCase() || ''}`,\n                    color: cal.color || this._getDefaultColorForShortcut(cal.shortcut),\n                    enabled: cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1,\n                    statusRelevant: cal.statusRelevant === true || cal.statusRelevant === 'true' || cal.statusRelevant === 1,\n                    timeRanges: timeRanges,\n                  };\n                });\n                \n                this._debug(`[Config] set hass: ${this._config.calendars.length} Kalender geladen`);\n                this._config.calendars.forEach(cal => {\n                  this._debug(`[Config] set hass: Kalender \"${cal.shortcut}\":`, {\n                    name: cal.name,\n                    enabled: cal.enabled,\n                    statusRelevant: cal.statusRelevant,\n                    timeRanges_count: cal.timeRanges?.length || 0,\n                  });\n                });\n                \n                this._debug('[Config] set hass: Konfiguration aus Storage neu geladen und this._config aktualisiert');\n                // Prfe nochmal, ob das Panel geffnet wurde, bevor wir updaten\n                if (!this._showConfigPanel) {\n                  this.requestUpdate();\n                } else {\n                  this._debug('[Config] set hass: Panel wurde geffnet - berspringe requestUpdate()');\n                }\n    } else {\n                this._debug('[Config] set hass: Konfiguration konnte nicht geparst werden - erwartetes Format: { calendars: [...] }');\n                }\n} catch (error) {\n            this._debug('[Config] set hass: Fehler beim Parsen der neu geladenen Konfiguration:', error);\n                }\n                }\n        }).catch(error => {\n          this._debug('[Config] set hass: Fehler beim Neuladen der Konfiguration aus dem Storage:', error);\n        });\n                }\n\n      // Prfe Config-Entity und Status-Entity nur bei text_entity Modus\n      // (bei Saver werden diese nicht bentigt)\n      if (this._config.store_mode !== 'saver' && hass?.states) {\n        try {\n          this.checkConfigEntity();\n          this.checkStatusEntity();\n        } catch (error) {\n          this._debug('[Config] set hass: Fehler beim Prfen der Config/Status-Entities:', error);\n                }\n                }\n                }\n    // Nur updaten, wenn das Panel nicht geffnet ist\n    if (!this._showConfigPanel) {\n      this.requestUpdate();\n                }\n                }\n\n  get config() {\n    return this._config;\n                }\n\n  set config(config) {\n    this._debug('[Config] set config: === WIRD AUFGERUFEN ===');\n    this._debug('[Config] set config: _isInitialLoad Status:', this._isInitialLoad);\n    \n    // Editor und View sind unabhngig: Editor verwendet nur YAML-Config, View ldt Schichtdaten aus Saver\n    // Die bergebene Config wird direkt verwendet, ohne Merge mit Saver-Config\n    this._config = config;\n    this._debug('[Config] set config: Neue Konfiguration erhalten', {\n      store_mode: config?.store_mode,\n      saver_key: config?.saver_key,\n      calendars_count: config?.calendars?.length,\n      hasHass: !!this._hass,\n    });\n\n    // Initialisiere _displayedMonths aus der Config\n    if (config && config.initialDisplayedMonths) {\n      // Verwende initialDisplayedMonths als Standardwert\n      const maxMonths = config.numberOfMonths || 14;\n      this._displayedMonths = Math.min(config.initialDisplayedMonths, maxMonths);\n    } else if (config && config.numberOfMonths && !this._displayedMonths) {\n      // Fallback: Verwende numberOfMonths, falls initialDisplayedMonths nicht gesetzt ist\n      this._displayedMonths = config.numberOfMonths;\n    } else if (config && config.numberOfMonths) {\n      // Stelle sicher, dass _displayedMonths nicht grer als numberOfMonths ist\n      this._displayedMonths = Math.min(this._displayedMonths || 2, config.numberOfMonths);\n                }\n\n    // Initialisiere _selectedCalendar - prfe nur aktivierte Kalender\n    const allCalendars = this._getAllCalendars();\n\n    // Synchronisiere _selectedCalendar immer mit config.selectedCalendar\n    if (config && config.selectedCalendar) {\n      // Prfe ob der ausgewhlte Kalender aktiviert ist\n      const exists = allCalendars.some(cal => cal.shortcut === config.selectedCalendar);\n      if (exists) {\n        // Aktualisiere _selectedCalendar, auch wenn es bereits gesetzt ist\n        this._selectedCalendar = config.selectedCalendar;\n      } else {\n        // Wenn der ausgewhlte Kalender nicht aktiviert ist, verwende den ersten aktivierten\n        if (allCalendars.length > 0) {\n          this._selectedCalendar = allCalendars[0].shortcut;\n          if (config) {\n            config.selectedCalendar = this._selectedCalendar;\n                }\n        } else {\n          // Ausgewhlter Kalender ist nicht aktiviert, verwende den ersten aktivierten\n          if (allCalendars.length > 0) {\n            this._selectedCalendar = allCalendars[0].shortcut;\n            if (config) {\n              config.selectedCalendar = this._selectedCalendar;\n                }\n} else {\n            // Kein Kalender aktiviert - keine automatische Aktivierung\n            this._selectedCalendar = null;\n            if (config) {\n              config.selectedCalendar = null;\n                }\n                }\n                }\n                }\n    } else {\n      // Wenn kein selectedCalendar gesetzt ist, verwende den ersten aktivierten Kalender\n      if (allCalendars.length > 0) {\n        this._selectedCalendar = allCalendars[0].shortcut;\n        if (config) {\n          config.selectedCalendar = this._selectedCalendar;\n                }\n      } else {\n        // Kein Kalender aktiviert - keine automatische Aktivierung\n        this._selectedCalendar = null;\n        if (config) {\n          config.selectedCalendar = null;\n                }\n                }\n                }\n\n    // Wenn hass vorhanden ist, bedeutet das, dass die Karte bereits initialisiert wurde\n    // Setze _isInitialLoad auf false, wenn hass vorhanden ist (Karte ist bereit)\n    if (this._hass && this._isInitialLoad) {\n      this._debug('[Config] set config: hass vorhanden - markiere initialen Load als abgeschlossen');\n      this._isInitialLoad = false;\n                }\n\n    if (this._hass) {\n      // Initialisiere Storage-Adapter\n      this._initializeStorage();\n      \n      this.loadWorkingDays();\n      // Prfe Warnungen ber Storage-Adapter\n      this._updateWarnings();\n      \n      // Wenn die Konfiguration gesetzt wird und es nicht der initiale Load ist,\n      // speichere die Konfiguration (z.B. wenn der Editor geschlossen wird)\n      // Dies stellt sicher, dass nderungen im Editor immer gespeichert werden\n      // Prfe jetzt nochmal, da _isInitialLoad mglicherweise gerade auf false gesetzt wurde\n      const isStillInitialLoad = this._isInitialLoad;\n      if (!isStillInitialLoad && this._config) {\n        this._debug('[Config] set config: Konfiguration wurde gesetzt (nicht initialer Load)');\n        this._debug('[Config] set config: Editor wurde geschlossen - speichere Konfiguration');\n        // Verwende setTimeout, um sicherzustellen, dass die Konfiguration vollstndig gesetzt ist\n        setTimeout(() => {\n          this._debug('[Config] set config: Starte saveConfigToEntity() nach setTimeout');\n          this.saveConfigToEntity();\n        }, 0);\n      } else if (isStillInitialLoad) {\n        this._debug('[Config] set config: Initialer Load erkannt - berspringe Speichern');\n                }\n    } else {\n      this._debug('[Config] set config: hass noch nicht verfgbar - warte auf Initialisierung');\n                }\n\n    // Markiere initialen Load als abgeschlossen NACH dem ersten Rendering\n    // (nicht hier, sondern in firstUpdated oder nach dem ersten config-changed Event)\n\n    this.requestUpdate();\n                }\n\n  // Wird aufgerufen, wenn ein config-changed Event empfangen wird\n  // (nur dann wird die Config gespeichert, nicht beim initialen Laden)\n  _handleConfigChanged() {\n    this._debug('[Config] _handleConfigChanged: Event empfangen - Konfiguration wurde gendert');\n    \n    // Verhindere Speichern beim initialen Load\n    if (this._isInitialLoad) {\n      this._debug('[Config] _handleConfigChanged: Initialer Load erkannt, berspringe Config-Speichern');\n      this._debug('[Config] _handleConfigChanged: Markiere initialen Load als abgeschlossen');\n      // Markiere initialen Load als abgeschlossen NACH dem ersten Event\n      this._isInitialLoad = false;\n      return;\n                }\n\n    if (!this._hass) {\n      this._debug('[Config] _handleConfigChanged: Abbruch - hass nicht verfgbar');\n      return;\n                }\n\n    if (!this._config) {\n      this._debug('[Config] _handleConfigChanged: Abbruch - config nicht verfgbar');\n      return;\n                }\n\n    this._debug('[Config] _handleConfigChanged: Starte saveConfigToEntity()');\n    this.saveConfigToEntity();\n                }\n\n  // Liest eine Saver-Variable (z.B. \"Schichtplan\" aus saver.saver.attributes.variables)\n  _readSaverVariable(key) {\n    if (!this._hass || !this._hass.states || !key) {\n      this._debug('[Saver] _readSaverVariable: Kein hass oder key vorhanden');\n      return null;\n                }\n\n    // Saver-Variablen sind in saver.saver.attributes.variables gespeichert\n    const saverEntity = this._hass?.states?.['saver.saver'];\n    if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n      const variables = saverEntity.attributes.variables;\n      const variableValue = variables[key];\n\n      if (variableValue !== undefined && variableValue !== null) {\n        // Konvertiere zu String und trimme\n        const value = String(variableValue).trim();\n        if (value !== '') {\n          this._debug(\n            `[Saver] _readSaverVariable: Variable \"${key}\" gefunden in saver.saver.attributes.variables, Lnge: ${value.length} Zeichen`\n          );\n          // Zeige ersten 100 Zeichen der Daten fr Debug\n          if (value.length > 0) {\n            const preview = value.substring(0, 100);\n            this._debug(\n              `[Saver] _readSaverVariable: Daten-Vorschau: \"${preview}${value.length > 100 ? '...' : ''}\"`\n            );\n                }\nreturn value;\n                }\n                }\n\n      // Debug: Zeige verfgbare Variablen\n      const availableKeys = Object.keys(variables);\n      this._debug(\n        `[Saver] _readSaverVariable: Variable \"${key}\" nicht gefunden. Verfgbare Variablen: ${availableKeys.length > 0 ? availableKeys.join(', ') : 'keine'}`\n      );\n    } else {\n      this._debug(\n        `[Saver] _readSaverVariable: saver.saver Entity nicht gefunden oder hat keine variables-Attribute`\n      );\n                }\n\n    this._debug(`[Saver] _readSaverVariable: Variable \"${key}\" nicht gefunden oder leer`);\n    return null;\n                }\n\n  // Prft ob Saver verfgbar ist (mindestens eine Saver-Entity existiert)\n  _isSaverAvailable() {\n    if (!this._hass || !this._hass.states) {\n      return false;\n                }\n    // Prfe ob irgendeine saver.* Entity existiert\n    return Object.keys(this._hass.states).some(entityId => entityId.startsWith('saver.'));\n                }\n\n  // Liest Daten vom Saver (wenn store_mode == 'saver' und Saver verfgbar)\n  _loadDataFromSaver() {\n    if (!this._config || this._config.store_mode !== 'saver') {\n      this._debug('[Saver] _loadDataFromSaver: store_mode ist nicht \"saver\"');\n      return null;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    this._debug(\n      `[Saver] _loadDataFromSaver: Versuche Daten von Saver-Variable \"${saverKey}\" zu laden`\n    );\n    const data = this._readSaverVariable(saverKey);\n\n    // Wenn Daten vorhanden, gib sie zurck\n    if (data && data.trim() !== '') {\n      this._debug(\n        `[Saver] _loadDataFromSaver: Daten erfolgreich geladen, Lnge: ${data.length} Zeichen`\n      );\n      return data;\n                }\n\n    this._debug('[Saver] _loadDataFromSaver: Keine Daten gefunden');\n    return null;\n                }\n\n  // Liest Config vom Saver (wenn store_mode == 'saver' und Saver verfgbar)\n  _loadConfigFromSaver() {\n    if (!this._config || this._config.store_mode !== 'saver') {\n      this._debug('[Saver] _loadConfigFromSaver: store_mode ist nicht \"saver\"');\n      return null;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    const configKey = `${saverKey}_config`;\n    this._debug(\n      `[Saver] _loadConfigFromSaver: Versuche Config von Saver-Variable \"${configKey}\" zu laden`\n    );\n    const config = this._readSaverVariable(configKey);\n\n    // Wenn Config vorhanden, gib sie zurck\n    if (config && config.trim() !== '') {\n      this._debug(\n        `[Saver] _loadConfigFromSaver: Config erfolgreich geladen, Lnge: ${config.length} Zeichen`\n      );\n      return config;\n                }\n\n    this._debug('[Saver] _loadConfigFromSaver: Keine Config gefunden');\n    return null;\n                }\n\n  /**\n   * Aktualisiert Warnungen basierend auf dem Storage-Adapter\n   * @private\n   */\n  _updateWarnings() {\n    if (!this._storage) {\n      return;\n                }\n\n    const warnings = this._storage.getWarnings();\n    if (warnings) {\n      if (warnings.config) {\n        this._configWarning = warnings.config;\n        this._updateConfigWarningDirectly();\n                }\n      if (warnings.status) {\n        this._statusWarning = warnings.status;\n        this._updateStatusWarningDirectly();\n                }\n    } else {\n      // Keine Warnungen - setze auf null\n      if (this._configWarning) {\n        this._configWarning = null;\n        this._updateConfigWarningDirectly();\n                }\n      if (this._statusWarning) {\n        this._statusWarning = null;\n        this._updateStatusWarningDirectly();\n                }\n                }\n                }\n\n  async loadWorkingDays() {\n    if (!this._hass || !this._config) {\n      this._debug('[Laden] loadWorkingDays: Kein hass oder config vorhanden');\n      return;\n                }\n\n    // Prfe Entity nur bei text_entity Modus (bei Saver wird keine Entity bentigt)\n    if (this._config.store_mode !== 'saver' && !this._config.entity) {\n      this._debug('[Laden] loadWorkingDays: Keine entity vorhanden (text_entity Modus bentigt entity)');\n      return;\n                }\n\n    // Stelle sicher, dass Storage initialisiert ist\n    if (!this._storage) {\n      this._initializeStorage();\n                }\n\n    if (!this._storage) {\n      this._debug('[Laden] loadWorkingDays: Kein Storage-Adapter verfgbar');\n      return;\n                }\n\n    this._debug(\n      `[Laden] loadWorkingDays: Start, store_mode: \"${this._config.store_mode}\", entity: \"${this._config.entity || 'nicht bentigt (Saver-Modus)'}\"`\n    );\n\n    let dataString = null;\n    let dataSource = 'none';\n\n    // Versuche zuerst den primren Storage-Adapter\n    try {\n      dataString = await this._storage.loadData();\n      if (dataString) {\n        dataSource = this._config.store_mode === 'saver' ? 'saver' : 'entities';\n        this._debug(\n          `[Laden] loadWorkingDays: Daten von ${dataSource} geladen, Lnge: ${dataString.length} Zeichen`\n        );\n                }\n    } catch (error) {\n      this._debug(`[Laden] loadWorkingDays: Fehler beim Laden: ${error.message}`, error);\n                }\n\n    // Fallback: Wenn Saver-Modus und keine Daten, versuche EntityStorage\n    if ((!dataString || dataString.trim() === '') && this._config.store_mode === 'saver') {\n      this._debug('[Laden] loadWorkingDays: Keine Daten vom Saver, Fallback zu Entities');\n      try {\n        const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n        dataString = await fallbackStorage.loadData();\n        if (dataString) {\n          dataSource = 'entities-fallback';\n          this._debug(\n            `[Laden] loadWorkingDays: Daten von Entities (Fallback) geladen, Lnge: ${dataString.length} Zeichen`\n          );\n                }\n      } catch (error) {\n        this._debug(`[Laden] loadWorkingDays: Fehler beim Fallback-Laden: ${error.message}`, error);\n                }\n                }\n\n    // Synchronisiere _knownEntityIds mit EntityStorage (falls verwendet)\n    if (this._storage && this._storage._knownEntityIds) {\n      this._knownEntityIds = this._storage._knownEntityIds;\n                }\n\n    // Parse die Daten (egal ob von Saver oder Entities)\n    if (dataString && dataString.trim() !== '') {\n      this._debug(`[Laden] loadWorkingDays: Parse Daten von Quelle: \"${dataSource}\"`);\n      this._debug(`[Laden] loadWorkingDays: Daten-String (erste 200 Zeichen): ${dataString.substring(0, 200)}...`);\n      this.parseWorkingDays(dataString);\n      const workingDaysCount = Object.keys(this._workingDays).length;\n      this._debug(`[Laden] loadWorkingDays: Daten geparst, ${workingDaysCount} Monate gefunden`);\n      this._debug(`[Laden] loadWorkingDays: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n      // Zeige Details fr jeden Monat\n      Object.keys(this._workingDays).forEach(key => {\n        const monthData = this._workingDays[key];\n        if (typeof monthData === 'object' && !Array.isArray(monthData)) {\n          const daysCount = Object.keys(monthData).length;\n          this._debug(`[Laden] loadWorkingDays: Monat \"${key}\": ${daysCount} Tage mit Daten`);\n          // Zeige erste 5 Tage als Beispiel\n          const sampleDays = Object.keys(monthData).slice(0, 5);\n          sampleDays.forEach(day => {\n            this._debug(`[Laden] loadWorkingDays: Monat \"${key}\", Tag ${day}:`, monthData[day]);\n          });\n                }\n      });\n    } else {\n      this._debug(\n        '[Laden] loadWorkingDays: Keine Daten zum Parsen vorhanden, setze _workingDays auf {}'\n      );\n      this._workingDays = {};\n                }\n\n    // Prfe Speicherverbrauch und zeige Warnung bei 90%+\n    // Nur bei text_entity Modus (Saver hat keine Lngenbegrenzung)\n    if (this._config.store_mode !== 'saver') {\n      this.checkStorageUsage();\n    } else {\n      // Bei Saver-Modus keine Speicherwarnung ntig\n      this._storageWarning = null;\n                }\n\n    // Bereinige alte Monate: entferne alle Monate, die nicht angezeigt werden\n    // Die Karte zeigt numberOfMonths Monate an (ab aktueller Monat)\n    // Behalten wir: Vormonat (aktuell - 1) und alle angezeigten Monate (aktuell bis aktuell + numberOfMonths - 1)\n    // Fhre die Bereinigung nur beim initialen Laden aus, nicht bei jedem State-Update\n    // (um zu verhindern, dass gerade geschriebene Daten sofort wieder gelscht werden)\n    if (Object.keys(this._workingDays).length > 0 && !this._cleanupDone) {\n      this._cleanupDone = true;\n      const numberOfMonths = this._config.numberOfMonths || 2;\n      const now = new Date();\n      const currentMonth = now.getMonth() + 1; // 1-12\n      const currentYearFull = now.getFullYear();\n      const currentYear = currentYearFull % 100; // Kurzform, z.B. 25\n\n      // Berechne Vormonat und sein Jahr\n      let previousMonth, previousYear;\n      if (currentMonth === 1) {\n        previousMonth = 12;\n        previousYear = (currentYearFull - 1) % 100; // Jahr des Vormonats (Dezember des Vorjahres)\n      } else {\n        previousMonth = currentMonth - 1;\n        previousYear = currentYear;\n                }\n\n      // Erstelle Liste aller Monate, die behalten werden sollen\n      const monthsToKeep = [];\n\n      // Fge Vormonat hinzu\n      monthsToKeep.push({ year: previousYear, month: previousMonth });\n\n      // Fge alle angezeigten Monate hinzu\n      for (let i = 0; i < numberOfMonths; i++) {\n        const date = new Date(currentYearFull, currentMonth - 1 + i, 1);\n        const year = date.getFullYear() % 100;\n        const month = date.getMonth() + 1;\n        monthsToKeep.push({ year, month });\n                }\n\n      let hasChanges = false;\n\n      for (const key of Object.keys(this._workingDays)) {\n        // Parse den Key um zu prfen, ob er behalten werden soll\n        const keyParts = key.split(':');\n        if (keyParts.length === 2) {\n          const keyYear = parseInt(keyParts[0]);\n          const keyMonth = parseInt(keyParts[1]);\n\n          // Prfe ob dieser Key in der Liste der zu behaltenden Monate ist\n          const shouldKeep = monthsToKeep.some(m => m.year === keyYear && m.month === keyMonth);\n\n          //   key,\n          //   keyYear,\n          //   keyMonth,\n          //   shouldKeep,\n          //   monthsToKeep: monthsToKeep.map(m => `${m.year}:${m.month}`)\n          // });\n\n          if (!shouldKeep) {\n            delete this._workingDays[key];\n            hasChanges = true;\n                }\n        } else {\n          // Ungltiges Format, entfernen\n          delete this._workingDays[key];\n          hasChanges = true;\n                }\n                }\n\n      // Wenn nderungen vorgenommen wurden, speichere die bereinigten Daten\n      if (hasChanges) {\n        const cleanedValue = this.serializeWorkingDays();\n        try {\n          await this._hass.callService('input_text', 'set_value', {\n            entity_id: this._config.entity,\n            value: cleanedValue,\n          });\n        } catch (error) {                              }\n                }\n                }\n\n    this.requestUpdate();\n                }\n\n  _parseWorkingDaysIntoObject(dataString, targetObject) {\n    if (!dataString || dataString.trim() === '') return;\n\n    const parts = dataString.split(';').filter(p => p.trim() !== '');\n    for (const part of parts) {\n      const trimmedPart = part.trim();\n      if (!trimmedPart) continue;\n\n      // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen> oder altes Format\n      // Beispiel: \"25:11:01a,02ah,03b\" oder \"25:11:01,02,03\" (altes Format ohne Elemente)\n      const colons = trimmedPart.split(':');\n\n      if (colons.length === 2) {\n        // Altes Format ohne Jahr (Kompatibilitt): <monat>:<tag>,<tag>\n        const month = colons[0].trim();\n        const daysStr = colons[1].trim();\n        if (month && daysStr) {\n          const monthNum = parseInt(month);\n          if (!isNaN(monthNum) && monthNum >= 1 && monthNum <= 12) {\n            // Verwende aktuelles Jahr\n            const now = new Date();\n            const year = now.getFullYear() % 100;\n            const key = `${this.formatTwoDigits(year)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n                }\n      } else if (colons.length >= 3) {\n        // Prfe ob erstes Element ein Jahr ist (kleiner als 13) oder ein Monat\n        const first = parseInt(colons[0].trim());\n        const second = parseInt(colons[1].trim());\n\n        if (first <= 12 && second > 12) {\n          // Altes Format: <monat>:<jahr>:<tag>,<tag> - konvertiere zu neuem Format\n          const monthNum = first;\n          const yearNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n        } else if (first > 12 && second <= 12) {\n          // Neues Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n          const yearNum = first;\n          const monthNum = second;\n          const daysStr = colons.slice(2).join(':');\n          if (daysStr && monthNum >= 1 && monthNum <= 12 && !isNaN(yearNum)) {\n            const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n            targetObject[key] = this._parseDaysWithElements(daysStr);\n                }\n                }\n                }\n                }\n                }\n\n  // Parst Tage mit Elementen: \"01a,02ah,03b\" -> {1: [\"a\"], 2: [\"a\", \"h\"], 3: [\"b\"]                              }\n  // Oder altes Format ohne Elemente: \"01,02,03\" -> {1: [], 2: [], 3: []                              }\n  _parseDaysWithElements(daysStr) {\n    const result = {};\n    const dayEntries = daysStr.split(',').filter(d => d.trim() !== '');\n\n    for (const entry of dayEntries) {\n      const trimmed = entry.trim();\n      if (!trimmed) continue;\n\n      // Extrahiere Tag und Elemente: \"01a\" -> day=1, elements=[\"a\"]\n      // Oder: \"02ah\" -> day=2, elements=[\"a\", \"h\"]\n      // Oder altes Format: \"01\" -> day=1, elements=[]\n      const match = trimmed.match(/^(\\d+)([a-z]*)$/i);\n      if (match) {\n        const dayNum = parseInt(match[1]);\n        const elementsStr = match[2] || '';\n        // WICHTIG: Filtere nur leere Strings heraus, nicht einzelne Buchstaben\n        // split('') teilt jeden Buchstaben in ein separates Array-Element\n        const elements = elementsStr.split('').filter(e => e && e.trim() !== '');\n\n        if (!isNaN(dayNum) && dayNum >= 1 && dayNum <= 31) {\n          // Wenn der Tag bereits existiert, fge Elemente hinzu (keine Duplikate)\n          if (result[dayNum]) {\n            // Vereinige Arrays und entferne Duplikate\n            result[dayNum] = [...new Set([...result[dayNum], ...elements])];\n          } else {\n            result[dayNum] = elements;\n                }\n                }\n      } else {\n        // Debug-Log wenn kein Match gefunden wurde\n        if (trimmed.includes('03')) {\n          this._debug(`[Parsing] Kein Match fr \"${trimmed}\"`);\n                }\n                }\n                }\n\n    return result;\n                }\n\n  parseWorkingDays(dataString) {\n    this._workingDays = {};\n    this._parseWorkingDaysIntoObject(dataString, this._workingDays);\n                }\n\n  findAdditionalEntities(baseEntityId) {\n    const additionalEntities = [];\n\n    if (!this._hass || !this._hass.states) {\n      return additionalEntities;\n                }\n\n    // Extrahiere den Domain-Teil (z.B. \"input_text.arbeitszeiten\")\n    const entityParts = baseEntityId.split('.');\n    if (entityParts.length !== 2) {\n      return additionalEntities;\n                }\n\n    const [domain, baseName] = entityParts;\n\n    // Suche nach Entities mit _001, _002, etc. (bis _999)\n    for (let i = 1; i <= 999; i++) {\n      const suffix = String(i).padStart(3, '0'); // _001, _002, ..., _999\n      const additionalEntityId = `${domain}.${baseName}_${suffix}`;\n\n      if (this._hass?.states?.[additionalEntityId]) {\n        additionalEntities.push(additionalEntityId);\n      } else {\n        // Wenn eine Entity nicht existiert, breche ab (Entities sind sequenziell)\n        // Es macht keinen Sinn weiterzusuchen, wenn _001 fehlt\n        break;\n                }\n                }\n\n    return additionalEntities;\n                }\n\n  getEntityMaxLength(entityId) {\n    if (!this._hass || !this._hass.states || !entityId) {\n      return null;\n                }\n\n    const entity = this._hass?.states?.[entityId];\n    if (!entity || !entity.attributes) {\n      return null;\n                }\n\n    // input_text Entities haben ein 'max' Attribut, das die maximale Lnge definiert\n    const maxLength = entity.attributes.max;\n\n    if (maxLength !== undefined && maxLength !== null) {\n      return parseInt(maxLength);\n                }\n\n    return null;\n                }\n\n  getAllEntityMaxLengths() {\n    const maxLengths = {};\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      return maxLengths;\n                }\n\n    // Prfe Haupt-Entity\n    const mainEntityId = this._config.entity;\n    const mainMaxLength = this.getEntityMaxLength(mainEntityId);\n    if (mainMaxLength !== null) {\n      maxLengths[mainEntityId] = mainMaxLength;\n                }\n\n    // Prfe zustzliche Entities\n    const additionalEntities = this.findAdditionalEntities(mainEntityId);\n    for (const additionalEntityId of additionalEntities) {\n      const additionalMaxLength = this.getEntityMaxLength(additionalEntityId);\n      if (additionalMaxLength !== null) {\n        maxLengths[additionalEntityId] = additionalMaxLength;\n                }\n                }\n\n    return maxLengths;\n                }\n\n  checkStorageUsage(serializedDataLength = null) {\n    // Warnungen nur bei text_entity Modus (Saver hat keine Lngenbegrenzung)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    // Verwende _knownEntityIds falls verfgbar, sonst suche neu\n    let allEntityIds;\n    if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n      allEntityIds = [...this._knownEntityIds];\n    } else {\n      // Fallback: Suche Entities neu\n      allEntityIds = [this._config.entity, ...this.findAdditionalEntities(this._config.entity)];\n                }\n\n    const maxLengths = this.getAllEntityMaxLengths();\n    if (Object.keys(maxLengths).length === 0) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    // Berechne Gesamtlnge und maximale Gesamtlnge\n    let totalCurrentLength = 0;\n    let totalMaxLength = 0;\n\n    // Wenn eine serializedDataLength bergeben wurde, verwende diese (z.B. nach toggleDay)\n    // Ansonsten lese die Lngen aus den aktuellen States\n    if (serializedDataLength !== null && serializedDataLength !== undefined) {\n      totalCurrentLength = serializedDataLength;\n    } else {\n      // Lese Lngen aus den aktuellen States\n      for (const entityId of allEntityIds) {\n        const entity = this._hass?.states?.[entityId];\n        if (entity && entity.state) {\n          totalCurrentLength += entity.state.length;\n                }\n                }\n                }\n\n    // Berechne maximale Gesamtlnge\n    for (const entityId of allEntityIds) {\n      const maxLength = maxLengths[entityId];\n      if (maxLength !== undefined && maxLength !== null) {\n        totalMaxLength += maxLength;\n                }\n                }\n\n    if (totalMaxLength === 0) {\n      this._storageWarning = null;\n      this._updateStorageWarningDirectly();\n      return;\n                }\n\n    const percentage = (totalCurrentLength / totalMaxLength) * 100;\n\n    // Prfe ob 90% berschritten werden\n    if (percentage >= 90) {\n      this._storageWarning = {\n        show: true,\n        currentLength: totalCurrentLength,\n        maxLength: totalMaxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n    } else {\n      this._storageWarning = null;\n                }\n\n    // Aktualisiere Warnung direkt im DOM ohne Re-Rendering\n    this._updateStorageWarningDirectly();\n                }\n\n  getConfigEntityId() {\n    // Leite die Config-Entity-ID aus der Haupt-Entity ab\n    if (!this._config || !this._config.entity) {\n      return null;\n                }\n    // Fge \"_config\" an die Entity-ID an\n    // z.B. \"input_text.arbeitszeiten\" -> \"input_text.arbeitszeiten_config\"\n    return this._config.entity + '_config';\n                }\n\n  getStatusEntityId() {\n    // Leite die Status-Entity-ID aus der Haupt-Entity ab\n    if (!this._config || !this._config.entity) {\n      return null;\n                }\n    // Fge \"_status\" an die Entity-ID an\n    // z.B. \"input_text.arbeitszeiten\" -> \"input_text.arbeitszeiten_status\"\n    return this._config.entity + '_status';\n                }\n\n  checkConfigEntity() {\n    // Warnungen nur bei text_entity Modus (bei Saver wird Config anders gespeichert)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    // Prfe ob die Config-Entity existiert\n    if (!this._config || !this._config.entity) {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    // Wenn kein hass vorhanden ist (z.B. im Editor), zeige Warnung im Editor-Modus\n    if (!this._hass || !this._hass.states) {\n      if (this._isInEditorMode()) {\n        this._configWarning = {\n          show: true,\n          type: 'missing',\n          configEntityId: configEntityId,\n        };\n      } else {\n        this._configWarning = null;\n                }\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      this._configWarning = {\n        show: true,\n        type: 'missing',\n        configEntityId: configEntityId,\n      };\n    } else {\n      // Prfe ob es eine Gren-Warnung gibt, die beibehalten werden soll\n      if (this._configWarning && this._configWarning.type === 'size') {\n        // Behalte die Gren-Warnung\n      } else {\n        this._configWarning = null;\n                }\n                }\n\n    this._updateConfigWarningDirectly();\n                }\n\n  // Rendert eine Warnung fr eine fehlende Entity\n  _renderMissingEntityWarning(entityId, entityName, maxLength = 255, isConfig = false) {\n    const entityNameShort = entityId.replace('input_text.', '');\n    return html`\n      <div class=\"storage-warning\">\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">${entityName} fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${entityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hinzufgen  Text</li>\n              <li>Name: <code>${entityNameShort}</code></li>\n              <li>Maximale Lnge: <code>${maxLength}</code> Zeichen</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n                }\n\n  checkStatusEntity() {\n    // Warnungen nur bei text_entity Modus (bei Saver wird Status anders gespeichert)\n    if (this._config && this._config.store_mode === 'saver') {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    // Prfe ob die Status-Entity existiert\n    if (!this._config || !this._config.entity) {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    const statusEntityId = this.getStatusEntityId();\n    if (!statusEntityId) {\n      this._statusWarning = null;\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    // Wenn kein hass vorhanden ist (z.B. im Editor), zeige Warnung im Editor-Modus\n    if (!this._hass || !this._hass.states) {\n      if (this._isInEditorMode()) {\n        this._statusWarning = {\n          show: true,\n          type: 'missing',\n          statusEntityId: statusEntityId,\n        };\n      } else {\n        this._statusWarning = null;\n                }\n      this._updateStatusWarningDirectly();\n      return;\n                }\n\n    const statusEntity = this._hass.states[statusEntityId];\n    if (!statusEntity) {\n      this._statusWarning = {\n        show: true,\n        type: 'missing',\n        statusEntityId: statusEntityId,\n      };\n    } else {\n      this._statusWarning = null;\n                }\n\n    this._updateStatusWarningDirectly();\n                }\n\n  // Erstellt die Config-Daten im komprimierten Format (fr text_input Entities)\n  _createCompressedConfig(activeShifts) {\n    // Speichere als JSON (direktes Array, kein Objekt-Wrapper)\n    let configJson = JSON.stringify(activeShifts);\n\n    // Entferne die uere Klammer (erstes [ und letztes ])\n    if (configJson.startsWith('[') && configJson.endsWith(']')) {\n      configJson = configJson.slice(1, -1);\n                }\n\n    // Entferne \"null\" aus dem String (behalte Kommas)\n    // Wiederhole die Ersetzung, bis keine null mehr vorhanden sind (fr mehrere null hintereinander)\n    let previousLength;\n    do {\n      previousLength = configJson.length;\n      // Ersetze ,null, durch ,, (mehrfach, bis keine null mehr vorhanden sind)\n      configJson = configJson.replace(/,null,/g, ',,');\n      // Ersetze ,null] durch ,] (falls am Ende eines Arrays)\n      configJson = configJson.replace(/,null\\]/g, ',]');\n      // Ersetze [null, durch [, (falls am Anfang eines Arrays)\n      configJson = configJson.replace(/\\[null,/g, '[,');\n      // Ersetze ,null, am Ende des Strings (falls letztes Element null ist)\n      configJson = configJson.replace(/,null$/g, ',');\n    } while (configJson.length !== previousLength);\n\n    // Entferne Anfhrungszeichen um Strings\n    // Ersetze \",\" durch , (Anfhrungszeichen um Kommas)\n    configJson = configJson.replace(/\",\"/g, ',');\n    // Ersetze [\" durch [ (Anfhrungszeichen am Anfang eines Arrays)\n    configJson = configJson.replace(/\\[\"/g, '[');\n    // Ersetze \"] durch ] (Anfhrungszeichen am Ende eines Arrays)\n    configJson = configJson.replace(/\"\\]/g, ']');\n    // Ersetze ,\" durch , (Anfhrungszeichen nach Komma)\n    configJson = configJson.replace(/,\"/g, ',');\n    // Ersetze \", durch , (Anfhrungszeichen vor Komma)\n    configJson = configJson.replace(/\",/g, ',');\n\n    return configJson;\n                }\n\n  // Erstellt die Config-Daten im vollstndigen JSON-Format (fr Saver)\n  _createFullJsonConfig(activeShifts) {\n    // Vollstndiges JSON-Format: Objekt mit shifts, setup und lastchange\n    // Format: {shifts:[], setup:{}, lastchange:123456789                              }\n    const configObject = {\n      shifts: activeShifts,\n      setup: {\n        timer_entity: this._config?.entity || '',\n        store_mode: this._config?.store_mode || 'saver',\n      },\n      lastchange: Math.floor(Date.now() / 1000), // Unix-Timestamp (Sekunden seit 1970-01-01)\n    };\n    return JSON.stringify(configObject);\n                }\n\n  async saveConfigToEntity() {\n    this._debug('[Config] saveConfigToEntity: === START: Speichere Konfiguration ===');\n    \n    // Speichere die Konfiguration in der Config-Entity oder im Saver\n    // Verhindere Speichern beim initialen Load\n    if (this._isInitialLoad) {\n      this._debug('[Config] saveConfigToEntity: Initialer Load, berspringe Config-Speichern');\n      return;\n                }\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._debug('[Config] saveConfigToEntity: Abbruch - hass, config oder entity fehlt', {\n        hasHass: !!this._hass,\n        hasConfig: !!this._config,\n        hasEntity: !!(this._config && this._config.entity),\n      });\n      return;\n                }\n\n    this._debug('[Config] saveConfigToEntity: Prfe Konfiguration', {\n      store_mode: this._config.store_mode,\n      saver_key: this._config.saver_key,\n      entity: this._config.entity,\n      calendars_count: this._config.calendars ? this._config.calendars.length : 0,\n    });\n\n    // Debug: Zeige alle empfangenen Kalender-Daten\n    if (this._config.calendars && this._config.calendars.length > 0) {\n      this._debug('[Config] saveConfigToEntity: Empfangene Kalender-Daten:', \n        JSON.stringify(this._config.calendars, null, 2)\n      );\n      this._config.calendars.forEach((cal, index) => {\n        this._debug(`[Config] saveConfigToEntity: Kalender ${index + 1}:`, {\n          shortcut: cal.shortcut,\n          name: cal.name,\n          color: cal.color,\n          enabled: cal.enabled,\n          statusRelevant: cal.statusRelevant,\n          timeRanges_count: cal.timeRanges ? cal.timeRanges.length : 0,\n          timeRanges: cal.timeRanges || []\n        });\n      });\n    } else {\n      this._debug('[Config] saveConfigToEntity: Keine Kalender-Daten vorhanden');\n                }\n\n    // Verwende direkt das calendars-Format vom Config-Panel (keine Konvertierung mehr ntig)\n    const calendars = this._config.calendars || [];\n    \n    this._debug(`[Config] saveConfigToEntity: Speichere ${calendars.length} Kalender im neuen Format (direkt vom Config-Panel)`);\n    \n    // Debug: Zeige alle Kalender-Daten\n    calendars.forEach((cal, index) => {\n      this._debug(`[Config] saveConfigToEntity: Kalender ${index + 1}:`, {\n        shortcut: cal.shortcut,\n        name: cal.name,\n        color: cal.color,\n        enabled: cal.enabled,\n        statusRelevant: cal.statusRelevant,\n        timeRanges_count: cal.timeRanges ? cal.timeRanges.length : 0,\n        timeRanges: cal.timeRanges || []\n      });\n    });\n\n    // Stelle sicher, dass Storage initialisiert ist\n    if (!this._storage) {\n      this._debug('[Config] saveConfigToEntity: Storage nicht initialisiert, initialisiere...');\n      this._initializeStorage();\n                }\n\n    if (!this._storage) {\n      this._debug('[Config] saveConfigToEntity: Kein Storage-Adapter verfgbar');\n      return;\n                }\n\n    this._debug('[Config] saveConfigToEntity: Storage-Adapter gefunden, starte Speichern...', {\n      storageType: this._config.store_mode,\n      storageAdapter: this._storage.constructor.name\n    });\n\n    try {\n      // Verwende Storage-Adapter zum Speichern der Config\n      // Fr Saver: Direkt calendars-Format verwenden\n      // Fr Entity: Konvertierung zu komprimiertem Format (bleibt unverndert)\n      this._debug('[Config] saveConfigToEntity: Rufe _storage.saveConfig() auf...');\n      if (this._config.store_mode === 'saver') {\n        // Saver: Direkt calendars-Format verwenden\n        await this._storage.saveConfig(calendars);\n      } else {\n        // Entity: Konvertierung zu komprimiertem Format (fr Rckwrtskompatibilitt)\n        // TODO: Knnte spter auch auf calendars-Format umgestellt werden\n        const allShifts = this._convertCalendarsToShifts(calendars);\n        await this._storage.saveConfig(allShifts);\n                }\n\n      // Aktualisiere Warnungen\n      this._updateWarnings();\n      \n      this._debug('[Config] saveConfigToEntity: === ENDE: Erfolgreich gespeichert ===');\n    } catch (error) {\n      // Fehler beim Schreiben - versuche Fallback\n      this._debug(`[Config] saveConfigToEntity: === FEHLER === Beim Schreiben: ${error.message}`, error);\n      \n      // Fallback: Wenn SaverStorage fehlschlgt, versuche EntityStorage\n      if (this._config.store_mode === 'saver') {\n        this._debug('[Config] saveConfigToEntity: Fallback zu EntityStorage');\n        try {\n          const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n          // Entity-Storage bentigt komprimiertes Format\n          const allShifts = this._convertCalendarsToShifts(calendars);\n          await fallbackStorage.saveConfig(allShifts);\n          this._updateWarnings();\n        } catch (fallbackError) {\n          this._debug(`[Config] saveConfigToEntity: Auch Fallback fehlgeschlagen: ${fallbackError.message}`, fallbackError);\n          this.checkConfigEntity();\n                }\n      } else {\n        this.checkConfigEntity();\n                }\n                }\n                }\n\n  /**\n   * Konvertiert calendars-Format zu komprimiertem shifts-Format (fr Entity-Storage)\n   * @private\n   */\n  _convertCalendarsToShifts(calendars) {\n    const allShifts = [];\n    if (calendars && Array.isArray(calendars)) {\n      for (const calendar of calendars) {\n        if (calendar && calendar.shortcut) {\n          const isEnabled = calendar.enabled === true || calendar.enabled === 'true' || calendar.enabled === 1;\n          const shiftData = [\n            calendar.shortcut,\n            calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`,\n          ];\n\n          // Konvertiere Zeitrume vom neuen Format zu altem Format\n          if (calendar.timeRanges && Array.isArray(calendar.timeRanges) && calendar.timeRanges.length > 0) {\n            // Zeitraum 1\n            const range1 = calendar.timeRanges[0];\n            let start1 = null;\n            let end1 = null;\n            if (range1) {\n              if (typeof range1 === 'object' && range1.times && Array.isArray(range1.times)) {\n                start1 = range1.times[0] && range1.times[0].trim() !== '' ? range1.times[0].trim() : null;\n                end1 = range1.times[1] && range1.times[1].trim() !== '' ? range1.times[1].trim() : null;\n              } else if (Array.isArray(range1) && range1.length >= 2) {\n                start1 = range1[0] && range1[0].trim() !== '' ? range1[0].trim() : null;\n                end1 = range1[1] && range1[1].trim() !== '' ? range1[1].trim() : null;\n                }\n                }\n            shiftData.push(start1, end1);\n\n            // Zeitraum 2\n            const range2 = calendar.timeRanges[1];\n            let start2 = null;\n            let end2 = null;\n            if (range2) {\n              if (typeof range2 === 'object' && range2.times && Array.isArray(range2.times)) {\n                start2 = range2.times[0] && range2.times[0].trim() !== '' ? range2.times[0].trim() : null;\n                end2 = range2.times[1] && range2.times[1].trim() !== '' ? range2.times[1].trim() : null;\n              } else if (Array.isArray(range2) && range2.length >= 2) {\n                start2 = range2[0] && range2[0].trim() !== '' ? range2[0].trim() : null;\n                end2 = range2[1] && range2[1].trim() !== '' ? range2[1].trim() : null;\n                }\n                }\n            shiftData.push(start2, end2);\n          } else {\n            shiftData.push(null, null, null, null);\n                }\n\n          // statusRelevant\n          const statusRelevant = calendar.statusRelevant !== false ? 1 : 0;\n          shiftData.push(statusRelevant);\n\n          // enabled\n          const enabled = isEnabled ? 1 : 0;\n          shiftData.push(enabled);\n\n          allShifts.push(shiftData);\n                }\n                }\n                }\n    return allShifts;\n                }\n\n  async _saveConfigToEntityFallback(activeShifts) {\n    const configEntityId = this.getConfigEntityId();\n    if (!configEntityId) {\n      this._debug('[Config] _saveConfigToEntityFallback: Keine configEntityId');\n      return;\n                }\n\n    this._debug(`[Config] _saveConfigToEntityFallback: Start, configEntityId: \"${configEntityId}\"`);\n\n    // Prfe ob die Entity existiert\n    const configEntity = this._hass.states[configEntityId];\n    if (!configEntity) {\n      // Entity existiert nicht, zeige Warnung\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Entity \"${configEntityId}\" existiert nicht`\n      );\n      this.checkConfigEntity();\n      return;\n                }\n\n    // Komprimiertes Format fr text_input Entities\n    const configJson = this._createCompressedConfig(activeShifts);\n    const configJsonLength = configJson.length;\n    this._debug(\n      `[Config] _saveConfigToEntityFallback: Config erstellt (komprimiert), Lnge: ${configJsonLength} Zeichen`\n    );\n\n    // Prfe ob der JSON-Text in das Entity passt\n    const maxLength = this.getEntityMaxLength(configEntityId);\n    if (maxLength !== null && configJsonLength > maxLength) {\n      // JSON ist zu lang, zeige Warnung\n      const percentage = (configJsonLength / maxLength) * 100;\n      this._configWarning = {\n        show: true,\n        type: 'size',\n        configEntityId: configEntityId,\n        currentLength: configJsonLength,\n        maxLength: maxLength,\n        percentage: Math.round(percentage * 10) / 10,\n      };\n      this._updateConfigWarningDirectly();\n      return;\n                }\n\n    try {\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Schreibe Config in Entity \"${configEntityId}\"`\n      );\n      await this._hass.callService('input_text', 'set_value', {\n        entity_id: configEntityId,\n        value: configJson,\n      });\n      this._debug(`[Config] _saveConfigToEntityFallback: Erfolgreich in Entity geschrieben`);\n      // Warnung entfernen, da Entity existiert und erfolgreich beschrieben wurde\n      this._configWarning = null;\n      this._updateConfigWarningDirectly();\n    } catch (error) {\n      // Fehler beim Schreiben - knnte bedeuten, dass Entity nicht existiert\n      this._debug(\n        `[Config] _saveConfigToEntityFallback: Fehler beim Schreiben in Entity: ${error.message}`,\n        error\n      );\n      this.checkConfigEntity();\n                }\n                }\n\n  serializeWorkingDays() {\n    const parts = [];\n    // Sortiere nach Jahr:Monat\n    const keys = Object.keys(this._workingDays).sort((a, b) => {\n      const [yearA, monthA] = a.split(':').map(x => parseInt(x));\n      const [yearB, monthB] = b.split(':').map(x => parseInt(x));\n      if (yearA !== yearB) return yearA - yearB;\n      return monthA - monthB;\n    });\n\n    for (const key of keys) {\n      const days = this._workingDays[key];\n      if (!days || typeof days !== 'object' || Array.isArray(days)) continue;\n\n      // Struktur: {day: [elements]                              }\n      const dayEntries = Object.keys(days)\n        .map(d => parseInt(d))\n        .filter(d => !isNaN(d))\n        .sort((a, b) => a - b);\n\n      if (dayEntries.length > 0) {\n        // Format: <jahr>:<monat>:<tag><elementen>,<tag><elementen>\n        // Beispiel: \"25:11:01a,02ab,03b\"\n        const formattedDays = dayEntries\n          .map(dayNum => {\n            const elements = days[dayNum];\n            const dayStr = this.formatTwoDigits(dayNum);\n            if (Array.isArray(elements) && elements.length > 0) {\n              // Sortiere die Kalender-Shortcuts alphabetisch (a, b, c, d, e) fr konsistente Reihenfolge\n              const sortedElements = [...elements].sort();\n              // Tag mit Elementen: \"01a\", \"02ab\", etc.\n              return dayStr + sortedElements.join('');\n            } else {\n              // Tag ohne Elemente\n              return dayStr;\n                }\n})\n          .join(',');\n        parts.push(`${key}:${formattedDays}`);\n                }\n                }\n    return parts.join(';');\n                }\n\n  async distributeDataToEntities(serializedData) {\n    if (!this._hass || !this._config || !this._config.entity) {\n      this._debug('[Speichern] distributeDataToEntities: Kein hass, config oder entity vorhanden');\n      return;\n                }\n\n    this._debug(\n      `[Speichern] distributeDataToEntities: Start, Datenlnge: ${serializedData ? serializedData.length : 0} Zeichen`\n    );\n\n    // Setze Schreib-Lock\n    this._isWriting = true;\n    this._debug('[Speichern] distributeDataToEntities: Schreib-Lock gesetzt');\n\n    // Lsche vorhandenen Timer, falls vorhanden\n    if (this._writeLockTimer) {\n      clearTimeout(this._writeLockTimer);\n      this._writeLockTimer = null;\n                }\n\n    try {\n      // Verwende die gecachte Liste der Entities, falls verfgbar\n      // Prfe aber auch, ob neue Entities hinzugekommen sind\n      let allEntityIds;\n      if (this._knownEntityIds && this._knownEntityIds.length > 0) {\n        // Verwende gecachte Liste\n        allEntityIds = [...this._knownEntityIds];\n\n        // Prfe ob neue Entities hinzugekommen sind\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds.length - 1; // -1 fr Haupt-Entity\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          // Neue Entities gefunden, aktualisiere die Liste\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n                }\n      } else {\n        // Keine gecachte Liste vorhanden, sammle Entities neu\n        allEntityIds = [this._config.entity];\n        const additionalEntities = this.findAdditionalEntities(this._config.entity);\n        allEntityIds.push(...additionalEntities);\n        this._knownEntityIds = [...allEntityIds];\n                }\n\n      this._debug(\n        `[Speichern] distributeDataToEntities: Verwende ${allEntityIds.length} Entities: ${allEntityIds.join(', ')}`\n      );\n\n      // Ermittle die maximale Lnge fr jede Entity\n      const maxLengths = {};\n      let totalMaxLength = 0;\n      for (const entityId of allEntityIds) {\n        const maxLength = this.getEntityMaxLength(entityId);\n        if (maxLength !== null) {\n          maxLengths[entityId] = maxLength;\n          totalMaxLength += maxLength;\n        } else {\n          // Wenn keine max-Lnge bekannt ist, verwende einen Standardwert (z.B. 255)\n          maxLengths[entityId] = 255;\n          totalMaxLength += 255;\n                }\n                }\n\n      // Debug: Zeige wie viele Zeichen wir schreiben wollen vs. knnen\n      const dataLength = serializedData ? serializedData.length : 0;\n      this._debug(\n        `[Speichern] distributeDataToEntities: Datenlnge: ${dataLength} Zeichen, verfgbarer Speicher: ${totalMaxLength} Zeichen`\n      );\n\n      // Wenn keine Daten vorhanden sind, setze alle Entities auf leer\n      if (!serializedData || serializedData.trim() === '') {\n        this._debug(\n          '[Speichern] distributeDataToEntities: Keine Daten vorhanden, setze alle Entities auf leer'\n        );\n        for (const entityId of allEntityIds) {\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: '',\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Entity \"${entityId}\" auf leer gesetzt`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Leeren von \"${entityId}\": ${error.message}`\n            );\n                }\n                }\n        // Setze Timer auch wenn keine Daten vorhanden waren\n        this._writeLockTimer = setTimeout(() => {\n          this._isWriting = false;\n          this._writeLockTimer = null;\n          this._debug(\n            '[Speichern] distributeDataToEntities: Schreib-Lock nach 5 Sekunden entfernt (keine Daten)'\n          );\n        }, 5000);\n        return;\n                }\n\n      // Verteile die Daten zeichenweise auf die Entities (umgekehrt zum Einlesen)\n      // Wir haben einen Datenstring ber alles und schreiben nur so viele Zeichen wie aufgenommen werden knnen\n      const entityValues = {};\n      let currentEntityIndex = 0;\n      let remainingData = serializedData;\n\n      // Verteile die Daten auf die verfgbaren Entities\n      while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n        const currentEntityId = allEntityIds[currentEntityIndex];\n        const maxLength = maxLengths[currentEntityId];\n\n        // Nimm so viele Zeichen wie mglich aus remainingData\n        const charsToTake = Math.min(remainingData.length, maxLength);\n        const valueToWrite = remainingData.substring(0, charsToTake);\n\n        entityValues[currentEntityId] = valueToWrite;\n        remainingData = remainingData.substring(charsToTake);\n\n        // Wenn noch Daten brig sind, wechsle zur nchsten Entity\n        if (remainingData.length > 0) {\n          currentEntityIndex++;\n                }\n                }\n\n      // Wenn am Ende noch Text ber ist, prfe ob zwischenzeitlich eine zustzliche Entitt angelegt wurde\n      if (remainingData.length > 0) {\n        // Prfe ob neue Entities hinzugekommen sind\n        const currentAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n        const knownAdditionalCount = this._knownEntityIds ? this._knownEntityIds.length - 1 : 0; // -1 fr Haupt-Entity\n\n        if (currentAdditionalEntities.length > knownAdditionalCount) {\n          // Neue Entities gefunden\n          const newEntities = currentAdditionalEntities.slice(knownAdditionalCount);\n\n          // Aktualisiere die Liste\n          allEntityIds.push(...newEntities);\n          this._knownEntityIds = [...allEntityIds];\n\n          // Ermittle max-Lngen fr neue Entities\n          for (const newEntityId of newEntities) {\n            const maxLength = this.getEntityMaxLength(newEntityId);\n            if (maxLength !== null) {\n              maxLengths[newEntityId] = maxLength;\n            } else {\n              maxLengths[newEntityId] = 255;\n                }\n                }\n\n          // Verteile die verbleibenden Daten auf die neuen Entities\n          currentEntityIndex = allEntityIds.length - newEntities.length;\n          while (remainingData.length > 0 && currentEntityIndex < allEntityIds.length) {\n            const currentEntityId = allEntityIds[currentEntityIndex];\n            const maxLength = maxLengths[currentEntityId];\n\n            const charsToTake = Math.min(remainingData.length, maxLength);\n            const valueToWrite = remainingData.substring(0, charsToTake);\n\n            entityValues[currentEntityId] = valueToWrite;\n            remainingData = remainingData.substring(charsToTake);\n\n            if (remainingData.length > 0) {\n              currentEntityIndex++;\n                }\n                }\n        } else {\n                }\n                }\n\n      // Schreibe die Werte in die Entities (sequenziell, um sicherzustellen, dass alle Calls abgeschlossen sind)\n      this._debug(\n        `[Speichern] distributeDataToEntities: Schreibe in ${allEntityIds.length} Entities`\n      );\n      for (const entityId of allEntityIds) {\n        const value = entityValues[entityId] || '';\n        const maxLength = maxLengths[entityId];\n\n        // Der Wert sollte nie die maximale Lnge berschreiten, da wir zeichenweise verteilen\n        if (value.length > maxLength) {\n          // Krze den Wert auf die maximale Lnge (als Notfall-Lsung)\n          const truncatedValue = value.substring(0, maxLength);\n          this._debug(\n            `[Speichern] distributeDataToEntities: Schreibe in \"${entityId}\" (gekrzt von ${value.length} auf ${truncatedValue.length} Zeichen)`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: truncatedValue,\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Erfolgreich in \"${entityId}\" geschrieben`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n            );\n                }\n        } else {\n          this._debug(\n            `[Speichern] distributeDataToEntities: Schreibe in \"${entityId}\" (${value.length} Zeichen)`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: entityId,\n              value: value,\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Erfolgreich in \"${entityId}\" geschrieben`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Schreiben in \"${entityId}\": ${error.message}`\n            );\n                }\n                }\n                }\n\n      // Leere alle zustzlichen Entities, die nicht verwendet wurden (um alte Daten zu entfernen)\n      // Wir mssen alle bekannten zustzlichen Entities prfen, nicht nur die in allEntityIds\n      const allAdditionalEntities = this.findAdditionalEntities(this._config.entity);\n      this._debug(\n        `[Speichern] distributeDataToEntities: Prfe ${allAdditionalEntities.length} zustzliche Entities zum Leeren`\n      );\n      for (const additionalEntityId of allAdditionalEntities) {\n        // Wenn diese Entity nicht in entityValues ist, bedeutet das, dass sie nicht verwendet wurde\n        if (!(additionalEntityId in entityValues)) {\n          this._debug(\n            `[Speichern] distributeDataToEntities: Leere nicht verwendete Entity \"${additionalEntityId}\"`\n          );\n          try {\n            await this._hass.callService('input_text', 'set_value', {\n              entity_id: additionalEntityId,\n              value: '',\n            });\n            this._debug(\n              `[Speichern] distributeDataToEntities: Entity \"${additionalEntityId}\" erfolgreich geleert`\n            );\n          } catch (error) {\n            this._debug(\n              `[Speichern] distributeDataToEntities: Fehler beim Leeren von \"${additionalEntityId}\": ${error.message}`\n            );\n                }\n                }\n                }\n\n      // Wenn noch Daten brig sind, die nicht gespeichert werden konnten\n      if (remainingData.length > 0) {\n        this._debug(\n          `[Speichern] distributeDataToEntities: WARNUNG - ${remainingData.length} Zeichen konnten nicht gespeichert werden!`\n        );\n                }\n    } catch (error) {\n      this._debug(\n        `[Speichern] distributeDataToEntities: Fehler beim Verteilen der Daten: ${error.message}`,\n        error\n      );\n    } finally {\n      // Schreib-Lock fr weitere 5 Sekunden aufrechterhalten (um sicherzustellen, dass alle Updates verarbeitet wurden)\n      this._writeLockTimer = setTimeout(() => {\n        this._isWriting = false;\n        this._writeLockTimer = null;\n        this._debug('[Speichern] distributeDataToEntities: Schreib-Lock nach 5 Sekunden entfernt');\n      }, 5000);\n      this._debug(\n        '[Speichern] distributeDataToEntities: Abgeschlossen, Schreib-Lock wird in 5 Sekunden entfernt'\n      );\n                }\n                }\n\n  async toggleDay(month, day, year = null) {\n    // Stelle sicher, dass month und day Zahlen sind\n    const monthNum = parseInt(month);\n    const dayNum = parseInt(day);\n\n    if (isNaN(monthNum) || isNaN(dayNum)) {\n      return;\n                }\n\n    // Prfe ob dieser Monat der Vormonat ist (schreibgeschtzt)\n    const now = new Date();\n    const currentMonth = now.getMonth() + 1; // 1-12\n    const currentYearFull = now.getFullYear();\n    const currentYear = currentYearFull % 100;\n\n    // Bestimme das Jahr (Kurzform, z.B. 25 fr 2025)\n    if (!year) {\n      year = currentYear;\n                }\n    const yearNum = parseInt(year);\n\n    let isPreviousMonth = false;\n    if (currentMonth === 1) {\n      // Aktuell ist Januar, Vormonat ist Dezember des Vorjahres\n      isPreviousMonth = monthNum === 12 && yearNum === (currentYearFull - 1) % 100;\n    } else {\n      // Vormonat ist aktueller Monat - 1 im gleichen Jahr\n      isPreviousMonth = monthNum === currentMonth - 1 && yearNum === currentYear;\n                }\n\n    if (isPreviousMonth) {\n      return;\n                }\n\n    // Prfe ob hass und config vorhanden sind\n    // Im Saver-Modus wird keine entity bentigt\n    if (!this._hass || !this._config) {\n      return;\n                }\n\n    // Bei text_entity Modus muss eine entity vorhanden sein\n    if (this._config.store_mode !== 'saver' && !this._config.entity) {\n      return;\n                }\n\n    // yearNum wurde bereits oben deklariert\n    const key = `${this.formatTwoDigits(yearNum)}:${this.formatTwoDigits(monthNum)}`;\n\n    // Stelle sicher, dass die Struktur ein Objekt ist (nicht Array)\n    if (!this._workingDays[key] || Array.isArray(this._workingDays[key])) {\n      this._workingDays[key] = {};\n                }\n\n    // Hole das ausgewhlte Kalender-Shortcut\n    const selectedCalendarShortcut = this._getSelectedCalendarShortcut();\n\n    if (!selectedCalendarShortcut) {\n      // Kein Kalender ausgewhlt - kann nicht togglen\n      return;\n                }\n\n    // Tag mit Kalender\n    if (!this._workingDays[key][dayNum]) {\n      this._workingDays[key][dayNum] = [];\n                }\n\n    // WICHTIG: Erstelle eine Kopie des Arrays, um sicherzustellen, dass wir mit dem richtigen Array arbeiten\n    const elements = [...(this._workingDays[key][dayNum] || [])];\n\n    const elementIndex = elements.indexOf(selectedCalendarShortcut);\n\n    // MARKIERE BUTTON ALS \"WIRD DIREKT AKTUALISIERT\" BEVOR _workingDays GENDERT WIRD\n    // Dies verhindert, dass Lit ein Update auslst, whrend wir direkt manipulieren\n    const buttonKey = `${yearNum}:${monthNum}:${dayNum}`;\n    this._directDOMUpdateInProgress.add(buttonKey);\n\n    let finalElements = [];\n\n    if (elementIndex > -1) {\n      // Kalender entfernen\n      elements.splice(elementIndex, 1);\n      // Speichere die finalen Elemente BEVOR wir mglicherweise den Monat lschen\n      finalElements = elements;\n      // Wenn keine Kalender mehr vorhanden sind, entferne den Tag\n      if (elements.length === 0) {\n        delete this._workingDays[key][dayNum];\n        // Wenn keine Tage mehr vorhanden sind, entferne den Monat\n        if (Object.keys(this._workingDays[key]).length === 0) {\n          delete this._workingDays[key];\n                }\n      } else {\n        // Aktualisiere das Array im _workingDays\n        this._workingDays[key][dayNum] = elements;\n                }\n    } else {\n      // Kalender hinzufgen (nur wenn noch nicht vorhanden)\n      if (!elements.includes(selectedCalendarShortcut)) {\n        elements.push(selectedCalendarShortcut);\n        // Aktualisiere das Array im _workingDays\n        this._workingDays[key][dayNum] = elements;\n                }\n      // Speichere die finalen Elemente\n      finalElements =\n        this._workingDays[key] && this._workingDays[key][dayNum]\n          ? this._workingDays[key][dayNum]\n          : elements;\n                }\n\n    // OPTIMIERUNG: Direkte DOM-Manipulation statt komplettes Re-Rendering\n    // Verwende die finalen elements (bereits vor dem mglichen Lschen gespeichert)\n    this._updateDayButtonDirectly(monthNum, dayNum, yearNum, key, finalElements);\n\n    // OPTIMIERUNG: Debounced Speichern - warte nach dem letzten Klick, bevor gespeichert wird\n    this._debug(`[Sync] toggleDay: Tag gendert (${yearNum}:${monthNum}:${dayNum}), plane Speichern fr Synchronisation`);\n    this._scheduleDebouncedSave();\n                }\n\n  // Plant ein debounced Speichern der Daten\n  _scheduleDebouncedSave() {\n    // Lese Debounce-Zeit aus der Config (Standard: 300ms)\n    const debounceTime = this._getSaveDebounceTime();\n\n    // Wenn Debounce-Zeit 0 ist, speichere sofort\n    if (debounceTime === 0) {\n      this._debug('[Sync] _scheduleDebouncedSave: Speichere sofort (Debounce=0)');\n      this._saveToHA();\n      return;\n                }\n\n    // Lsche vorhandenen Timer\n    if (this._saveDebounceTimer) {\n      this._debug(`[Sync] _scheduleDebouncedSave: Timer bereits vorhanden, setze neu (${debounceTime}ms)`);\n      clearTimeout(this._saveDebounceTimer);\n      this._saveDebounceTimer = null;\n                } else {\n      this._debug(`[Sync] _scheduleDebouncedSave: Neuer Timer gesetzt (${debounceTime}ms)`);\n                }\n\n    // Setze neuen Timer\n    this._saveDebounceTimer = setTimeout(() => {\n      this._saveDebounceTimer = null;\n      this._debug('[Sync] _scheduleDebouncedSave: Timer abgelaufen, speichere jetzt');\n      this._saveToHA();\n    }, debounceTime);\n                }\n\n  // Speichert die Daten asynchron in Home Assistant\n  async _saveToHA() {\n    try {\n      this._debug('[Speichern] _saveToHA: Start');\n      \n      // Stelle sicher, dass Storage initialisiert ist\n      if (!this._storage) {\n        this._initializeStorage();\n                }\n\n      if (!this._storage) {\n        this._debug('[Speichern] _saveToHA: Kein Storage-Adapter verfgbar');\n        return;\n                }\n\n      const serializedData = this.serializeWorkingDays();\n      this._debug(\n        `[Speichern] _saveToHA: Daten serialisiert, Lnge: ${serializedData.length} Zeichen, store_mode: \"${this._config.store_mode}\"`\n      );\n\n      // Setze Schreib-Lock\n      this._isWriting = true;\n      if (this._writeLockTimer) {\n        clearTimeout(this._writeLockTimer);\n                }\n\n      try {\n        // Verwende Storage-Adapter zum Speichern\n        await this._storage.saveData(serializedData);\n        \n        // Prfe Speicherverbrauch (nur fr EntityStorage relevant)\n        const storageUsage = this._storage.checkStorageUsage(serializedData.length);\n        if (storageUsage) {\n          this._storageWarning = storageUsage;\n          this._updateStorageWarningDirectly();\n        } else {\n          this._storageWarning = null;\n          this._updateStorageWarningDirectly();\n                }\n\n        this._debug('[Speichern] _saveToHA: Erfolgreich abgeschlossen');\n      } catch (error) {\n        // Fehler beim Speichern - versuche Fallback\n        this._debug(`[Speichern] _saveToHA: Fehler beim Speichern, versuche Fallback: ${error.message}`, error);\n        \n        // Fallback: Wenn SaverStorage fehlschlgt, versuche EntityStorage\n        if (this._config.store_mode === 'saver') {\n          this._debug('[Speichern] _saveToHA: Fallback zu EntityStorage');\n          const fallbackStorage = StorageFactory.createStorage(this._hass, { ...this._config, store_mode: 'text_entity' }, this._debug.bind(this));\n          await fallbackStorage.saveData(serializedData);\n        } else {\n          throw error; // Bei EntityStorage gibt es keinen Fallback\n                }\n      } finally {\n        // Setze Timer fr Schreib-Lock (5 Sekunden)\n        this._writeLockTimer = setTimeout(() => {\n          this._isWriting = false;\n          this._writeLockTimer = null;\n          this._debug('[Speichern] _saveToHA: Schreib-Lock entfernt');\n        }, 5000);\n                }\n    } catch (error) {\n      this._debug(`[Speichern] _saveToHA: Fehler beim Speichern: ${error.message}`, error);\n      console.error('[TG Schichtplan] Fehler beim Speichern:', error);\n      // Optional: Hier knnte man eine Fehlermeldung anzeigen\n                }\n                }\n\n  // Speichert Daten in den Saver\n  async _saveDataToSaver(serializedData) {\n    if (!this._hass || !this._config || !this._config.saver_key) {\n      this._debug('[Speichern] _saveDataToSaver: Kein hass, config oder saver_key vorhanden');\n      return;\n                }\n\n    const saverKey = this._config.saver_key || 'Schichtplan';\n    this._debug(\n      `[Speichern] _saveDataToSaver: Start, saver_key: \"${saverKey}\", Datenlnge: ${serializedData.length} Zeichen`\n    );\n\n    try {\n      // Prfe ob die Saver-Variable existiert und ob sich der Wert gendert hat\n      // Saver-Variablen sind in saver.saver.attributes.variables gespeichert\n      const saverEntity = this._hass?.states?.['saver.saver'];\n      let oldValue = '';\n\n      if (saverEntity && saverEntity.attributes && saverEntity.attributes.variables) {\n        const existingValue = saverEntity.attributes.variables[saverKey];\n        if (existingValue !== undefined && existingValue !== null) {\n          oldValue = String(existingValue).trim();\n                }\n                }\n\n      this._debug(\n        `[Speichern] _saveDataToSaver: Saver-Variable \"${saverKey}\" existiert: ${oldValue !== ''}, alte Lnge: ${oldValue.length} Zeichen`\n      );\n\n      // Nur schreiben wenn Variable nicht existiert oder Wert sich gendert hat\n      if (oldValue === '' || oldValue !== serializedData) {\n        this._debug(\n          `[Speichern] _saveDataToSaver: Schreibe in Saver (Variable existiert nicht oder Wert hat sich gendert)`\n        );\n        await this._hass.callService('saver', 'set_variable', {\n          name: saverKey,\n          value: serializedData || '',\n        });\n        this._debug(`[Speichern] _saveDataToSaver: Erfolgreich in Saver geschrieben`);\n      } else {\n        this._debug(\n          `[Speichern] _saveDataToSaver: Kein Schreiben ntig, Wert hat sich nicht gendert`\n        );\n                }\n    } catch (error) {\n      // Fehler beim Schreiben in Saver - Fallback zu Entities\n      this._debug(\n        `[Speichern] _saveDataToSaver: Fehler beim Schreiben in Saver, Fallback zu Entities: ${error.message}`,\n        error\n      );\n      console.warn('[TG Schichtplan] Fehler beim Schreiben in Saver, Fallback zu Entities:', error);\n      await this.distributeDataToEntities(serializedData);\n                }\n                }\n\n  // Liest die Debounce-Zeit aus der Config\n  _getSaveDebounceTime() {\n    // Versuche aus Config zu lesen\n    if (this._config && typeof this._config.saveDebounceTime === 'number') {\n      return Math.max(0, this._config.saveDebounceTime); // Mindestens 0\n                }\n\n    // Fallback: Verwende Standard-Wert aus card-config.js\n    return SaveDebounceTime || 300; // Standard: 300ms\n                }\n\n  // Aktualisiert einen einzelnen Button direkt im DOM ohne komplettes Re-Rendering\n  _updateDayButtonDirectly(monthNum, dayNum, yearNum, key, dayElements) {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    // Button sollte bereits in _directDOMUpdateInProgress sein (wurde in toggleDay gesetzt)\n    // Falls nicht, fge ihn hinzu (Fallback fr direkte Aufrufe)\n    const buttonKey = `${yearNum}:${monthNum}:${dayNum}`;\n    if (!this._directDOMUpdateInProgress.has(buttonKey)) {\n      this._directDOMUpdateInProgress.add(buttonKey);\n                }\n\n    // Finde den Button im DOM\n    const button = this.shadowRoot.querySelector(\n      `button[data-month=\"${monthNum}\"][data-day=\"${dayNum}\"][data-year=\"${yearNum}\"]`\n    );\n\n    if (!button) {\n      // Button nicht gefunden, Fallback zu requestUpdate\n      this._directDOMUpdateInProgress.delete(buttonKey);\n      this.requestUpdate();\n      return;\n                }\n\n    // Berechne die neuen Werte fr diesen Button\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n\n    // Finde die erste aktivierte Schicht\n    let firstActiveShift = null;\n    const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n    for (const shortcut of shiftOrder) {\n      if (dayElements.includes(shortcut)) {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled) {\n          firstActiveShift = shortcut;\n          break;\n                }\n                }\n                }\n\n    // Bestimme welche Schicht den Tag frben soll\n    let activeShiftForColor = null;\n    if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n      activeShiftForColor = selectedShortcut;\n    } else if (firstActiveShift) {\n      activeShiftForColor = firstActiveShift;\n                }\n\n    const isWorking = activeShiftForColor !== null;\n\n    // Aktualisiere CSS-Klasse\n    if (isWorking) {\n      button.classList.add('working');\n    } else {\n      button.classList.remove('working');\n                }\n\n    // Aktualisiere Hintergrundfarbe\n    if (activeShiftForColor) {\n      const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n      if (activeCalendar && activeCalendar.color) {\n        button.style.backgroundColor = activeCalendar.color;\n      } else {\n        button.style.backgroundColor = '';\n                }\n    } else {\n      button.style.backgroundColor = '';\n                }\n\n    // Aktualisiere Shift-Indikatoren\n    // Entferne zuerst alle vorhandenen Container und Indikatoren\n    const existingContainer = button.querySelector('.shifts-container');\n    if (existingContainer) {\n      existingContainer.remove();\n                }\n\n    // Erstelle neue Indikatoren fr alle Schichten auer der, die den Tag frbt\n    const shiftIndicators = dayElements\n      .filter(shortcut => shortcut !== activeShiftForColor)\n      .map(shortcut => {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled && calendar.color) {\n          const indicator = document.createElement('span');\n          indicator.className = 'shift-indicator';\n          indicator.style.backgroundColor = calendar.color;\n          indicator.title = calendar.name || `Schicht ${shortcut.toUpperCase()}`;\n          return indicator;\n                }\n        return null;\n      })\n      .filter(indicator => indicator !== null);\n\n    // Fge Indikatoren nur hinzu, wenn welche vorhanden sind\n    if (shiftIndicators.length > 0) {\n      const container = document.createElement('div');\n      container.className = 'shifts-container';\n      // Markiere Container als manuell erstellt, damit das Template sie nicht berschreibt\n      container.setAttribute('data-manual-update', 'true');\n      shiftIndicators.forEach(ind => container.appendChild(ind));\n      button.appendChild(container);\n                }\n\n    // Entferne Markierung nach Abschluss der direkten DOM-Manipulation\n    // Verzgert, damit Lit-Updates, die durch _workingDays-nderung ausgelst werden, bersprungen werden knnen\n    setTimeout(() => {\n      this._directDOMUpdateInProgress.delete(buttonKey);\n    }, 100); // Lnger warten, damit Lit-Updates abgeschlossen sind\n                }\n\n  getDaysInMonth(year, month) {\n    return new Date(year, month + 1, 0).getDate();\n                }\n\n  getFirstDayOfMonth(year, month) {\n    return new Date(year, month, 1).getDay();\n                }\n\n  getWeekNumber(date) {\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n    const dayNum = d.getUTCDay() || 7;\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n    return Math.ceil(((d - yearStart) / 86400000 + 1) / 7);\n                }\n\n  getMonthName(month) {\n    const months = [\n      'Januar',\n      'Februar',\n      'Mrz',\n      'April',\n      'Mai',\n      'Juni',\n      'Juli',\n      'August',\n      'September',\n      'Oktober',\n      'November',\n      'Dezember',\n    ];\n    return months[month];\n                }\n\n  /**\n   * Rendert einen einzelnen Tag-Button fr den Kalender\n   * @param {number} currentDay - Der Tag (1-31)\n   * @param {number} monthKey - Der Monat (1-12)\n   * @param {number} yearKey - Das Jahr in Kurzform (z.B. 25 fr 2025)\n   * @param {string} key - Der Schlssel fr diesen Monat (z.B. \"25:11\")\n   * @param {number[]} workingDays - Array der Arbeitstage fr diesen Monat\n   * @param {boolean} isPreviousMonth - Ob dieser Monat der Vormonat ist (schreibgeschtzt)\n   * @param {number} year - Das vollstndige Jahr\n   * @param {number} month - Der Monat (0-11)\n   * @returns {TemplateResult} HTML-Template fr den Tag-Button\n   */\n  renderDay(currentDay, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month) {\n    const now = new Date();\n    const today = now.getDate();\n    const currentMonth = now.getMonth();\n    const currentYear = now.getFullYear();\n\n    const dayElements = this._getDayElements(key, currentDay);\n    const isToday = year === currentYear && month === currentMonth && currentDay === today;\n\n    // Prfe ob der ausgewhlte Kalender an diesem Tag aktiv ist\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n    let buttonStyle = '';\n\n    // Finde die erste aktivierte Schicht (in der Reihenfolge a, b, c, d, e)\n    // die an diesem Tag aktiv ist\n    let firstActiveShift = null;\n    const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n    for (const shortcut of shiftOrder) {\n      if (dayElements.includes(shortcut)) {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        if (calendar && calendar.enabled) {\n          firstActiveShift = shortcut;\n          break;\n                }\n                }\n                }\n\n    // Bestimme welche Schicht den Tag frben soll\n    let activeShiftForColor = null;\n    if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n      // Wenn der ausgewhlte Kalender aktiv ist, verwende diesen\n      activeShiftForColor = selectedShortcut;\n    } else if (firstActiveShift) {\n      // Ansonsten verwende die erste aktivierte Schicht\n      activeShiftForColor = firstActiveShift;\n                }\n\n    // isWorking ist true, wenn eine Schicht den Tag frbt\n    const isWorking = activeShiftForColor !== null;\n\n    // Verwende die Farbe der aktiven Schicht\n    if (activeShiftForColor) {\n      const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n      if (activeCalendar && activeCalendar.color) {\n        buttonStyle = `background-color: ${activeCalendar.color};`;\n                }\n                }\n\n    // Prfe ob es ein Wochenende oder Feiertag ist\n    const isWeekend = this._isWeekend(year, month, currentDay);\n    const isHoliday = this._isHoliday(year, month, currentDay);\n\n    // Erstelle visuelle Darstellung der Kalender (alle auer der Schicht, die den Tag frbt)\n    // Nur aktivierte Kalender werden angezeigt\n    const shiftIndicators = dayElements\n      .filter(shortcut => shortcut !== activeShiftForColor) // Filtere die Schicht heraus, die den Tag frbt\n      .map(shortcut => {\n        const calendar = this._getCalendarByShortcut(shortcut);\n        // Nur anzeigen, wenn der Kalender aktiviert ist\n        if (calendar && calendar.enabled && calendar.color) {\n          return html`\n            <span\n              class=\"shift-indicator\"\n              style=\"background-color: ${calendar.color};\"\n              title=\"${calendar.name || `Schicht ${shortcut.toUpperCase()}`}\"\n            >\n            </span>\n          `;\n                }\n        return null; // Nicht anzeigen, wenn Kalender deaktiviert ist\n      })\n      .filter(indicator => indicator !== null); // Entferne null-Werte\n\n    return html`\n      <td>\n        <button\n          class=\"day-button ${isWorking ? 'working' : ''} ${isToday\n            ? 'today'\n            : ''} ${isPreviousMonth ? 'readonly' : ''} ${isWeekend ? 'weekend' : ''} ${isHoliday\n            ? 'holiday'\n            : ''}\"\n          style=\"${buttonStyle}\"\n          @click=${e => {\n            if (!isPreviousMonth) {\n              this.toggleDay(monthKey, currentDay, yearKey);\n              // Entferne Fokus nach Klick (wichtig fr mobile Gerte)\n              // Setze Fokus explizit auf die Karte selbst\n              setTimeout(() => {\n                e.target.blur();\n                // Setze Fokus auf das Hauptcontainer-Element der Karte\n                if (this.shadowRoot) {\n                  const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n                  if (wrapper) {\n                    // Stelle sicher, dass das Element fokussierbar ist\n                    if (!wrapper.hasAttribute('tabindex')) {\n                      wrapper.setAttribute('tabindex', '-1');\n                }\n          wrapper.focus();\n                  } else {\n                    // Fallback: Setze Fokus auf die Komponente selbst\n                    if (this.focus) {\n                      this.focus();\n                }\n                }\n                }\n    }, 0);\n                }\n}                              }\n          ?disabled=${isPreviousMonth                              }\n          data-month=\"${monthKey}\"\n          data-day=\"${currentDay}\"\n          data-year=\"${yearKey}\"\n        >\n          <span class=\"day-number\">${currentDay}</span>\n          ${(() => {\n            // Prfe ob dieser Button bereits manuell aktualisiert wurde\n            // Wenn ja, rendere keine Indikatoren (werden per direkter DOM-Manipulation verwaltet)\n            const buttonKey = `${yearKey}:${monthKey}:${currentDay}`;\n            if (this._directDOMUpdateInProgress && this._directDOMUpdateInProgress.has(buttonKey)) {\n              return '';\n                }\n  // Prfe auch, ob im DOM bereits ein manuell erstellter Container existiert\n            if (this.shadowRoot) {\n              const existingButton = this.shadowRoot.querySelector(\n                `button[data-month=\"${monthKey}\"][data-day=\"${currentDay}\"][data-year=\"${yearKey}\"]`\n              );\n              if (\n                existingButton &&\n                existingButton.querySelector('.shifts-container[data-manual-update=\"true\"]')\n              ) {\n                return '';\n                }\n                }\n            return shiftIndicators.length > 0\n              ? html`<div class=\"shifts-container\">${shiftIndicators}</div>`\n              : '';\n          })()                              }\n        </button>\n      </td>\n    `;\n                }\n\n  renderMonth(year, month) {\n    const daysInMonth = this.getDaysInMonth(year, month);\n    const firstDay = this.getFirstDayOfMonth(year, month);\n    const firstDayMonday = (firstDay + 6) % 7;\n\n    const monthKey = month + 1;\n    const yearKey = year % 100; // Kurzform, z.B. 25 fr 2025\n    const key = `${this.formatTwoDigits(yearKey)}:${this.formatTwoDigits(monthKey)}`;\n\n    // Hole alle Tage fr diesen Monat (neue Struktur: {day: [elements]})\n    let workingDays = [];\n    if (this._workingDays[key]) {\n      if (Array.isArray(this._workingDays[key])) {\n        // Kompatibilitt: Altes Format [days]\n        workingDays = this._workingDays[key].map(d => parseInt(d)).filter(d => !isNaN(d));\n      } else if (typeof this._workingDays[key] === 'object') {\n        // Neue Struktur: {day: [elements]                              }\n        workingDays = Object.keys(this._workingDays[key])\n          .map(d => parseInt(d))\n          .filter(d => !isNaN(d));\n                }\n                }\n\n    const now = new Date();\n    const today = now.getDate();\n    const currentMonth = now.getMonth();\n    const currentYear = now.getFullYear();\n\n    // Prfe ob dieser Monat der Vormonat ist (schreibgeschtzt)\n    let isPreviousMonth = false;\n    if (currentMonth === 0) {\n      // Aktuell ist Januar, Vormonat ist Dezember des Vorjahres\n      isPreviousMonth = month === 11 && year === currentYear - 1;\n    } else {\n      // Vormonat ist aktueller Monat - 1 im gleichen Jahr\n      isPreviousMonth = month === currentMonth - 1 && year === currentYear;\n                }\n\n    const rows = [];\n    let day = 1;\n\n    // Erste Woche\n    const firstDate = new Date(year, month, 1);\n    const weekNumber = this.getWeekNumber(firstDate);\n    const firstRowCells = [html`<td class=\"week-label\">${weekNumber}</td>`];\n\n    for (let i = 0; i < firstDayMonday; i++) {\n      firstRowCells.push(html`<td></td>`);\n                }\n\n    for (let i = firstDayMonday; i < 7 && day <= daysInMonth; i++) {\n      firstRowCells.push(\n        this.renderDay(day, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month)\n      );\n      day++;\n                }\n    rows.push(\n      html`<tr>\n        ${firstRowCells                              }\n      </tr>`\n    );\n\n    // Weitere Wochen\n    while (day <= daysInMonth) {\n      const date = new Date(year, month, day);\n      const weekNum = this.getWeekNumber(date);\n      const rowCells = [html`<td class=\"week-label\">${weekNum}</td>`];\n\n      // Rendere immer 7 Zellen pro Woche (Tage oder leere Zellen)\n      for (let i = 0; i < 7; i++) {\n        if (day <= daysInMonth) {\n          rowCells.push(\n            this.renderDay(day, monthKey, yearKey, key, workingDays, isPreviousMonth, year, month)\n          );\n          day++;\n        } else {\n          // Leere Zelle am Ende der letzten Woche\n          rowCells.push(html`<td></td>`);\n                }\n                }\n      rows.push(\n        html`<tr>\n          ${rowCells                              }\n        </tr>`\n      );\n                }\n\n    return html`\n      <div class=\"month-container\">\n        <div class=\"month-header\">${this.getMonthName(month)} ${year}</div>\n        <table class=\"calendar-table\">\n          <thead>\n            <tr>\n              <th class=\"week-label\">KW</th>\n              <th>Mo</th>\n              <th>Di</th>\n              <th>Mi</th>\n              <th>Do</th>\n              <th>Fr</th>\n              <th>Sa</th>\n              <th>So</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows                              }\n          </tbody>\n        </table>\n      </div>\n    `;\n                }\n\n  changeDisplayedMonths(delta) {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const newValue = Math.max(1, Math.min(maxMonths, (this._displayedMonths || 2) + delta));\n    if (newValue !== this._displayedMonths) {\n      this._displayedMonths = newValue;\n      this.requestUpdate();\n                }\n                }\n\n  changeStartMonth(delta) {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const currentOffset = this._startMonthOffset || 0;\n\n    // Berechne die Grenzen fr die Navigation\n    // Minimum: -1 (Vormonat)\n    // Maximum: maxMonths - displayedMonths (damit der letzte angezeigte Monat nicht ber maxMonths hinausgeht)\n    const minOffset = -1;\n    const maxOffset = maxMonths - displayedMonths;\n\n    const newOffset = Math.max(minOffset, Math.min(maxOffset, currentOffset + delta));\n\n    if (newOffset !== currentOffset) {\n      this._startMonthOffset = newOffset;\n      this.requestUpdate();\n                }\n                }\n\n  getNavigationBounds() {\n    const maxMonths = this._config?.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const currentOffset = this._startMonthOffset || 0;\n\n    const minOffset = -1;\n    const maxOffset = maxMonths - displayedMonths;\n\n    return {\n      canGoBack: currentOffset > minOffset,\n      canGoForward: currentOffset < maxOffset,\n    };\n                }\n\n  _getSelectedCalendarShortcut() {\n    // Gibt den Shortcut des ausgewhlten Kalenders zurck\n\n    // Prfe zuerst _selectedCalendar\n    if (\n      this._selectedCalendar !== null &&\n      this._selectedCalendar !== undefined &&\n      this._selectedCalendar !== ''\n    ) {\n      return this._selectedCalendar;\n                }\n\n    // Falls _selectedCalendar nicht gesetzt ist, prfe die Config\n    if (this._config?.selectedCalendar) {\n      this._selectedCalendar = this._config.selectedCalendar;\n      return this._selectedCalendar;\n                }\n\n    // Fallback: Verwende den ersten aktivierten Kalender\n    const allCalendars = this._getAllCalendars();\n    if (allCalendars.length > 0) {\n      return allCalendars[0].shortcut;\n                }\n    // Wenn kein Kalender aktiviert ist, gibt es keinen Fallback\n    return null;\n                }\n\n  _getCalendarByShortcut(shortcut) {\n    // Gibt das Kalender-Objekt fr einen gegebenen Shortcut zurck\n    if (!this._config?.calendars) {\n      return null;\n                }\n\n    return this._config.calendars.find(cal => cal.shortcut === shortcut) || null;\n                }\n\n  _getDefaultColorForShortcut(shortcut) {\n    // Gibt die Standardfarbe fr einen gegebenen Shortcut zurck\n    const defaultCalendar = ShiftScheduleView.CALENDARS.find(cal => cal.shortcut === shortcut);\n    return defaultCalendar ? defaultCalendar.defaultColor : '#ff9800';\n                }\n\n  _getAllCalendars() {\n    // Gibt nur aktivierte Kalender zurck\n    if (!this._config?.calendars) {\n      return [];\n                }\n\n    // Filtere nur aktivierte Kalender und sortiere nach Shortcut (a, b, c, d, e)\n    return this._config.calendars\n      .filter(\n        cal =>\n          cal &&\n          cal.shortcut &&\n          (cal.enabled === true || cal.enabled === 'true' || cal.enabled === 1)\n      )\n      .sort((a, b) => a.shortcut.localeCompare(b.shortcut));\n                }\n\n  _getSelectedCalendarValue() {\n    const allCalendars = this._getAllCalendars();\n\n    if (allCalendars.length === 0) {\n      // Wenn keine Kalender aktiviert sind, gibt es keinen ausgewhlten Kalender\n      if (this._selectedCalendar !== null) {\n        this._selectedCalendar = null;\n        if (this._config) {\n          this._config.selectedCalendar = null;\n                }\n        this.requestUpdate();\n                }\n      return null;\n                }\n\n    // Wenn _selectedCalendar noch nicht gesetzt ist, setze es auf den ersten aktivierten Kalender\n    if (this._selectedCalendar === null || this._selectedCalendar === undefined) {\n      this._selectedCalendar = allCalendars[0].shortcut;\n      // Speichere es auch in der Config\n      if (this._config) {\n        this._config.selectedCalendar = this._selectedCalendar;\n                }\n      // Aktualisiere die Ansicht\n      this.requestUpdate();\n      return this._selectedCalendar;\n                }\n\n    // Prfe ob der ausgewhlte Kalender aktiviert ist\n    const exists = allCalendars.some(cal => cal.shortcut === this._selectedCalendar);\n    if (!exists) {\n      // Wenn der ausgewhlte Kalender nicht aktiviert ist, verwende den ersten aktivierten\n      this._selectedCalendar = allCalendars[0].shortcut;\n      if (this._config) {\n        this._config.selectedCalendar = this._selectedCalendar;\n                }\n      this.requestUpdate();\n      return this._selectedCalendar;\n                }\n\n    return this._selectedCalendar;\n                }\n\n  _onCalendarSelectedByIndex(shortcut) {\n    if (shortcut !== '' && shortcut !== null && shortcut !== undefined) {\n      this._selectedCalendar = shortcut;\n\n      // Aktualisiere die Config mit der neuen Auswahl\n      if (this._config) {\n        this._config = {\n          ...this._config,\n          selectedCalendar: shortcut,\n        };\n\n        // Dispatch config-changed Event, damit die Card die Config aktualisiert\n        // (nur wenn nicht initialer Load)\n        if (!this._isInitialLoad) {\n          this.dispatchEvent(\n            new CustomEvent('config-changed', {\n              detail: { config: this._config },\n              bubbles: true,\n              composed: true,\n            })\n          );\n          // Speichere die Config in die Entity (nur bei Benutzeraktionen)\n          this.saveConfigToEntity();\n                }\n                }\n\n      // Aktualisiere alle Buttons, die die neue aktive Schicht haben\n      // Dies ist notwendig, um die Hintergrundfarben und Indikatoren korrekt zu aktualisieren\n      // (z.B. wenn Tag 2 die Schicht \"a\" hat und wir zu \"a\" wechseln, sollte Tag 2 orange werden)\n      // ABER: Nur wenn es sich nicht um den initialen Load handelt UND die Daten bereits geladen sind\n      // Beim initialen Load werden die Buttons bereits korrekt durch Lit gerendert\n      if (\n        !this._isInitialLoad &&\n        this.shadowRoot &&\n        this._workingDays &&\n        Object.keys(this._workingDays).length > 0\n      ) {\n        // Verwende setTimeout, um sicherzustellen, dass _selectedCalendar bereits aktualisiert wurde\n        setTimeout(() => {\n          this._updateAllDayButtonsForCalendarChange();\n        }, 0);\n                }\n                }\n                }\n\n  // Aktualisiert alle Tag-Buttons nach Kalender-Auswahl (nur Farben/Klassen, kein komplettes Re-Rendering)\n  _updateAllDayButtonsForCalendarChange() {\n    if (!this.shadowRoot) return;\n\n    const buttons = this.shadowRoot.querySelectorAll('button.day-button');\n    const selectedShortcut = this._getSelectedCalendarShortcut();\n    const selectedCalendar = this._getCalendarByShortcut(selectedShortcut);\n\n    buttons.forEach(button => {\n      const monthKey = button.getAttribute('data-month');\n      const dayNum = parseInt(button.getAttribute('data-day'));\n      const yearKey = button.getAttribute('data-year');\n\n      if (!monthKey || !dayNum || !yearKey) return;\n\n      // Formatiere den Key mit formatTwoDigits, damit er mit den gespeicherten Daten bereinstimmt\n      const key = `${this.formatTwoDigits(parseInt(yearKey))}:${this.formatTwoDigits(parseInt(monthKey))}`;\n      const dayElements = this._getDayElements(key, dayNum);\n      const hasSelectedShift = selectedShortcut && dayElements.includes(selectedShortcut);\n\n      // Finde die erste aktivierte Schicht\n      let firstActiveShift = null;\n      const shiftOrder = ['a', 'b', 'c', 'd', 'e'];\n      for (const shortcut of shiftOrder) {\n        if (dayElements.includes(shortcut)) {\n          const calendar = this._getCalendarByShortcut(shortcut);\n          if (calendar && calendar.enabled) {\n            firstActiveShift = shortcut;\n            break;\n                }\n                }\n                }\n\n      // Bestimme welche Schicht den Tag frben soll\n      let activeShiftForColor = null;\n      if (hasSelectedShift && selectedCalendar && selectedCalendar.enabled) {\n        activeShiftForColor = selectedShortcut;\n      } else if (firstActiveShift) {\n        activeShiftForColor = firstActiveShift;\n                }\n\n      const isWorking = activeShiftForColor !== null;\n\n      // Aktualisiere CSS-Klasse\n      if (isWorking) {\n        button.classList.add('working');\n      } else {\n        button.classList.remove('working');\n                }\n\n      // Aktualisiere Hintergrundfarbe\n      if (activeShiftForColor) {\n        const activeCalendar = this._getCalendarByShortcut(activeShiftForColor);\n        if (activeCalendar && activeCalendar.color) {\n          button.style.backgroundColor = activeCalendar.color;\n        } else {\n          button.style.backgroundColor = '';\n                }\n      } else {\n        button.style.backgroundColor = '';\n                }\n\n      // Aktualisiere Shift-Indikatoren (hnlich wie in _updateDayButtonDirectly)\n      // Entferne zuerst alle vorhandenen Container und Indikatoren\n      const existingContainer = button.querySelector('.shifts-container');\n      if (existingContainer) {\n        existingContainer.remove();\n                }\n\n      const shiftIndicators = dayElements\n        .filter(shortcut => shortcut !== activeShiftForColor)\n        .map(shortcut => {\n          const calendar = this._getCalendarByShortcut(shortcut);\n          if (calendar && calendar.enabled && calendar.color) {\n            const indicator = document.createElement('span');\n            indicator.className = 'shift-indicator';\n            indicator.style.backgroundColor = calendar.color;\n            indicator.title = calendar.name || `Schicht ${shortcut.toUpperCase()}`;\n            return indicator;\n                }\nreturn null;\n        })\n        .filter(indicator => indicator !== null);\n\n      // Fge Indikatoren nur hinzu, wenn welche vorhanden sind\n      if (shiftIndicators.length > 0) {\n        const container = document.createElement('div');\n        container.className = 'shifts-container';\n        // Markiere Container als manuell erstellt, damit das Template sie nicht berschreibt\n        container.setAttribute('data-manual-update', 'true');\n        shiftIndicators.forEach(ind => container.appendChild(ind));\n        button.appendChild(container);\n                }\n      // Wenn keine Indikatoren vorhanden sind, wurde der Container bereits oben entfernt\n    });\n                }\n\n  // Aktualisiert die Storage-Warnung direkt im DOM ohne Re-Rendering\n  _updateStorageWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasStorageWarning = this._storageWarning && this._storageWarning.show;\n\n    // Aktualisiere CSS-Klasse\n    if (hasStorageWarning) {\n      wrapper.classList.add('storage-warning-active');\n    } else {\n      wrapper.classList.remove('storage-warning-active');\n                }\n\n    // Finde oder erstelle Storage-Warnung\n    let storageWarningEl = wrapper.querySelector('.storage-warning[data-warning-type=\"storage\"]');\n\n    if (hasStorageWarning) {\n      if (!storageWarningEl) {\n        // Erstelle neue Warnung\n        storageWarningEl = document.createElement('div');\n        storageWarningEl.className = 'storage-warning';\n        storageWarningEl.setAttribute('data-warning-type', 'storage');\n        wrapper.insertBefore(storageWarningEl, wrapper.firstChild);\n                }\n\n      // Aktualisiere Inhalt\n      const additionalEntities = this.findAdditionalEntities(this._config.entity);\n      const nextEntitySuffix = String(additionalEntities.length + 1).padStart(3, '0');\n      storageWarningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Speicherplatz fast voll!</div>\n          <div class=\"warning-message\">\n            ${this._storageWarning.percentage}% der verfgbaren Speicherkapazitt verwendet\n            (${this._storageWarning.currentLength} / ${this._storageWarning.maxLength} Zeichen).\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie ein zustzliches Input-Text-Feld an (z.B. ${this._config.entity}_${nextEntitySuffix}).\n          </div>\n        </div>\n      `;\n    } else if (storageWarningEl) {\n      // Entferne Warnung wenn nicht mehr ntig\n      storageWarningEl.remove();\n                }\n                }\n\n  // Aktualisiert die Config-Warnung direkt im DOM ohne Re-Rendering\n  _updateConfigWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasConfigWarning =\n      this._configWarning &&\n      this._configWarning.show &&\n      (this._configWarning.type === 'size' ||\n        (this._configWarning.type === 'missing' && isEditorMode));\n\n    // Finde alle Config-Warnungen (size und missing)\n    const configWarningSize = wrapper.querySelector(\n      '.storage-warning[data-warning-type=\"config-size\"]'\n    );\n    const configWarningMissing = wrapper.querySelector(\n      '.storage-warning[data-warning-type=\"config-missing\"]'\n    );\n\n    if (hasConfigWarning && this._configWarning.type === 'size') {\n      // Size-Warnung anzeigen/aktualisieren\n      let warningEl = configWarningSize;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'config-size');\n        // Fge nach Storage-Warnung ein, falls vorhanden\n        const storageWarning = wrapper.querySelector(\n          '.storage-warning[data-warning-type=\"storage\"]'\n        );\n        if (storageWarning) {\n          storageWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Konfigurations-Entity zu klein!</div>\n          <div class=\"warning-message\">\n            Die Konfiguration passt nicht in die Entity <code>${this._configWarning.configEntityId}</code>.\n            ${this._configWarning.percentage}% der verfgbaren Speicherkapazitt bentigt\n            (${this._configWarning.currentLength} / ${this._configWarning.maxLength} Zeichen).\n          </div>\n          <div class=\"warning-action\">\n            Bitte erhhen Sie die maximale Lnge der Entity ber die UI:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Entity <code>${this._configWarning.configEntityId.replace('input_text.', '')}</code> bearbeiten</li>\n              <li>Maximale Lnge auf mindestens <code>${Math.ceil(this._configWarning.currentLength * 1.2)}</code> Zeichen erhhen</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (configWarningSize) {\n      configWarningSize.remove();\n                }\n\n    if (hasConfigWarning && this._configWarning.type === 'missing' && isEditorMode) {\n      // Missing-Warnung anzeigen/aktualisieren\n      let warningEl = configWarningMissing;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'config-missing');\n        // Fge nach anderen Warnungen ein\n        const lastWarning = wrapper.querySelector('.storage-warning:last-of-type');\n        if (lastWarning) {\n          lastWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      // Erstelle HTML-String fr missing entity warning\n      const entityNameShort = this._configWarning.configEntityId.replace('input_text.', '');\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Konfigurations-Entity fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${this._configWarning.configEntityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hilfsmittel hinzufgen  Text</li>\n              <li>Entity-ID: <code>${this._configWarning.configEntityId}</code></li>\n              <li>Maximale Lnge: <code>255</code> Zeichen (oder mehr)</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (configWarningMissing) {\n      configWarningMissing.remove();\n                }\n                }\n\n  // Aktualisiert die Status-Warnung direkt im DOM ohne Re-Rendering\n  _updateStatusWarningDirectly() {\n    if (!this.shadowRoot) {\n      // Shadow DOM noch nicht bereit, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const wrapper = this.shadowRoot.querySelector('.calendar-wrapper');\n    if (!wrapper) {\n      // Wrapper nicht gefunden, Fallback zu requestUpdate\n      this.requestUpdate();\n      return;\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    const hasStatusWarning = this._statusWarning && this._statusWarning.show && isEditorMode;\n\n    const statusWarningEl = wrapper.querySelector('.storage-warning[data-warning-type=\"status\"]');\n\n    if (hasStatusWarning) {\n      let warningEl = statusWarningEl;\n      if (!warningEl) {\n        warningEl = document.createElement('div');\n        warningEl.className = 'storage-warning';\n        warningEl.setAttribute('data-warning-type', 'status');\n        // Fge nach anderen Warnungen ein\n        const lastWarning = wrapper.querySelector('.storage-warning:last-of-type');\n        if (lastWarning) {\n          lastWarning.insertAdjacentElement('afterend', warningEl);\n        } else {\n          wrapper.insertBefore(warningEl, wrapper.firstChild);\n                }\n                }\n      warningEl.innerHTML = `\n        <div class=\"warning-icon\"></div>\n        <div class=\"warning-content\">\n          <div class=\"warning-title\">Status-Entity fehlt!</div>\n          <div class=\"warning-message\">\n            Die Entity <code>${this._statusWarning.statusEntityId}</code> wurde nicht gefunden.\n          </div>\n          <div class=\"warning-action\">\n            Bitte legen Sie diese Entity ber die UI an:\n            <ul>\n              <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n              <li>Hilfsmittel hinzufgen  Text</li>\n              <li>Entity-ID: <code>${this._statusWarning.statusEntityId}</code></li>\n              <li>Maximale Lnge: <code>255</code> Zeichen (oder mehr)</li>\n            </ul>\n          </div>\n        </div>\n      `;\n    } else if (statusWarningEl) {\n      statusWarningEl.remove();\n                }\n                }\n\n  _getDayElements(monthKey, day) {\n    // Gibt die Elemente fr einen bestimmten Tag zurck\n    // Reduziere Debug-Ausgaben: Nur bei ersten 3 Tagen oder wenn keine Daten gefunden werden\n    const shouldDebug = day <= 3 || !this._workingDays[monthKey];\n    \n    if (shouldDebug) {\n      this._debug(`[Render] _getDayElements: Suche nach monthKey=\"${monthKey}\", day=${day}`);\n                }\n\n    if (!this._workingDays[monthKey] || typeof this._workingDays[monthKey] !== 'object') {\n      if (shouldDebug) {\n        this._debug(`[Render] _getDayElements: Keine Daten fr monthKey=\"${monthKey}\" gefunden oder kein Objekt`);\n        this._debug(`[Render] _getDayElements: Verfgbare Keys in _workingDays:`, Object.keys(this._workingDays));\n                }\n      return [];\n                }\n\n    if (Array.isArray(this._workingDays[monthKey])) {\n      // Altes Format: Array von Tagen\n      if (shouldDebug) {\n        this._debug(`[Render] _getDayElements: Altes Format (Array) fr monthKey=\"${monthKey}\"`);\n                }\n      return [];\n                }\n\n    const elements = this._workingDays[monthKey][day] || [];\n    if (shouldDebug && elements.length > 0) {\n      this._debug(`[Render] _getDayElements: Gefundene Elemente fr \"${monthKey}\", Tag ${day}:`, elements);\n                }\n\n    return elements;\n                }\n\n  // berschreibe requestUpdate() um Updates zu verhindern, wenn Panel geffnet ist\n  requestUpdate(name, oldValue, options) {\n    // Verhindere alle Updates wenn das Konfigurationspanel geffnet ist\n    // (auer wenn _showConfigPanel selbst gendert wird)\n    if (this._showConfigPanel && name !== '_showConfigPanel') {\n      return;\n                }\n    return super.requestUpdate(name, oldValue, options);\n                }\n\n  // Optimierung: Verhindere unntige Re-Renderings\n  shouldUpdate(changedProperties) {\n    // WICHTIG: Verhindere alle Updates wenn das Konfigurationspanel geffnet ist\n    // (auer wenn sich _showConfigPanel selbst ndert)\n    if (this._showConfigPanel && !changedProperties.has('_showConfigPanel')) {\n      const changedProps = Array.from(changedProperties.keys()).join(', ');\n      this._debug(`[Update-Block] shouldUpdate() blockiert (Panel ist geffnet). Genderte Properties: ${changedProps}`);\n      return false;\n                }\n\n    // Prfe ob sich relevante Properties gendert haben\n    const relevantProps = [\n      'hass',\n      'config',\n      '_workingDays',\n      '_displayedMonths',\n      '_startMonthOffset',\n      '_selectedCalendar',\n      '_storageWarning',\n      '_configWarning',\n      '_statusWarning',\n      '_showConfigPanel',\n    ];\n\n    // Wenn nur _workingDays gendert wurde und direkte DOM-Updates im Gange sind,\n    // berspringe das Update, um Verdopplungen zu vermeiden\n    if (\n      changedProperties.has('_workingDays') &&\n      changedProperties.size === 1 &&\n      this._directDOMUpdateInProgress.size > 0\n    ) {\n      // berspringe Update, da direkte DOM-Manipulation verwendet wird\n      return false;\n                }\n\n    return relevantProps.some(prop => changedProperties.has(prop));\n                }\n\n  render() {\n    if (!this._config) {\n      return html`<div class=\"error\">Keine Konfiguration vorhanden</div>`;\n                }\n\n    const maxMonths = this._config.numberOfMonths || 14;\n    const displayedMonths = this._displayedMonths || 2;\n    const startMonthOffset = this._startMonthOffset || 0;\n    const now = new Date();\n    const months = [];\n\n    for (let i = 0; i < displayedMonths; i++) {\n      const date = new Date(now.getFullYear(), now.getMonth() + startMonthOffset + i, 1);\n      const year = date.getFullYear();\n      const month = date.getMonth();\n      months.push({ year, month });\n                }\n\n    const isEditorMode = this._isInEditorMode();\n    // Speicherwarnung wird immer angezeigt (auch im normalen Modus)\n    const hasStorageWarning = this._storageWarning && this._storageWarning.show;\n    // Config-Warnung: \"missing\" nur im Editor, \"size\" immer (auch im normalen Modus)\n    const hasConfigWarning =\n      this._configWarning &&\n      this._configWarning.show &&\n      (this._configWarning.type === 'size' || // Speicherplatz-Warnung immer anzeigen\n        (this._configWarning.type === 'missing' && isEditorMode)); // Fehlende Entity nur im Editor\n    // Status-Warnung wird nur im Editor-Modus angezeigt\n    const hasStatusWarning = this._statusWarning && this._statusWarning.show && isEditorMode;\n    const navBounds = this.getNavigationBounds();\n\n    return html`\n      <div class=\"calendar-wrapper ${hasStorageWarning ? 'storage-warning-active' : ''}\">\n        <div class=\"schichtplan-wrapper\">\n        ${hasStorageWarning\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"storage\">\n                <div class=\"warning-icon\"></div>\n                <div class=\"warning-content\">\n                  <div class=\"warning-title\">Speicherplatz fast voll!</div>\n                  <div class=\"warning-message\">\n                    ${this._storageWarning.percentage}% der verfgbaren Speicherkapazitt verwendet\n                    (${this._storageWarning.currentLength} / ${this._storageWarning.maxLength                              }\n                    Zeichen).\n                  </div>\n                  <div class=\"warning-action\">\n                    Bitte legen Sie ein zustzliches Input-Text-Feld an (z.B.\n                    ${this._config.entity}_${String(\n                      this.findAdditionalEntities(this._config.entity).length + 1\n                    ).padStart(3, '0')}).\n                  </div>\n                </div>\n              </div>\n            `\n          : ''                              }\n        ${hasConfigWarning && this._configWarning.type === 'size'\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"config-size\">\n                <div class=\"warning-icon\"></div>\n                <div class=\"warning-content\">\n                  <div class=\"warning-title\">Konfigurations-Entity zu klein!</div>\n                  <div class=\"warning-message\">\n                    Die Konfiguration passt nicht in die Entity\n                    <code>${this._configWarning.configEntityId}</code>.\n                    ${this._configWarning.percentage}% der verfgbaren Speicherkapazitt bentigt\n                    (${this._configWarning.currentLength} / ${this._configWarning.maxLength                              }\n                    Zeichen).\n                  </div>\n                  <div class=\"warning-action\">\n                    Bitte erhhen Sie die maximale Lnge der Entity ber die UI:\n                    <ul>\n                      <li>Einstellungen  Automatisierungen &amp; Szenen  Hilfsmittel</li>\n                      <li>\n                        Entity\n                        <code\n                          >${this._configWarning.configEntityId.replace('input_text.', '')}</code\n                        >\n                        bearbeiten\n                      </li>\n                      <li>\n                        Maximale Lnge auf mindestens\n                        <code>${Math.ceil(this._configWarning.currentLength * 1.2)}</code> Zeichen\n                        erhhen\n                      </li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n            `\n          : ''                              }\n        ${hasConfigWarning && this._configWarning.type === 'missing'\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"config-missing\">\n                ${this._renderMissingEntityWarning(\n                  this._configWarning.configEntityId,\n                  'Konfigurations-Entity',\n                  255,\n                  true\n                )                              }\n              </div>\n            `\n          : ''                              }\n        ${hasStatusWarning\n          ? html`\n              <div class=\"storage-warning\" data-warning-type=\"status\">\n                ${this._renderMissingEntityWarning(\n                  this._statusWarning.statusEntityId,\n                  'Status-Entity',\n                  255,\n                  false\n                )                              }\n              </div>\n            `\n          : ''                              }\n        ${!this._showConfigPanel\n          ? html`\n              <div class=\"schichtplan-wrapper\">\n                <div class=\"schichtplan-menu-bar\">\n                  ${renderMenuBar({\n                    left: '',\n                    center: html`\n                      <div class=\"menu-controls\">\n                        <button\n                          class=\"menu-button navigation-button\"\n                          @click=${() => this.changeStartMonth(-1)                              }\n                          ?disabled=${!navBounds.canGoBack                              }\n                          title=\"Vorheriger Monat\"\n                        >\n                          \n                        </button>\n                        <button\n                          class=\"menu-button decrease-button\"\n                          @click=${() => this.changeDisplayedMonths(-1)                              }\n                          ?disabled=${displayedMonths <= 1                              }\n                          title=\"Weniger Monate anzeigen\"\n                        >\n                          \n                        </button>\n                        <div class=\"menu-number\">${displayedMonths}</div>\n                        <button\n                          class=\"menu-button increase-button\"\n                          @click=${() => this.changeDisplayedMonths(1)                              }\n                          ?disabled=${displayedMonths >= maxMonths                              }\n                          title=\"Mehr Monate anzeigen\"\n                        >\n                          +\n                        </button>\n                        <button\n                          class=\"menu-button navigation-button\"\n                          @click=${() => this.changeStartMonth(1)                              }\n                          ?disabled=${!navBounds.canGoForward                              }\n                          title=\"Nchster Monat\"\n                        >\n                          \n                        </button>\n                      </div>\n                    `,\n                    right: html`\n                      <button\n                        class=\"menu-button config-button\"\n                        @click=${e => {\n                          e.stopPropagation();\n                          e.preventDefault();\n                          // Speichere die aktuellen calendars beim ffnen des Panels\n                          this._configPanelCalendars = JSON.parse(JSON.stringify(this._config?.calendars || []));\n                          this._showConfigPanel = true;\n                          this.requestUpdate();\n                        }                              }\n                        title=\"Schichtkonfiguration\"\n                      >\n                        \n                      </button>\n                    `,\n                    fullWidth: (() => {\n                      const allCalendars = this._getAllCalendars();\n                      const selectedShortcut = this._getSelectedCalendarShortcut();\n                      return html`\n                        <div class=\"color-bar\">\n                          ${allCalendars.map(calendar => {\n                            const isSelected = calendar.shortcut === selectedShortcut;\n                            const textColor = this._getContrastColor(calendar.color || '#ff9800');\n                            return html`\n                              <button\n                                class=\"color-button ${isSelected ? 'selected' : ''}\"\n                                style=\"background-color: ${calendar.color || '#ff9800'}; color: ${textColor};\"\n                                @click=${() => this._onCalendarSelectedByIndex(calendar.shortcut)                              }\n                                title=\"${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`}\"\n                              >${calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`}</button>\n                            `;\n                          })                              }\n                        </div>\n                      `;\n                    })(),\n                  })                              }\n                </div>\n                <div class=\"schichtplan-panel\">\n                  ${months.map(({ year, month }) => this.renderMonth(year, month))                              }\n                </div>\n              </div>\n            `\n          : html``                              }\n        ${this._showConfigPanel\n          ? html`\n              <div class=\"config-wrapper\">\n                <shift-config-panel\n                  .calendars=${this._configPanelCalendars || []                              }\n                  .selectedShortcut=${this._getSelectedCalendarShortcut()                              }\n                  .hass=${this._hass                              }\n                  @close=${() => {\n                    this._showConfigPanel = false;\n                    this._configPanelCalendars = null;\n                    this.requestUpdate();\n                  }                              }\n                  @save=${e => this._handleConfigPanelSave(e.detail.calendars)                              }\n                ></shift-config-panel>\n              </div>\n            `\n          : html``                              }\n      </div>\n    `;\n                }\n\n  _handleConfigPanelSave(calendars) {\n    // Aktualisiere die Config mit den neuen Kalendern\n    if (this._config) {\n      this._config.calendars = calendars;\n      \n      // Speichere nur ber Saver (nicht ber Editor)\n      this.saveConfigToEntity();\n      \n      // Schliee das Panel\n      this._showConfigPanel = false;\n      \n      // Aktualisiere die Ansicht\n      this.requestUpdate();\n                }\n                }\n\n  static styles = [\n    super.styles || [],\n    sharedMenuStyles,\n    css`\n      :host {\n        display: block;\n        --tgshiftschedule-default-selected-day-color: ${unsafeCSS(\n          ShiftScheduleView.DEFAULT_SELECTED_DAY_COLOR\n        )};\n                }\n\n      .calendar-wrapper {\n        display: block;\n        transition: border-color 0.3s ease;\n                }\n\n      .calendar-wrapper.storage-warning-active {\n        border: 3px solid var(--error-color, #f44336);\n        border-radius: 4px;\n        padding: 8px;\n        box-shadow: 0 0 10px rgba(244, 67, 54, 0.3);\n                }\n\n      .schichtplan-wrapper {\n        display: flex;\n        flex-direction: column;\n        gap: 0;\n        margin-bottom: 16px;\n                }\n\n      .schichtplan-menu-bar,\n      .config-menu-bar {\n        position: relative;\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        padding: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border-radius: 4px 4px 0 0;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-bottom: none;\n                }\n\n      /* Gemeinsame Menu-Styles und Farbleisten-Styles werden aus shared-menu-styles.js importiert */\n\n      .menu-number {\n        font-size: 18px;\n        font-weight: bold;\n        min-width: 40px;\n        text-align: center;\n        color: var(--primary-text-color, #212121);\n                }\n\n      .element-selector {\n        margin-left: 20px;\n        min-width: 200px;\n                }\n\n      .config-button {\n        font-size: 20px;\n        background: none !important;\n        border: none !important;\n        color: var(--primary-text-color, #212121) !important;\n        width: auto !important;\n        height: auto !important;\n        padding: 4px !important;\n                }\n\n      .config-button:hover {\n        background: none !important;\n        color: var(--primary-color, #03a9f4) !important;\n        transform: scale(1.1);\n                }\n\n      .schichtplan-panel {\n        display: flex;\n        flex-direction: column;\n        gap: 24px;\n        padding: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border-radius: 0 0 4px 4px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-top: none;\n                }\n\n      .config-wrapper {\n        margin-bottom: 16px;\n                }\n\n      .month-container {\n        display: flex;\n        flex-direction: column;\n                }\n\n      .month-header {\n        font-size: 18px;\n        font-weight: bold;\n        margin-bottom: 12px;\n        text-align: center;\n                }\n\n      .calendar-table {\n        width: 100%;\n        border-collapse: collapse;\n        table-layout: fixed;\n                }\n\n      .calendar-table th {\n        padding: 8px 4px;\n        text-align: center;\n        font-weight: bold;\n        font-size: 12px;\n        border-bottom: 2px solid var(--divider-color, #e0e0e0);\n                }\n\n      .calendar-table td {\n        padding: 4px;\n        text-align: center;\n        vertical-align: middle;\n                }\n\n      .day-button {\n        width: 100%;\n        min-width: 32px;\n        min-height: 32px;\n        padding: 2px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-radius: 4px;\n        background-color: var(--card-background-color, #ffffff);\n        color: var(--primary-text-color, #000000);\n        cursor: pointer;\n        transition: all 0.2s;\n        font-size: 12px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        gap: 2px;\n                }\n\n      .day-number {\n        font-size: 12px;\n        font-weight: bold;\n        line-height: 1;\n                }\n\n      .shifts-container {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        justify-content: center;\n        align-items: center;\n        max-width: 100%;\n                }\n\n      .shift-indicator {\n        display: inline-block;\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        border: 1px solid rgba(0, 0, 0, 0.2);\n        flex-shrink: 0;\n                }\n\n      .day-button:hover:not(.working) {\n        background-color: var(--primary-color, #03a9f4);\n        color: var(--text-primary-color, #ffffff);\n                }\n\n      .day-button.working:hover {\n        /* Behalte die Hintergrundfarbe bei, aber mache sie etwas dunkler */\n        opacity: 0.9;\n        filter: brightness(0.9);\n                }\n\n      /* Verhindere visuelle Markierung nach Klick auf mobilen Gerten */\n      .day-button:active,\n      .day-button:focus {\n        outline: none !important;\n        box-shadow: none !important;\n                }\n\n      /* Touch-spezifische Behandlung: Verhindere aktiven State nach Touch */\n      .day-button {\n        -webkit-tap-highlight-color: transparent;\n        -webkit-touch-callout: none;\n        touch-action: manipulation;\n                }\n\n      .day-button.working {\n        /* background-color wird jetzt dynamisch per style gesetzt, wenn eine Schicht ausgewhlt ist */\n        color: var(--text-primary-color, #ffffff);\n        font-weight: bold;\n                }\n\n      /* Fallback: Wenn keine Schicht ausgewhlt ist, verwende die Standardfarbe */\n      .day-button.working:not([style*='background-color']) {\n        background-color: var(--accent-color, var(--tgshiftschedule-default-selected-day-color));\n                }\n\n      /* Basis: Heute-Markierung mit Outline (wird auerhalb des Borders gerendert) */\n      .day-button.today {\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      .day-button.weekend {\n        border: 4px solid var(--secondary-color, #757575);\n                }\n\n      /* Feiertage haben Vorrang vor Wochenenden */\n      .day-button.holiday {\n        border: 4px solid var(--error-color, #f44336);\n                }\n\n      /* Wenn sowohl Wochenende als auch Feiertag, verwende Feiertagsfarbe (strkere Umrandung) */\n      .day-button.weekend.holiday {\n        border: 5px solid var(--error-color, #f44336);\n                }\n\n      /* Heute + Wochenende: Border fr Wochenende, Outline fr heute */\n      .day-button.today.weekend {\n        border: 4px solid var(--secondary-color, #757575);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      /* Heute + Feiertag: Border fr Feiertag, Outline fr heute */\n      .day-button.today.holiday {\n        border: 4px solid var(--error-color, #f44336);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      /* Heute + Wochenende + Feiertag: Border fr Feiertag (strker), Outline fr heute */\n      .day-button.today.weekend.holiday {\n        border: 5px solid var(--error-color, #f44336);\n        outline: 3px solid var(--primary-color, #03a9f4);\n        outline-offset: 2px;\n                }\n\n      .day-button.readonly,\n      .day-button:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n        background-color: var(--disabled-color, #f5f5f5);\n        color: var(--secondary-text-color, #888888);\n                }\n\n      .day-button.readonly:hover,\n      .day-button:disabled:hover {\n        background-color: var(--disabled-color, #f5f5f5);\n        color: var(--secondary-text-color, #888888);\n                }\n\n      .day-number {\n        font-size: 12px;\n        font-weight: bold;\n        line-height: 1;\n                }\n\n      .shifts-container {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        justify-content: center;\n        align-items: center;\n        max-width: 100%;\n                }\n\n      .shift-indicator {\n        display: inline-block;\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        border: 1px solid rgba(0, 0, 0, 0.2);\n        flex-shrink: 0;\n                }\n\n      .day-button.working .day-number {\n        color: var(--text-primary-color, #ffffff);\n                }\n\n      .week-label {\n        font-size: 11px;\n        color: var(--secondary-text-color, #888888);\n        padding-right: 8px;\n        text-align: right;\n        width: 40px;\n                }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n                }\n\n      .storage-warning {\n        display: flex;\n        align-items: flex-start;\n        gap: 12px;\n        padding: 16px;\n        margin-bottom: 16px;\n        background-color: var(--warning-color, var(--tgshiftschedule-default-selected-day-color));\n        color: var(--text-primary-color, #ffffff);\n        border-radius: 4px;\n        border-left: 4px solid var(--error-color, #f44336);\n                }\n\n      .warning-icon {\n        font-size: 24px;\n        flex-shrink: 0;\n                }\n\n      .warning-content {\n        flex: 1;\n                }\n\n      .warning-title {\n        font-weight: bold;\n        font-size: 16px;\n        margin-bottom: 8px;\n                }\n\n      .warning-message {\n        font-size: 14px;\n        margin-bottom: 8px;\n        line-height: 1.5;\n                }\n\n      .warning-action {\n        font-size: 14px;\n        font-weight: 500;\n        margin-top: 8px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.3);\n                }\n\n      .warning-action ul {\n        margin: 8px 0 0 0;\n        padding-left: 20px;\n        list-style-type: disc;\n                }\n\n      .warning-action li {\n        margin: 4px 0;\n        line-height: 1.5;\n                }\n\n      .warning-action code {\n        background-color: rgba(0, 0, 0, 0.2);\n        padding: 2px 6px;\n        border-radius: 3px;\n        font-family: 'Courier New', monospace;\n        font-size: 13px;\n                }\n    `,\n  ];\n                }\n\n// Registriere ShiftScheduleView als Custom Element\nif (!customElements.get('shiftschedule-view')) {\n  customElements.define('shiftschedule-view', ShiftScheduleView);\n                }\n","import { html, css } from 'lit';\nimport { CardBase } from './card-base.js';\nimport './views/shiftschedule-view/shiftschedule-view.js'; // Import fr Custom Element Registrierung\nimport { CardName, CardRegname } from './card-config.js';\n\nexport class CardImpl extends CardBase {\n  static className = 'CardImpl';\n  static get properties() {\n    return {\n      ...super.properties,\n      config: { type: Object },\n      hass: { type: Object },\n      lovelace: { type: Object },\n      _view: { type: Object },\n      _viewType: { type: String },\n    };\n  }\n\n  static getConfigElement() {\n    return document.createElement(`${CardRegname}-editor`);\n  }\n\n  static getStubConfig() {\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n    };\n  }\n\n  constructor() {\n    super();\n    this._debug(`CardImpl-Modul wird geladen`);\n    this.config = this.getDefaultConfig();\n    this._debug('CardImpl-Konstruktor: Initialisierung abgeschlossen');\n  }\n\n  getDefaultConfig() {\n    this._debug(`CardImpl getDefaultConfig wird aufgerufen`);\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      selectedCalendar: 'a', // Erster aktivierter Kalender\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      calendars: [\n        {\n          shortcut: 'a',\n          name: 'Kalender A',\n          color: '#ff9800',\n          enabled: true,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'b',\n          name: 'Kalender B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Kalender C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Kalender D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Kalender E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ],\n    };\n  }\n\n  setConfig(config) {\n    this._debug('setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration vorhanden');\n    }\n\n    // Merge Config: Behalte selectedCalendar aus der bergebenen Config, falls vorhanden\n    const defaultConfig = this.getDefaultConfig();\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      // Stelle sicher, dass selectedCalendar aus der bergebenen Config beibehalten wird\n      selectedCalendar:\n        config?.selectedCalendar !== undefined\n          ? config.selectedCalendar\n          : this.config?.selectedCalendar || defaultConfig.selectedCalendar,\n    };\n\n    this._debug('config nach setConfig:', this.config);\n\n    // View initialisieren oder aktualisieren\n    this._viewType = 'ShiftScheduleView';\n\n    try {\n      if (!this._view) {\n        // Erstelle ShiftScheduleView als Custom Element nur wenn noch nicht vorhanden\n        this._debug('setConfig: Erstelle neue ShiftSchedule-View');\n        this._view = document.createElement('shiftschedule-view');\n\n        // Event-Listener fr Config-nderungen von der View\n        this._view.addEventListener('config-changed', ev => {\n          this._debug('config-changed Event von ShiftSchedule-View empfangen:', ev.detail);\n          if (ev.detail && ev.detail.config) {\n            this.config = ev.detail.config;\n            // Speichere die Config (nur wenn durch Benutzeraktion gendert)\n            if (this._view._handleConfigChanged) {\n              this._view._handleConfigChanged();\n            }\n            // Dispatch das Event weiter, damit Home Assistant die Config aktualisiert\n            this.dispatchEvent(\n              new CustomEvent('config-changed', {\n                detail: { config: this.config },\n                bubbles: true,\n                composed: true,\n              })\n            );\n          }\n        });\n\n        // bergebe hass und lovelace an die View, falls sie bereits gesetzt wurden\n        if (this._hass) {\n          this._debug('setConfig: bergebe gespeicherten hass an ShiftSchedule-View');\n          this._view.hass = this._hass;\n        }\n        if (this.lovelace) {\n          this._debug('setConfig: bergebe lovelace an ShiftSchedule-View');\n          this._view.lovelace = this.lovelace;\n        }\n      } else {\n        // View existiert bereits, aktualisiere nur die Config\n        this._debug('setConfig: Aktualisiere bestehende ShiftSchedule-View');\n      }\n\n      // Aktualisiere die Config der View (wichtig: auch wenn View bereits existiert)\n      this._view.config = this.config;\n\n      this._debug('setConfig: View initialisiert/aktualisiert:', {\n        viewType: this._viewType,\n        config: this.config,\n      });\n    } catch (error) {\n      this._debug('setConfig: Fehler bei View-Initialisierung:', error);\n      throw new Error(`Fehler bei der View-Initialisierung: ${error.message}`);\n    }\n  }\n\n  set hass(hass) {\n    // this._debug('set hass wird aufgerufen');\n    this._hass = hass;\n    if (this._view) {\n      this._view.hass = hass;\n    } else {\n      this._debug('set hass: View noch nicht initialisiert, speichere hass fr spter');\n    }\n  }\n\n  set lovelace(lovelace) {\n    this._lovelace = lovelace;\n    if (this._view) {\n      this._view.lovelace = lovelace;\n    }\n  }\n\n  get lovelace() {\n    return this._lovelace;\n  }\n\n  get hass() {\n    return this._hass;\n  }\n\n  firstUpdated() {\n    this._debug('firstUpdated wird aufgerufen');\n    if (this._view) {\n      this._view.firstUpdated();\n    }\n    this._debug('firstUpdated abgeschlossen');\n  }\n\n  render() {\n    if (!this._view) {\n      return html`<div class=\"error\">Keine View verfgbar</div>`;\n    }\n\n    try {\n      return html`${this._view}`;\n    } catch (error) {\n      this._debug('render: Fehler beim Rendern der View:', error);\n      return html`<div class=\"error\">Fehler beim Rendern: ${error.message}</div>`;\n    }\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      ha-card {\n        padding: 16px;\n      }\n\n      .loading {\n        text-align: center;\n        padding: 20px;\n        color: var(--secondary-text-color);\n      }\n\n      .error {\n        text-align: center;\n        padding: 20px;\n        color: var(--error-color);\n      }\n    `,\n  ];\n}\n","import { css } from 'lit';\nimport { SuperBase } from '../super-base.js';\n\nexport class EditorBase extends SuperBase {\n  static properties = {\n    ...super.properties,\n    _selectedTab: { type: Number },\n  };\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n      .editor-container {\n        padding: 16px;\n      }\n    `,\n  ];\n\n  constructor(defaultConfig = {}) {\n    super();\n    this._debug('[EditorBase] EditorBase-Konstruktor wird aufgerufen');\n    this.config = {\n      type: 'custom:tgeditor-card',\n      ...defaultConfig,\n    };\n    this._debug('[EditorBase] EditorBase config nach Konstruktor:', this.config);\n  }\n\n  async firstUpdated() {\n    this._debug('[EditorBase] EditorBase firstUpdated wird aufgerufen');\n    await super.firstUpdated();\n    this._debug('[EditorBase] EditorBase firstUpdated abgeschlossen');\n  }\n\n  async loadHaForm() {\n    this._debug('[EditorBase] EditorBase loadHaForm wird aufgerufen');\n    if (!customElements.get('ha-form')) {\n      this._debug('[EditorBase] EditorBase ha-form nicht gefunden, lade custom-card-helpers');\n      try {\n        const cardHelpers = await import('custom-card-helpers');\n        this._debug('[EditorBase] EditorBase custom-card-helpers geladen');\n        await cardHelpers.loadHaForm();\n        this._debug('[EditorBase] EditorBase ha-form geladen');\n      } catch (error) {\n        throw error;\n      }\n    } else {\n      this._debug('[EditorBase] EditorBase ha-form bereits geladen');\n    }\n  }\n\n  getDefaultConfig() {\n    this._debug('[EditorBase] EditorBase getDefaultConfig wird aufgerufen');\n    throw new Error('getDefaultConfig muss in der abgeleiteten Klasse implementiert werden');\n  }\n\n  getStubConfig() {\n    this._debug('[EditorBase] EditorBase getStubConfig wird aufgerufen');\n    return this.getDefaultConfig();\n  }\n\n  setConfig(config) {\n    this._debug('[EditorBase] EditorBase setConfig wird aufgerufen mit:', config);\n    if (!config) {\n      throw new Error('Keine Konfiguration angegeben');\n    }\n\n    // Prfe, ob es sich um eine neue Konfiguration handelt\n    const isNewConfig = !this.config || Object.keys(this.config).length === 0;\n\n    // Wenn es eine neue Konfiguration ist, verwende sie direkt\n    if (isNewConfig) {\n      this.config = {\n        ...this.getDefaultConfig(),\n        ...config,\n      };\n    } else {\n      // Ansonsten behalte die bestehende Konfiguration bei und aktualisiere nur genderte Werte\n      this.config = {\n        ...this.config,\n        ...config,\n      };\n    }\n\n    this._debug('[EditorBase] EditorBase config nach setConfig:', this.config);\n  }\n}\n","import { html, css } from 'lit';\nimport { EditorBase } from './editor-base.js';\nimport { CardRegname } from '../card-config.js';\n\nexport class EditorImpl extends EditorBase {\n  static properties = {\n    ...super.properties,\n  };\n\n  constructor() {\n    super({\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      selectedCalendar: 'a',\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      calendars: [\n        { shortcut: 'a', name: 'Schicht A', color: '#ff9800', enabled: true, statusRelevant: true },\n        {\n          shortcut: 'b',\n          name: 'Schicht B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Schicht C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Schicht D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Schicht E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ],\n      holidays: {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      },\n    });\n\n    this._debug(`EditorImpl-Modul wird geladen`);\n  }\n\n  async firstUpdated() {\n    this._debug(`EditorImpl firstUpdated wird aufgerufen`);\n    await super.firstUpdated();\n    this._debug(`EditorImpl firstUpdated abgeschlossen`);\n  }\n\n  render() {\n    this._debug('EditorImpl render wird aufgerufen');\n    if (!this.hass) {\n      this._debug(`EditorImpl render: Kein hass`);\n      return html`<div>Loading...</div>`;\n    }\n\n    this._debug(`EditorImpl render mit config:`, this.config);\n\n    // Stelle sicher, dass calendars Array vorhanden ist und alle 5 Kalender enthlt\n    if (!this.config.calendars || !Array.isArray(this.config.calendars)) {\n      this.config.calendars = [\n        {\n          shortcut: 'a',\n          name: 'Schicht A',\n          color: '#ff9800',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'b',\n          name: 'Schicht B',\n          color: '#ff0000',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'c',\n          name: 'Schicht C',\n          color: '#00ff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'd',\n          name: 'Schicht D',\n          color: '#0000ff',\n          enabled: false,\n          statusRelevant: true,\n        },\n        {\n          shortcut: 'e',\n          name: 'Schicht E',\n          color: '#ffff00',\n          enabled: false,\n          statusRelevant: true,\n        },\n      ];\n    }\n\n    // Stelle sicher, dass genau 5 Kalender vorhanden sind (a, b, c, d, e)\n    const defaultCalendars = [\n      { shortcut: 'a', name: 'Schicht A', color: '#ff9800', enabled: false, statusRelevant: true },\n      { shortcut: 'b', name: 'Schicht B', color: '#ff0000', enabled: false, statusRelevant: true },\n      { shortcut: 'c', name: 'Schicht C', color: '#00ff00', enabled: false, statusRelevant: true },\n      { shortcut: 'd', name: 'Schicht D', color: '#0000ff', enabled: false, statusRelevant: true },\n      { shortcut: 'e', name: 'Schicht E', color: '#ffff00', enabled: false, statusRelevant: true },\n    ];\n\n    // Initialisiere oder aktualisiere Kalender-Array\n    const calendarsMap = new Map();\n    this.config.calendars.forEach(cal => calendarsMap.set(cal.shortcut, cal));\n\n    // Fge fehlende Kalender hinzu oder aktualisiere vorhandene\n    this.config.calendars = defaultCalendars.map(defaultCal => {\n      const existing = calendarsMap.get(defaultCal.shortcut);\n      if (existing) {\n        // Behalte konfigurierte Werte, aber stelle sicher, dass shortcut fix bleibt\n        // Stelle sicher, dass statusRelevant vorhanden ist (Default: true)\n        return {\n          ...defaultCal,\n          ...existing,\n          shortcut: defaultCal.shortcut,\n          statusRelevant: existing.statusRelevant !== undefined ? existing.statusRelevant : true,\n        };\n      }\n      return defaultCal;\n    });\n\n    // Stelle sicher, dass store_mode immer 'saver' ist und saver_key gesetzt ist\n    this.config.store_mode = 'saver';\n    if (!this.config.saver_key) {\n      this.config.saver_key = 'Schichtplan';\n    }\n\n    return html`\n      <div class=\"card-config\">\n        <div class=\"saver-info-message\">\n          <p>\n            <strong> Saver-Integration:</strong> Diese Karte verwendet die \n            <a href=\"https://github.com/PiotrMachowski/Home-Assistant-custom-components-Saver\" target=\"_blank\" rel=\"noopener noreferrer\">Saver-Integration</a> \n            zur Speicherung der Schichtdaten. Die Daten werden in Saver-Variablen gespeichert, ohne Lngenbegrenzung.\n          </p>\n        </div>\n        <ha-form\n          .hass=${this.hass}\n          .data=${this.config}\n          .schema=${this._getBasicSchema()}\n          .computeLabel=${this._computeLabel}\n          @value-changed=${this._valueChanged}\n        ></ha-form>\n        <div class=\"elements-section\">${this._renderHolidays()}</div>\n      </div>\n    `;\n  }\n\n  _getColorOptions() {\n    // Liste von vordefinierten Farben\n    return [\n      { value: '#ff0000', name: 'Rot' },\n      { value: '#00ff00', name: 'Grn' },\n      { value: '#0000ff', name: 'Blau' },\n      { value: '#ffff00', name: 'Gelb' },\n      { value: '#ff00ff', name: 'Magenta' },\n      { value: '#00ffff', name: 'Cyan' },\n      { value: '#ff8800', name: 'Orange' },\n      { value: '#8800ff', name: 'Violett' },\n      { value: '#0088ff', name: 'Hellblau' },\n      { value: '#ff0088', name: 'Pink' },\n      { value: '#88ff00', name: 'Lime' },\n      { value: '#008888', name: 'Trkis' },\n      { value: '#888888', name: 'Grau' },\n      { value: '#000000', name: 'Schwarz' },\n      { value: '#ffffff', name: 'Wei' },\n    ];\n  }\n\n  _validateTime(timeString) {\n    if (!timeString || timeString.trim() === '') {\n      return true; // Leer ist erlaubt (optional)\n    }\n    const timePattern = /^([0-1][0-9]|2[0-3]):[0-5][0-9]$/;\n    return timePattern.test(timeString.trim());\n  }\n\n  _validateTimeRange(range) {\n    if (!range || !Array.isArray(range) || range.length < 2) {\n      return { isValid: true, message: '' }; // Leer ist erlaubt\n    }\n    const start = range[0];\n    const end = range[1];\n    const hasStart = start && start.trim() !== '';\n    const hasEnd = end && end.trim() !== '';\n\n    // Beide leer = OK (optional)\n    if (!hasStart && !hasEnd) {\n      return { isValid: true, message: '' };\n    }\n\n    // Beide gesetzt = prfe Format\n    if (hasStart && hasEnd) {\n      const startValid = this._validateTime(start);\n      const endValid = this._validateTime(end);\n      if (!startValid) {\n        return {\n          isValid: false,\n          message: 'Ungltiges Format fr Startzeit. Bitte HH:MM verwenden (z.B. 08:30)',\n        };\n      }\n      if (!endValid) {\n        return {\n          isValid: false,\n          message: 'Ungltiges Format fr Endzeit. Bitte HH:MM verwenden (z.B. 17:00)',\n        };\n      }\n      return { isValid: true, message: '' };\n    }\n\n    // Nur eine Zeit gesetzt = Fehler\n    if (hasStart && !hasEnd) {\n      return { isValid: false, message: 'Bitte auch die Endzeit angeben' };\n    }\n    if (!hasStart && hasEnd) {\n      return { isValid: false, message: 'Bitte auch die Startzeit angeben' };\n    }\n\n    return { isValid: true, message: '' };\n  }\n\n  _renderCalendar(index, calendar) {\n    const colorOptions = this._getColorOptions();\n    const currentColor = calendar.color || '#ff0000';\n    const timeRanges = calendar.timeRanges || [\n      [null, null],\n      [null, null],\n    ];\n\n    const shiftName = calendar.name || `Schicht ${calendar.shortcut.toUpperCase()}`;\n    const isEnabled = calendar.enabled || false;\n\n    // Validiere Zeitrume fr visuelles Feedback\n    const range1Validation = this._validateTimeRange(timeRanges[0]);\n    const range2Validation = this._validateTimeRange(timeRanges[1]);\n\n    // Prfe einzelne Zeiten fr Format-Validierung\n    const isValidTimeRange1Start =\n      !timeRanges[0] || !timeRanges[0][0] || this._validateTime(timeRanges[0][0]);\n    const isValidTimeRange1End =\n      !timeRanges[0] || !timeRanges[0][1] || this._validateTime(timeRanges[0][1]);\n    const isValidTimeRange2Start =\n      !timeRanges[1] || !timeRanges[1][0] || this._validateTime(timeRanges[1][0]);\n    const isValidTimeRange2End =\n      !timeRanges[1] || !timeRanges[1][1] || this._validateTime(timeRanges[1][1]);\n\n    // Kombiniere Format- und Vollstndigkeits-Validierung\n    const range1StartError = !isValidTimeRange1Start || !range1Validation.isValid;\n    const range1EndError = !isValidTimeRange1End || !range1Validation.isValid;\n    const range2StartError = !isValidTimeRange2Start || !range2Validation.isValid;\n    const range2EndError = !isValidTimeRange2End || !range2Validation.isValid;\n\n    return html`\n      <details class=\"calendar-item\">\n        <summary class=\"calendar-summary\">\n          <span class=\"calendar-summary-title\"\n            >Schicht ${calendar.shortcut.toUpperCase()}: ${shiftName}</span\n          >\n          <span class=\"calendar-summary-status\">\n            ${isEnabled\n              ? html`<span class=\"status-badge status-enabled\">Aktiviert</span>`\n              : html`<span class=\"status-badge status-disabled\">Deaktiviert</span>`}\n          </span>\n        </summary>\n        <div class=\"calendar-fields\">\n          <ha-textfield\n            label=\"Name\"\n            .value=${calendar.name || ''}\n            maxlength=\"30\"\n            @input=${e => this._updateCalendar(calendar.shortcut, 'name', e.target.value)}\n          ></ha-textfield>\n          <div class=\"switch-item\">\n            <label class=\"switch-label\">Aktiviert</label>\n            <ha-switch\n              .checked=${calendar.enabled || false}\n              @change=${e => this._updateCalendar(calendar.shortcut, 'enabled', e.target.checked)}\n            ></ha-switch>\n          </div>\n          <div class=\"switch-item\">\n            <label class=\"switch-label\">Status relevant</label>\n            <ha-switch\n              .checked=${calendar.statusRelevant !== false}\n              @change=${e =>\n                this._updateCalendar(calendar.shortcut, 'statusRelevant', e.target.checked)}\n            ></ha-switch>\n          </div>\n          <div class=\"color-selector\">\n            <div class=\"color-selector-label\">Farbe</div>\n            <ha-combo-box\n              label=\"Farbe\"\n              .value=${currentColor}\n              .items=${colorOptions.map(color => ({\n                value: color.value,\n                label: `${color.name} (${color.value})`,\n              }))}\n              @value-changed=${e => {\n                const value = e.detail?.value;\n                if (value) {\n                  this._updateCalendar(calendar.shortcut, 'color', value);\n                }\n              }}\n            ></ha-combo-box>\n            <div class=\"color-selected-preview\">\n              <span class=\"color-preview-large\" style=\"background-color: ${currentColor};\"></span>\n              <span class=\"color-selected-value\">${currentColor}</span>\n            </div>\n          </div>\n          <div class=\"time-ranges\">\n            <div class=\"time-range-label\">Zeitrume (optional)</div>\n            <div class=\"time-range-item\">\n              <ha-textfield\n                label=\"Startzeit 1\"\n                .value=${timeRanges[0] && timeRanges[0][0] ? timeRanges[0][0] : ''}\n                placeholder=\"HH:MM\"\n                pattern=\"^([0-1][0-9]|2[0-3]):[0-5][0-9]$\"\n                .error=${range1StartError}\n                .helper=${range1StartError\n                  ? range1Validation.message ||\n                    'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                  : ''}\n                @input=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  this._updateTimeRange(calendar.shortcut, 0, 0, value);\n                  // Prfe Vollstndigkeit nach Update\n                  setTimeout(() => {\n                    const updatedCal = this.config.calendars?.find(\n                      c => c.shortcut === calendar.shortcut\n                    );\n                    const updatedRange = updatedCal?.timeRanges?.[0] || [null, null];\n                    const rangeValidation = this._validateTimeRange(updatedRange);\n                    const hasError = !formatValid || !rangeValidation.isValid;\n                    e.target.error = hasError;\n                    e.target.helper = hasError\n                      ? rangeValidation.message ||\n                        'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                      : '';\n                    this.requestUpdate();\n                  }, 0);\n                }}\n                @blur=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  const updatedCal = this.config.calendars?.find(\n                    c => c.shortcut === calendar.shortcut\n                  );\n                  const updatedRange = updatedCal?.timeRanges?.[0] || [null, null];\n                  const rangeValidation = this._validateTimeRange(updatedRange);\n                  const hasError = !formatValid || !rangeValidation.isValid;\n                  e.target.error = hasError;\n                  e.target.helper = hasError\n                    ? rangeValidation.message ||\n                      'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                    : '';\n                  this.requestUpdate();\n                }}\n              ></ha-textfield>\n              <span class=\"time-separator\">-</span>\n              <ha-textfield\n                label=\"Endzeit 1\"\n                .value=${timeRanges[0] && timeRanges[0][1] ? timeRanges[0][1] : ''}\n                placeholder=\"HH:MM\"\n                pattern=\"^([0-1][0-9]|2[0-3]):[0-5][0-9]$\"\n                .error=${range1EndError}\n                .helper=${range1EndError\n                  ? range1Validation.message ||\n                    'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                  : ''}\n                @input=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  this._updateTimeRange(calendar.shortcut, 0, 1, value);\n                  setTimeout(() => {\n                    const updatedCal = this.config.calendars?.find(\n                      c => c.shortcut === calendar.shortcut\n                    );\n                    const updatedRange = updatedCal?.timeRanges?.[0] || [null, null];\n                    const rangeValidation = this._validateTimeRange(updatedRange);\n                    const hasError = !formatValid || !rangeValidation.isValid;\n                    e.target.error = hasError;\n                    e.target.helper = hasError\n                      ? rangeValidation.message ||\n                        'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                      : '';\n                    this.requestUpdate();\n                  }, 0);\n                }}\n                @blur=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  const updatedCal = this.config.calendars?.find(\n                    c => c.shortcut === calendar.shortcut\n                  );\n                  const updatedRange = updatedCal?.timeRanges?.[0] || [null, null];\n                  const rangeValidation = this._validateTimeRange(updatedRange);\n                  const hasError = !formatValid || !rangeValidation.isValid;\n                  e.target.error = hasError;\n                  e.target.helper = hasError\n                    ? rangeValidation.message ||\n                      'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                    : '';\n                  this.requestUpdate();\n                }}\n              ></ha-textfield>\n            </div>\n            <div class=\"time-range-item\">\n              <ha-textfield\n                label=\"Startzeit 2\"\n                .value=${timeRanges[1] && timeRanges[1][0] ? timeRanges[1][0] : ''}\n                placeholder=\"HH:MM\"\n                pattern=\"^([0-1][0-9]|2[0-3]):[0-5][0-9]$\"\n                .error=${range2StartError}\n                .helper=${range2StartError\n                  ? range2Validation.message ||\n                    'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                  : ''}\n                @input=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  this._updateTimeRange(calendar.shortcut, 1, 0, value);\n                  setTimeout(() => {\n                    const updatedCal = this.config.calendars?.find(\n                      c => c.shortcut === calendar.shortcut\n                    );\n                    const updatedRange = updatedCal?.timeRanges?.[1] || [null, null];\n                    const rangeValidation = this._validateTimeRange(updatedRange);\n                    const hasError = !formatValid || !rangeValidation.isValid;\n                    e.target.error = hasError;\n                    e.target.helper = hasError\n                      ? rangeValidation.message ||\n                        'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                      : '';\n                    this.requestUpdate();\n                  }, 0);\n                }}\n                @blur=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  const updatedCal = this.config.calendars?.find(\n                    c => c.shortcut === calendar.shortcut\n                  );\n                  const updatedRange = updatedCal?.timeRanges?.[1] || [null, null];\n                  const rangeValidation = this._validateTimeRange(updatedRange);\n                  const hasError = !formatValid || !rangeValidation.isValid;\n                  e.target.error = hasError;\n                  e.target.helper = hasError\n                    ? rangeValidation.message ||\n                      'Ungltiges Format. Bitte HH:MM verwenden (z.B. 08:30)'\n                    : '';\n                  this.requestUpdate();\n                }}\n              ></ha-textfield>\n              <span class=\"time-separator\">-</span>\n              <ha-textfield\n                label=\"Endzeit 2\"\n                .value=${timeRanges[1] && timeRanges[1][1] ? timeRanges[1][1] : ''}\n                placeholder=\"HH:MM\"\n                pattern=\"^([0-1][0-9]|2[0-3]):[0-5][0-9]$\"\n                .error=${range2EndError}\n                .helper=${range2EndError\n                  ? range2Validation.message ||\n                    'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                  : ''}\n                @input=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  this._updateTimeRange(calendar.shortcut, 1, 1, value);\n                  setTimeout(() => {\n                    const updatedCal = this.config.calendars?.find(\n                      c => c.shortcut === calendar.shortcut\n                    );\n                    const updatedRange = updatedCal?.timeRanges?.[1] || [null, null];\n                    const rangeValidation = this._validateTimeRange(updatedRange);\n                    const hasError = !formatValid || !rangeValidation.isValid;\n                    e.target.error = hasError;\n                    e.target.helper = hasError\n                      ? rangeValidation.message ||\n                        'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                      : '';\n                    this.requestUpdate();\n                  }, 0);\n                }}\n                @blur=${e => {\n                  const value = e.target.value.trim() || null;\n                  const formatValid = !value || this._validateTime(value);\n                  const updatedCal = this.config.calendars?.find(\n                    c => c.shortcut === calendar.shortcut\n                  );\n                  const updatedRange = updatedCal?.timeRanges?.[1] || [null, null];\n                  const rangeValidation = this._validateTimeRange(updatedRange);\n                  const hasError = !formatValid || !rangeValidation.isValid;\n                  e.target.error = hasError;\n                  e.target.helper = hasError\n                    ? rangeValidation.message ||\n                      'Ungltiges Format. Bitte HH:MM verwenden (z.B. 17:00)'\n                    : '';\n                  this.requestUpdate();\n                }}\n              ></ha-textfield>\n            </div>\n          </div>\n        </div>\n      </details>\n    `;\n  }\n\n  _renderHolidays() {\n    // Stelle sicher, dass holidays Konfiguration existiert\n    if (!this.config.holidays) {\n      this.config.holidays = {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      };\n    }\n\n    const holidays = [\n      { key: 'neujahr', label: 'Neujahr (1. Januar)' },\n      { key: 'heilige_drei_koenige', label: 'Heilige Drei Knige (6. Januar)' },\n      { key: 'tag_der_arbeit', label: 'Tag der Arbeit (1. Mai)' },\n      { key: 'friedensfest', label: 'Friedensfest (8. August)' },\n      { key: 'mariae_himmelfahrt', label: 'Mari Himmelfahrt (15. August)' },\n      { key: 'tag_der_deutschen_einheit', label: 'Tag der Deutschen Einheit (3. Oktober)' },\n      { key: 'reformationstag', label: 'Reformationstag (31. Oktober)' },\n      { key: 'allerheiligen', label: 'Allerheiligen (1. November)' },\n      { key: 'weihnachten_1', label: '1. Weihnachtsfeiertag (25. Dezember)' },\n      { key: 'weihnachten_2', label: '2. Weihnachtsfeiertag (26. Dezember)' },\n      { key: 'karfreitag', label: 'Karfreitag' },\n      { key: 'ostermontag', label: 'Ostermontag' },\n      { key: 'christi_himmelfahrt', label: 'Christi Himmelfahrt' },\n      { key: 'pfingstmontag', label: 'Pfingstmontag' },\n      { key: 'fronleichnam', label: 'Fronleichnam' },\n      { key: 'busstag', label: 'Bu- und Bettag' },\n    ];\n\n    return html`\n      <details class=\"holidays-item\">\n        <summary class=\"holidays-summary\">\n          <span class=\"holidays-summary-title\">Feiertage</span>\n        </summary>\n        <div class=\"holidays-fields\">\n          ${holidays.map(\n            holiday => html`\n              <div class=\"holiday-switch-item\">\n                <label class=\"holiday-label\">${holiday.label}</label>\n                <ha-switch\n                  .checked=${this.config.holidays[holiday.key] !== false}\n                  @change=${e => this._updateHoliday(holiday.key, e.target.checked)}\n                ></ha-switch>\n              </div>\n            `\n          )}\n        </div>\n      </details>\n    `;\n  }\n\n  _updateHoliday(key, enabled) {\n    if (!this.config.holidays) {\n      this.config.holidays = {};\n    }\n\n    // Aktualisiere die Config direkt (immutable update)\n    const newConfig = {\n      ...this.config,\n      holidays: {\n        ...this.config.holidays,\n        [key]: enabled,\n      },\n    };\n\n    // Aktualisiere die Config direkt\n    this.config = newConfig;\n\n    // Aktualisiere die Ansicht sofort\n    this.requestUpdate();\n\n    // Dispatch config-changed Event\n    setTimeout(() => {\n      this.dispatchEvent(\n        new CustomEvent('config-changed', {\n          detail: { config: newConfig },\n          bubbles: true,\n          composed: true,\n        })\n      );\n    }, 0);\n  }\n\n  _updateTimeRange(shortcut, rangeIndex, timeIndex, value) {\n    // rangeIndex: 0 oder 1 (erster oder zweiter Zeitraum)\n    // timeIndex: 0 oder 1 (Start oder End)\n    if (!this.config.calendars) {\n      this.config.calendars = [\n        { shortcut: 'a', name: 'Schicht A', color: '#ff9800', enabled: false },\n        { shortcut: 'b', name: 'Schicht B', color: '#ff0000', enabled: false },\n        { shortcut: 'c', name: 'Schicht C', color: '#00ff00', enabled: false },\n        { shortcut: 'd', name: 'Schicht D', color: '#0000ff', enabled: false },\n        { shortcut: 'e', name: 'Schicht E', color: '#ffff00', enabled: false },\n      ];\n    }\n\n    // Erstelle eine neue Kopie des Arrays und aktualisiere den betroffenen Kalender\n    const newCalendars = this.config.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        // Stelle sicher, dass timeRanges Array existiert\n        const timeRanges = cal.timeRanges || [\n          [null, null],\n          [null, null],\n        ];\n        // Erstelle eine Kopie des timeRanges Arrays\n        const newTimeRanges = timeRanges.map((range, idx) => {\n          if (idx === rangeIndex) {\n            // Erstelle eine Kopie des Zeitraums\n            const newRange = [...range];\n            newRange[timeIndex] = value || null;\n            return newRange;\n          }\n          return range;\n        });\n\n        return {\n          ...cal,\n          timeRanges: newTimeRanges,\n        };\n      }\n      return cal;\n    });\n\n    // Aktualisiere die Config direkt (immutable update)\n    const newConfig = {\n      ...this.config,\n      calendars: newCalendars,\n    };\n\n    // Aktualisiere die Config direkt\n    this.config = newConfig;\n\n    // Aktualisiere die Ansicht sofort\n    this.requestUpdate();\n\n    // Dispatch config-changed Event\n    setTimeout(() => {\n      this.dispatchEvent(\n        new CustomEvent('config-changed', {\n          detail: { config: newConfig },\n          bubbles: true,\n          composed: true,\n        })\n      );\n    }, 0);\n  }\n\n  _updateCalendar(shortcut, property, value) {\n    if (!this.config.calendars) {\n      this.config.calendars = [\n        { shortcut: 'a', name: 'Schicht A', color: '#ff9800', enabled: false },\n        { shortcut: 'b', name: 'Schicht B', color: '#ff0000', enabled: false },\n        { shortcut: 'c', name: 'Schicht C', color: '#00ff00', enabled: false },\n        { shortcut: 'd', name: 'Schicht D', color: '#0000ff', enabled: false },\n        { shortcut: 'e', name: 'Schicht E', color: '#ffff00', enabled: false },\n      ];\n    }\n\n    // Erstelle eine neue Kopie des Arrays und aktualisiere den betroffenen Kalender\n    const newCalendars = this.config.calendars.map(cal => {\n      if (cal.shortcut === shortcut) {\n        return {\n          ...cal,\n          [property]: value,\n        };\n      }\n      return cal;\n    });\n\n    // Aktualisiere die Config direkt (immutable update)\n    const newConfig = {\n      ...this.config,\n      calendars: newCalendars,\n    };\n\n    // Aktualisiere die Config direkt\n    this.config = newConfig;\n\n    // Aktualisiere die Ansicht sofort\n    this.requestUpdate();\n\n    // Dispatch config-changed Event - Home Assistant speichert die Config automatisch\n    // Verwende setTimeout, um sicherzustellen, dass das Event nicht den Editor schliet\n    setTimeout(() => {\n      this.dispatchEvent(\n        new CustomEvent('config-changed', {\n          detail: { config: newConfig },\n          bubbles: true,\n          composed: true,\n        })\n      );\n    }, 0);\n  }\n\n  _computeLabel(schema) {\n    switch (schema.name) {\n      case 'numberOfMonths':\n        return 'Maximale Anzahl Monate';\n      case 'initialDisplayedMonths':\n        return 'Standardwert sichtbare Monate';\n      case 'saver_key':\n        return 'Saver-Variablenname';\n      default:\n        return schema.name;\n    }\n  }\n\n  _valueChanged(ev) {\n    this._debug('EditorImpl _valueChanged wird aufgerufen mit:', ev.detail);\n\n    const newValue = ev.detail.value;\n    const oldStoreMode = this.config.store_mode;\n\n    // Stelle sicher, dass initialDisplayedMonths nicht grer als numberOfMonths ist\n    if (newValue.initialDisplayedMonths !== undefined && newValue.numberOfMonths !== undefined) {\n      newValue.initialDisplayedMonths = Math.min(\n        newValue.initialDisplayedMonths,\n        newValue.numberOfMonths\n      );\n    } else if (newValue.initialDisplayedMonths !== undefined && this.config.numberOfMonths) {\n      newValue.initialDisplayedMonths = Math.min(\n        newValue.initialDisplayedMonths,\n        this.config.numberOfMonths\n      );\n    } else if (newValue.numberOfMonths !== undefined && this.config.initialDisplayedMonths) {\n      // Wenn numberOfMonths gendert wird, passe initialDisplayedMonths an, falls ntig\n      if (this.config.initialDisplayedMonths > newValue.numberOfMonths) {\n        newValue.initialDisplayedMonths = newValue.numberOfMonths;\n      }\n    }\n\n    // Stelle sicher, dass store_mode immer 'saver' ist und saver_key gesetzt ist\n    newValue.store_mode = 'saver';\n    if (newValue.saver_key === undefined) {\n      newValue.saver_key = this.config.saver_key || 'Schichtplan';\n    }\n\n    this.config = {\n      ...this.config,\n      ...newValue,\n    };\n    this._debug('EditorImpl config nach _valueChanged:', this.config);\n\n    this.dispatchEvent(\n      new CustomEvent('config-changed', {\n        detail: { config: this.config },\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n      }\n\n      .card-config {\n        padding: 10px;\n      }\n\n      .elements-section {\n        margin-top: 20px;\n        padding-top: 20px;\n        border-top: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .elements-header {\n        margin-bottom: 15px;\n      }\n\n      .elements-header ha-combo-box {\n        width: 100%;\n      }\n\n      .saver-info-message {\n        margin-bottom: 20px;\n        padding: 12px;\n        background-color: var(--info-color, #2196f3);\n        color: white;\n        border-radius: 4px;\n      }\n\n      .saver-info-message p {\n        margin: 0;\n      }\n\n      .saver-info-message a {\n        color: white;\n        text-decoration: underline;\n        font-weight: 500;\n      }\n\n      .saver-info-message a:hover {\n        text-decoration: none;\n      }\n\n      .info-message {\n        margin-top: 15px;\n        padding: 12px;\n        background-color: var(--info-color, #2196f3);\n        color: white;\n        border-radius: 4px;\n      }\n\n      .info-message p {\n        margin: 0;\n      }\n\n      .calendar-item {\n        margin-bottom: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-radius: 4px;\n        overflow: hidden;\n      }\n\n      .calendar-item[open] {\n        border-color: var(--primary-color, #03a9f4);\n      }\n\n      .calendar-summary {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 15px;\n        cursor: pointer;\n        list-style: none;\n        user-select: none;\n        background-color: var(--card-background-color, #ffffff);\n        transition: background-color 0.2s ease;\n      }\n\n      .calendar-summary::-webkit-details-marker {\n        display: none;\n      }\n\n      .calendar-summary::before {\n        content: '';\n        display: inline-block;\n        margin-right: 8px;\n        transition: transform 0.2s ease;\n        color: var(--primary-color, #03a9f4);\n        font-size: 10px;\n      }\n\n      .calendar-item[open] .calendar-summary::before {\n        transform: rotate(90deg);\n      }\n\n      .calendar-summary:hover {\n        background-color: var(--divider-color, #f5f5f5);\n      }\n\n      .calendar-summary-title {\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--primary-text-color, #000000);\n        flex: 1;\n      }\n\n      .calendar-summary-status {\n        display: flex;\n        align-items: center;\n        margin-left: 12px;\n      }\n\n      .status-badge {\n        padding: 4px 8px;\n        border-radius: 12px;\n        font-size: 11px;\n        font-weight: 500;\n        text-transform: uppercase;\n      }\n\n      .status-enabled {\n        background-color: var(--success-color, #4caf50);\n        color: white;\n      }\n\n      .status-disabled {\n        background-color: var(--disabled-color, #9e9e9e);\n        color: white;\n      }\n\n      .calendar-fields {\n        display: grid;\n        grid-template-columns: 1fr;\n        gap: 15px;\n        padding: 15px;\n        border-top: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .calendar-fields ha-textfield,\n      .calendar-fields ha-switch,\n      .calendar-fields .color-selector {\n        width: 100%;\n      }\n\n      .switch-item {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 12px;\n      }\n\n      .switch-label {\n        flex: 1;\n        font-size: 14px;\n        color: var(--primary-text-color, #000000);\n        cursor: pointer;\n      }\n\n      .calendar-fields ha-switch {\n        flex-shrink: 0;\n      }\n\n      ha-switch {\n        display: flex;\n        align-items: center;\n      }\n\n      .color-selector {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n\n      .color-selector-label {\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--primary-text-color, #000000);\n      }\n\n      .color-selector ha-combo-box {\n        width: 100%;\n      }\n\n      .color-option {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 4px 0;\n      }\n\n      .color-preview {\n        display: inline-block;\n        width: 24px;\n        height: 24px;\n        border-radius: 4px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n        flex-shrink: 0;\n      }\n\n      .color-preview-large {\n        display: inline-block;\n        width: 32px;\n        height: 32px;\n        border-radius: 4px;\n        border: 2px solid var(--divider-color, #e0e0e0);\n        flex-shrink: 0;\n      }\n\n      .color-name {\n        flex: 1;\n        font-weight: 500;\n      }\n\n      .color-value {\n        font-size: 12px;\n        color: var(--secondary-text-color, #888888);\n        font-family: monospace;\n      }\n\n      .color-selected-preview {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 8px;\n        background-color: var(--card-background-color, #f5f5f5);\n        border-radius: 4px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .color-selected-value {\n        font-size: 14px;\n        font-family: monospace;\n        color: var(--primary-text-color, #000000);\n        font-weight: 500;\n      }\n\n      .time-ranges {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        margin-top: 15px;\n        padding: 12px;\n        background-color: var(--card-background-color, #f5f5f5);\n        border-radius: 4px;\n        border: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .time-range-label {\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--primary-text-color, #000000);\n        margin-bottom: 8px;\n      }\n\n      .time-range-item {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n      }\n\n      .time-range-item ha-textfield {\n        flex: 1;\n      }\n\n      .time-separator {\n        font-size: 16px;\n        font-weight: 500;\n        color: var(--primary-text-color, #000000);\n        flex-shrink: 0;\n      }\n\n      .holidays-item {\n        margin-bottom: 12px;\n        background-color: var(--card-background-color, #ffffff);\n        border: 1px solid var(--divider-color, #e0e0e0);\n        border-radius: 4px;\n        overflow: hidden;\n      }\n\n      .holidays-item[open] {\n        border-color: var(--primary-color, #03a9f4);\n      }\n\n      .holidays-summary {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 15px;\n        cursor: pointer;\n        list-style: none;\n        user-select: none;\n        background-color: var(--card-background-color, #ffffff);\n        transition: background-color 0.2s ease;\n      }\n\n      .holidays-summary::-webkit-details-marker {\n        display: none;\n      }\n\n      .holidays-summary::before {\n        content: '';\n        display: inline-block;\n        margin-right: 8px;\n        transition: transform 0.2s ease;\n        color: var(--primary-color, #03a9f4);\n        font-size: 10px;\n      }\n\n      .holidays-item[open] .holidays-summary::before {\n        transform: rotate(90deg);\n      }\n\n      .holidays-summary:hover {\n        background-color: var(--divider-color, #f5f5f5);\n      }\n\n      .holidays-summary-title {\n        font-size: 14px;\n        font-weight: 500;\n        color: var(--primary-text-color, #000000);\n        flex: 1;\n      }\n\n      .holidays-fields {\n        display: grid;\n        grid-template-columns: 1fr;\n        gap: 12px;\n        padding: 15px;\n        border-top: 1px solid var(--divider-color, #e0e0e0);\n      }\n\n      .holiday-switch-item {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 12px;\n      }\n\n      .holiday-label {\n        flex: 1;\n        font-size: 14px;\n        color: var(--primary-text-color, #000000);\n        cursor: pointer;\n      }\n\n      .holidays-fields ha-switch {\n        flex-shrink: 0;\n      }\n    `,\n  ];\n\n  static getConfigElement() {\n    return document.createElement(`${CardRegname}-editor`);\n  }\n\n  static getStubConfig() {\n    return {\n      numberOfMonths: 14,\n      initialDisplayedMonths: 2,\n      store_mode: 'saver',\n      saver_key: 'Schichtplan',\n      holidays: {\n        neujahr: true,\n        heilige_drei_koenige: true,\n        tag_der_arbeit: true,\n        friedensfest: true,\n        mariae_himmelfahrt: true,\n        tag_der_deutschen_einheit: true,\n        reformationstag: true,\n        allerheiligen: true,\n        weihnachten_1: true,\n        weihnachten_2: true,\n        karfreitag: true,\n        ostermontag: true,\n        christi_himmelfahrt: true,\n        pfingstmontag: true,\n        fronleichnam: true,\n        busstag: true,\n      },\n    };\n  }\n\n  _getBasicSchema() {\n    const schema = [\n      {\n        name: 'saver_key',\n        selector: {\n          text: {},\n        },\n      },\n      {\n        name: 'numberOfMonths',\n        selector: {\n          number: {\n            min: 1,\n            max: 14,\n            step: 1,\n            mode: 'box',\n          },\n        },\n      },\n      {\n        name: 'initialDisplayedMonths',\n        selector: {\n          number: {\n            min: 1,\n            max: 14,\n            step: 1,\n            mode: 'box',\n          },\n        },\n      },\n    ];\n\n    return schema;\n  }\n}\n","import { css } from 'lit';\nimport { EditorImpl } from './editor-impl.js';\nimport { CardRegname } from '../card-config.js';\n\nexport class Editor extends EditorImpl {\n  static styles = [\n    super.styles,\n    css`\n      :host {\n        display: block;\n        padding-top: 2px;\n        padding-bottom: 2px;\n        padding-left: 16px;\n        padding-right: 16px;\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n  }\n}\n\nif (!customElements.get(`${CardRegname}-editor`)) {\n  customElements.define(`${CardRegname}-editor`, Editor);\n}\n","import { LitElement, html, css } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { CardImpl } from './card-impl.js';\nimport './editor/editor.js';\nimport { CardRegname, CardName, CardDescription } from './card-config.js';\n\nexport class Card extends CardImpl {\n  // className wird von CardImpl geerbt (ist 'CardImpl')\n  static styles = [\n    super.styles,\n    css`\n      :host {\n      }\n    `,\n  ];\n\n  constructor() {\n    super();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n  }\n}\n\n// Registriere die Karte in der UI\nif (window.customCards) {\n  window.customCards.push({\n    type: CardRegname,\n    name: CardName,\n    description: CardDescription,\n    preview: true,\n  });\n}\n\n// Registriere die Karte als Custom Element\nif (!customElements.get(CardRegname)) {\n  try {\n    customElements.define(CardRegname, Card);\n  } catch (error) {}\n}\n"],"names":["inProgress","dataWebpackPrefix","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","call","l","url","done","push","script","needAttach","scripts","document","getElementsByTagName","i","length","s","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","fn","setTimeout","bind","type","target","head","appendChild","r","Symbol","toStringTag","value","scriptUrl","importScripts","location","currentScript","tagName","toUpperCase","test","Error","replace","p","installedChunks","j","installedChunkData","promise","resolve","reject","error","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","self","ShadowRoot","ShadyCSS","nativeShadow","Document","CSSStyleSheet","WeakMap","n","constructor","t","_$cssResult$","cssText","styleSheet","replaceSync","set","toString","c","cssRules","is","getOwnPropertyDescriptor","h","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","a","trustedTypes","emptyScript","reactiveElementPolyfillSupport","toAttribute","Boolean","Array","JSON","stringify","fromAttribute","Number","parse","b","attribute","String","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","y","HTMLElement","addInitializer","_$Ei","observedAttributes","finalize","_$Eh","createProperty","state","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","requestUpdate","configurable","getPropertyOptions","Map","finalized","properties","_$Eu","elementStyles","finalizeStyles","styles","isArray","Set","flat","reverse","unshift","toLowerCase","super","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","enableUpdating","_$AL","_$E_","addController","_$EO","add","renderRoot","isConnected","hostConnected","removeController","delete","size","createRenderRoot","shadowRoot","attachShadow","shadowRootOptions","adoptedStyleSheets","map","litNonce","textContent","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","removeAttribute","_$Ej","hasAttribute","C","_$EP","has","_$Eq","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","update","_$EM","_$AE","hostUpdated","firstUpdated","updated","updateComplete","getUpdateComplete","mode","ReactiveElement","reactiveElementVersions","createPolicy","createHTML","Math","random","toFixed","slice","createComment","v","_","RegExp","$","_$litType$","strings","values","x","T","for","E","A","createTreeWalker","P","V","lastIndex","exec","startsWith","N","parts","el","currentNode","content","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","endsWith","split","index","ctor","H","I","L","k","append","indexOf","innerHTML","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","M","_$AV","_$AN","_$AD","_$AM","_$AU","creationScope","importNode","R","nextSibling","z","_$AI","_$Cv","_$AH","_$AA","_$AB","options","startNode","endNode","_$AR","iterator","O","insertBefore","createTextNode","_$AC","_$AP","remove","setConnected","element","fill","arguments","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","host","litHtmlPolyfillSupport","litHtmlVersions","renderOptions","_$Do","renderBefore","render","_$litPart$","_$litElement$","litElementHydrateSupport","LitElement","litElementPolyfillSupport","litElementVersions","Version","CardRegname","CardName","DebugMode","TgCardHelper","cardName","debugMode","className","version","getCardInfoString","_debug","args","methodName","contextObject","debugList","item","trim","includes","callerLine","stack","patterns","pattern","methodMatch","match","path","debugArgs","console","log","_defineProperty","SuperBase","dM","useDummyData","showVersion","tgCardHelper","registerMeForChangeNotifys","eventTypes","that","dispatchEvent","CustomEvent","bubbles","composed","detail","component","callback","_handleOnChangeNotifys","eventType","immediately","eventdata","fkt","charAt","hass","config","css","CardBase","_selectedTab","informAtChangesClients","_registeredEventTypes","_onRegisterMeForChanges","setConfig","isNewConfig","getDefaultConfig","numberOfMonths","initialDisplayedMonths","selectedCalendar","store_mode","saver_key","calendars","shortcut","color","enabled","statusRelevant","holidays","neujahr","heilige_drei_koenige","tag_der_arbeit","friedensfest","mariae_himmelfahrt","tag_der_deutschen_einheit","reformationstag","allerheiligen","weihnachten_1","weihnachten_2","karfreitag","ostermontag","christi_himmelfahrt","pfingstmontag","fronleichnam","busstag","html","registerInformAtChangesClients","componentExists","hasCallback","me","newEventType","sort","filter","existingMeInformer","find","informer","existingEventTypes","newEventTypes","newType","requestedEventTypes","combinedEventTypes","totalObservers","_notifyClientsAtChanges","originalEventType","extractedEventType","clients","client","Element","contains","details","_CardBase","_superPropGet","ViewBase","epgData","_loading","_error","_loadData","_dataProvider","entity","_fetchViewData","dataProvider","_renderLoading","_renderError","_renderContent","_ViewBase","IStorageAdapter","isApplicable","storeMode","debug","_hass","_config","saveData","serializedData","loadData","saveConfig","activeShifts","loadConfig","isAvailable","getWarnings","checkStorageUsage","dataLength","SaverStorage","_saverKey","saverEntity","states","_readSaverVariable","attributes","variables","oldValue","callService","warn","_createFullJsonConfig","configObject","setup","timer_entity","lastchange","floor","Date","now","configKey","configJson","EntityStorage","_knownEntityIds","findAdditionalEntities","baseEntityId","additionalEntities","entityParts","domain","baseName","additionalEntityId","padStart","getEntityMaxLength","entityId","maxLength","max","parseInt","getAllEntityMaxLengths","maxLengths","mainEntityId","mainMaxLength","additionalMaxLength","_getAllEntityIds","allEntityIds","currentAdditionalEntities","knownAdditionalCount","newEntities","join","totalMaxLength","entity_id","entityValues","currentEntityIndex","remainingData","currentEntityId","charsToTake","min","valueToWrite","substring","newEntityId","entries","dataStrings","entityData","dataString","_createCompressedConfig","previousLength","getConfigEntityId","getStatusEntityId","configEntityId","configJsonLength","configEntity","totalCurrentLength","percentage","show","currentLength","round","warnings","status","statusEntityId","StorageFactory","createStorage","isStorageAvailable","HolidayMixin","_getEasterDate","year","month","_isHoliday","day","cacheKey","_holidayCache","result","_cachedHolidayEntities","holidayEntities","dateStr","dateStrShort","possibleAttrs","attr","attrValue","holidaysConfig","isHolidayEnabled","easter","fixedHolidays","holiday","easterTime","getTime","oneDay","dayOfWeekNov23","getDay","movableHolidays","date","getFullYear","getMonth","getDate","_isWeekend","dayOfWeek","DataManagementMixin","serializeWorkingDays","_workingDays","yearA","monthA","yearB","monthB","days","dayEntries","isNaN","formattedDays","dayNum","elements","dayStr","formatTwoDigits","parseWorkingDays","_parseWorkingDaysIntoObject","targetObject","part","trimmedPart","colons","daysStr","monthNum","_parseDaysWithElements","first","second","yearNum","entry","trimmed","CalendarMixin","_getAllCalendars","cal","localeCompare","_getCalendarByShortcut","_getDefaultColorForShortcut","CalendarsClass","CALENDARS","defaultCalendar","defaultColor","_getSelectedCalendarShortcut","_selectedCalendar","allCalendars","ConfigManagementMixin","shifts","RenderingMixin","_getDayElements","monthKey","shouldDebug","_renderMissingEntityWarning","entityName","isConfig","entityNameShort","litHtml","DateUtils","num","getDaysInMonth","getFirstDayOfMonth","getMonthName","getFirstDayOfWeekMondayBased","ColorUtils","_getContrastColor","hexColor","hex","substr","hexToRgb","cleanHex","rgbToHex","toHex","sharedMenuStyles","renderMenuBar","left","center","right","fullWidth","ShiftConfigPanel","selectedShortcut","_validationErrors","_updateValidationErrors","changedProperties","oldCalendars","newCalendars","_validateCalendar","calendar","errors","timeRanges","timeRangeIds","range","rangeData","times","idNum","_hasValidationErrors","_triggerColorPicker","colorInput","querySelector","click","editingCalendar","selectedIndex","findIndex","_handleClose","_handleSave","isSelected","hasErrors","_addShift","_updateCalendar","_updateCalendarId","checked","_addTimeRange","rangeIndex","_updateTimeRangeId","_updateTimeRange","_removeTimeRange","_deleteShift","_moveShift","_hasLocalCopy","direction","moved","splice","_toggleEnabled","existingShortcuts","availableShortcut","defaultColors","newShift","updates","_normalizeTimeRange","_normalizeTimeRanges","timeIndex","newTimeRanges","newId","normalizedId","existingIds","calErrors","selectedHasErrors","erfolgreich","fehlerfrei","gesamtFehler","fehlerDetails","aktuelleSchicht","aktuelleSchichtFehler","oldShortcut","newShortcut","normalizedNewShortcut","newVal","oldVal","customElements","define","ShiftScheduleView","lovelace","_storageWarning","_configWarning","_statusWarning","_displayedMonths","_startMonthOffset","_showConfigPanel","_cleanupDone","_isWriting","_writeLockTimer","_isInitialLoad","_directDOMUpdateInProgress","_editorModeCache","_editorModeCacheTime","_saveDebounceTimer","_storage","_configPanelCalendars","assign","_isInEditorMode","URLSearchParams","search","editMode","depth","maxDepth","classList","parentElement","root","getRootNode","href","pathname","_initializeStorage","previousEntityState","newEntityState","hasAnyEntityChanged","prevState","newState","hasSaverConfigChanged","hasSaverDataChanged","previousSaverEntity","dataKey","previousConfigValue","previousDataValue","newDataValue","wasHassSet","loadWorkingDays","then","storageConfig","isPanelOpen","parsedConfig","isPanelOpenAfterParse","isPanelOpenBeforeUpdate","finalPanelCheck","idx","normalizedRange","timeRanges_count","catch","finalPanelCheckSaver","checkConfigEntity","checkStatusEntity","calendars_count","hasHass","maxMonths","_updateWarnings","isStillInitialLoad","saveConfigToEntity","_handleConfigChanged","variableValue","preview","availableKeys","_isSaverAvailable","_loadDataFromSaver","saverKey","_loadConfigFromSaver","_updateConfigWarningDirectly","_updateStatusWarningDirectly","dataSource","fallbackStorage","workingDaysCount","monthData","daysCount","currentMonth","currentYearFull","previousMonth","previousYear","monthsToKeep","hasChanges","keyParts","keyYear","keyMonth","shouldKeep","cleanedValue","serializedDataLength","_updateStorageWarningDirectly","statusEntity","hasConfig","hasEntity","storageType","storageAdapter","allShifts","_convertCalendarsToShifts","fallbackError","isEnabled","shiftData","range1","start1","end1","range2","start2","end2","_saveConfigToEntityFallback","distributeDataToEntities","truncatedValue","allAdditionalEntities","toggleDay","currentYear","isPreviousMonth","selectedCalendarShortcut","elementIndex","buttonKey","finalElements","_updateDayButtonDirectly","_scheduleDebouncedSave","debounceTime","_getSaveDebounceTime","_saveToHA","storageUsage","_saveDataToSaver","existingValue","saveDebounceTime","dayElements","button","hasSelectedShift","firstActiveShift","shiftOrder","activeShiftForColor","activeCalendar","style","backgroundColor","existingContainer","shiftIndicators","indicator","title","container","ind","getWeekNumber","UTC","getUTCDay","setUTCDate","getUTCDate","yearStart","getUTCFullYear","ceil","renderDay","currentDay","yearKey","workingDays","today","isToday","buttonStyle","isWorking","isWeekend","isHoliday","blur","wrapper","focus","existingButton","renderMonth","daysInMonth","firstDayMonday","rows","firstDate","weekNumber","firstRowCells","weekNum","rowCells","changeDisplayedMonths","delta","newValue","changeStartMonth","displayedMonths","currentOffset","maxOffset","newOffset","getNavigationBounds","canGoBack","canGoForward","_getSelectedCalendarValue","_onCalendarSelectedByIndex","_updateAllDayButtonsForCalendarChange","buttons","querySelectorAll","hasStorageWarning","storageWarningEl","nextEntitySuffix","isEditorMode","hasConfigWarning","configWarningSize","configWarningMissing","warningEl","storageWarning","insertAdjacentElement","lastWarning","hasStatusWarning","statusWarningEl","changedProps","from","startMonthOffset","months","navBounds","stopPropagation","preventDefault","textColor","_handleConfigPanelSave","_ShiftScheduleView","unsafeCSS","DEFAULT_SELECTED_DAY_COLOR","CardImpl","_view","_viewType","getConfigElement","getStubConfig","defaultConfig","ev","viewType","_lovelace","_CardImpl","EditorBase","loadHaForm","cardHelpers","_EditorBase","EditorImpl","calendarsMap","defaultCal","existing","_getBasicSchema","_computeLabel","_valueChanged","_renderHolidays","_getColorOptions","_validateTime","timeString","_validateTimeRange","isValid","start","end","hasStart","hasEnd","startValid","endValid","_renderCalendar","colorOptions","currentColor","shiftName","range1Validation","range2Validation","isValidTimeRange1Start","isValidTimeRange1End","isValidTimeRange2Start","isValidTimeRange2End","range1StartError","range1EndError","range2StartError","range2EndError","label","formatValid","updatedCal","updatedRange","rangeValidation","hasError","helper","_updateHoliday","newConfig","newRange","property","schema","selector","text","number","step","_EditorImpl","Editor","_Editor","Card","_Card","customCards","description"],"sourceRoot":""}