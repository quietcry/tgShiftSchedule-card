<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPG Programm Test</title>
    <script type="module" src="./dist/tgepg-card.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>EPG Programm Anzeige Test</h1>

        <div class="test-info">
            <h3>Test-Informationen:</h3>
            <ul>
                <li>Diese Seite testet die Anzeige von EPG-Programmen</li>
                <li>Die Programme sollten in der rechten Spalte sichtbar sein</li>
                <li>Kanalnamen sollten in der linken Spalte stehen</li>
                <li>Programme sollten korrekte Breiten basierend auf ihrer Dauer haben</li>
            </ul>
        </div>

        <tgepg-card
            entity="media_player.test"
            name="EPG Test"
            show_time="true"
            show_duration="true"
            show_description="true"
            show_shorttext="false"
            epg_show_width="180"
            epg_past_time="30"
            channel_width="180"
            show_channel_groups="false"
            debug_mode="true">
        </tgepg-card>
    </div>

    <script>
        // Simuliere EPG-Daten nach dem Laden
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const card = document.querySelector('tgepg-card');
                if (card && card.epgBox) {
                    console.log('Füge Test-EPG-Daten hinzu...');

                    // Test-EPG-Daten
                    const testEpgData = {
                        channeldata: {
                            id: 'test-channel-1',
                            channelid: 'test-channel-1',
                            name: 'Test Kanal 1',
                            channeldata: {
                                name: 'Test Kanal 1'
                            }
                        },
                        epg: {
                            'program1': {
                                start: Math.floor(Date.now() / 1000) - 1800, // 30 min ago
                                end: Math.floor(Date.now() / 1000) + 1800,   // 30 min from now
                                stop: Math.floor(Date.now() / 1000) + 1800,
                                title: 'Test Programm 1',
                                description: 'Dies ist ein Testprogramm mit Beschreibung',
                                shorttext: 'Test Short Text'
                            },
                            'program2': {
                                start: Math.floor(Date.now() / 1000) + 1800,  // 30 min from now
                                end: Math.floor(Date.now() / 1000) + 5400,    // 90 min from now
                                stop: Math.floor(Date.now() / 1000) + 5400,
                                title: 'Test Programm 2',
                                description: 'Ein weiteres Testprogramm',
                                shorttext: 'Weiterer Test'
                            }
                        }
                    };

                    card.epgBox.addTeilEpg(testEpgData);

                    // Zweiter Test-Kanal
                    const testEpgData2 = {
                        channeldata: {
                            id: 'test-channel-2',
                            channelid: 'test-channel-2',
                            name: 'Test Kanal 2',
                            channeldata: {
                                name: 'Test Kanal 2'
                            }
                        },
                        epg: {
                            'program3': {
                                start: Math.floor(Date.now() / 1000) - 900,  // 15 min ago
                                end: Math.floor(Date.now() / 1000) + 2700,   // 45 min from now
                                stop: Math.floor(Date.now() / 1000) + 2700,
                                title: 'Aktuelles Programm',
                                description: 'Dieses Programm läuft gerade',
                                shorttext: 'Live'
                            }
                        }
                    };

                    card.epgBox.addTeilEpg(testEpgData2);
                }
            }, 1000);
        });
    </script>
</body>
</html>
